webpackJsonp([0],[,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(49),a=r(50),s=o.module("purchase.configuration",[]).constant("PURCHASE_CONSTANTS",i.Constants.getPurchase()).constant("CONFIGURATION",i.Constants.getConfiguration()).service("ConfigurationSvc",a.ConfigurationSvc);t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(45),a=r(46),s=r(47),c=r(48),l=r(1),u=function(e){return e&&e.__esModule?e:{default:e}}(l),d=o.module("purchase.service",["ui.router","gettext","customError",u.default.name]).service("GuestRegistrationSvc",i.GuestRegistrationSvc).service("PurchaseSvc",a.PurchaseSvc).service("StorageSvc",s.StorageSvc).service("UserSvc",c.UserSvc);t.default=d},function(e,t,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(56),a=r(57),s=r(58),c=r(6),l=_interopRequireDefault(c),u=r(1),d=_interopRequireDefault(u),p=r(68),f=r(69),h=r(71),m=r(72),v=r(73),y=o.module("purchase.analytics",["sha512","ngCookies","ng-analytics",l.default.name,d.default.name]).service("AnalyticsCfgSvc",i.AnalyticsCfgSvc).service("PurchaseGtmSvc",a.PurchaseGtmSvc).service("PurchaseNgaSvc",s.PurchaseNgaSvc).service("PurchaseDfpSvc",p.PurchaseDfpSvc).service("purchaseTradeDoublerSvc",v.PurchaseTradeDoublerSvc).directive("iframeOnload",function(){return new m.IframeOnloadDirective}).controller("AffiliateProgramCtrl",h.AffiliateProgramController).component("affiliateProgram",new f.AffiliateProgramComponent);t.default=y},function(e,t,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(74),a=r(75),s=r(76),c=r(2),l=_interopRequireDefault(c),u=r(1),d=_interopRequireDefault(u),p=o.module("purchase.urls",[l.default.name,d.default.name]).filter("httpsImage",i.provideHttpsImageFilter).filter("url",a.provideUrlFilter).factory("redirectTo",s.provideRedirectTo);t.default=p},,function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(59);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(60),a=r(62),s=r(63),c=r(64),l=_interopRequireDefault(c),u=r(2),d=_interopRequireDefault(u),p=r(1),f=_interopRequireDefault(p),h=o.module("purchase.summation",["gettext","formattedPrice","paymentsMethods",l.default.name,d.default.name,f.default.name]).component("purchaseSummation",new i.PurchaseSummationComponent).controller("PurchaseSummationCtrl",a.PurchaseSummationCtrl).service("PurchaseSummationSvc",s.PurchaseSummationSvc);t.default=h},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(94);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(95),a=r(96),s=r(3),c=_interopRequireDefault(s),l=r(99),u=r(1),d=_interopRequireDefault(u),p=o.module("purchase.modals",["ui.router","ui.bootstrap","gettext",c.default.name,d.default.name]).controller("MessageModalCtrl",l.MessageModalCtrl).controller("ErrorReasonModalCtrl",i.ErrorReasonModalCtrl).service("ModalSvc",a.ModalSvc);t.default=p},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(100),a=r(101),s=r(102),c=r(104),l=r(106),u=o.module("purchase.offer",["offerQuantity"]).component("offer",new s.OfferComponent).component("offerPrice",new c.OfferPriceComponent).service("offerSvc",l.OfferSvc).controller("offerCtrl",i.OfferCtrl).controller("offerPriceCtrl",a.OfferPriceCtrl);t.default=u},,function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(77);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(78),a=r(82),s=r(83),c=r(84),l=r(85),u=r(87),d=r(88),p=r(2),f=_interopRequireDefault(p),h=r(4),m=_interopRequireDefault(h),v=r(12),y=_interopRequireDefault(v),g=r(7),S=_interopRequireDefault(g),C=r(9),P=_interopRequireDefault(C),b=r(3),O=_interopRequireDefault(b);r(5);var D=r(1),_=_interopRequireDefault(D),$=o.module("purchase.buyButton",["ui.bootstrap",f.default.name,m.default.name,"customError",y.default.name,S.default.name,P.default.name,O.default.name,_.default.name,"gettext"]).controller("BuyButtonCtrl",i.BuyButtonCtrl).controller("BuyErrorModalCtrl",a.BuyErrorModalCtrl).controller("confirmBuyModalCtrl",s.ConfirmBuyModalCtrl).controller("PartiallyBoughtModalCtrl",c.PartiallyBoughtModalCtrl).directive("buyButton",l.provideBuyButtonDirective).service("BuyFailedSvc",u.BuyFailedSvc).service("confirmBuySvc",d.ConfirmBuySvc);t.default=$},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(89);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(90),a=r(92),s=r(93),c=r(2),l=_interopRequireDefault(c),u=r(4),d=_interopRequireDefault(u),p=r(1),f=_interopRequireDefault(p),h=o.module("purchase.buyErrorList",[l.default.name,d.default.name,f.default.name,"customError"]).component("buyErrorList",new i.BuyErrorListComponent).controller("BuyErrorListCtrl",a.BuyErrorListCtrl).service("BuyValidationSvc",s.BuyValidationSvc);t.default=h},function(e,t,r){r(107);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(108),a=r(110),s=o.module("purchase.pharmacy",[]).component("pharmacy",new i.PharmacyComponent).controller("PharmacyCtrl",a.PharmacyCtrl);t.default=s},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(111);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(112),a=r(113),s=r(114),c=r(3),l=_interopRequireDefault(c),u=r(7),d=_interopRequireDefault(u),p=r(1),f=_interopRequireDefault(p),h=o.module("purchase.guestVerification",["ui.bootstrap",f.default.name,l.default.name,d.default.name]).component("guestVerification",new s.GuestVerification).controller("GuestVerificationCtrl",i.GuestVerificationCtrl).service("EmailGuestVerificationSvc",a.EmailGuestVerificationSvc);t.default=h},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(123);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(124),a=r(126),s=r(128),c=r(129),l=r(130),u=r(3),d=_interopRequireDefault(u),p=r(2),f=_interopRequireDefault(p),h=r(4),m=_interopRequireDefault(h),v=r(6),y=_interopRequireDefault(v),g=r(7),S=_interopRequireDefault(g),C=r(9),P=_interopRequireDefault(C),b=r(1),O=_interopRequireDefault(b),D=o.module("purchase.related",[d.default.name,f.default.name,m.default.name,"offerQuantity","checklist-model",S.default.name,y.default.name,P.default.name,O.default.name]).component("offersFromSellers",new i.OffersFromSellersComponent).component("relatedOrder",new a.RelatedOrderComponent).controller("RelatedCtrl",s.RelatedCtrl).controller("RelatedOrderCtrl",c.RelatedOrderCtrl).service("RelatedSvc",l.RelatedSvc);t.default=D},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(143),a=r(145),s=r(146),c=o.module("purchase.complementaryItems",[]).component("complementaryItems",new i.ComplementaryItemsComponent).controller("complementaryItemsCtrl",s.ComplementaryItemsController).service("ComplementaryItemsSvc",a.ComplementaryItemsSvc);t.default=c},function(e,t,r){r(172);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(173),a=r(174),s=r(175),c=o.default.module("purchase.additionalServices",["formattedPrice","offerQuantity","checklist-model"]).component("additionalServices",new s.AdditionalServicesComponent).controller("AdditionalServicesCtrl",i.AdditionalServicesComponentController).service("AdditionalServicesSvc",a.AdditionalServicesSvc);t.default=c},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(202);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(203),a=r(3),s=_interopRequireDefault(a),c=r(1),l=_interopRequireDefault(c),u=r(204),d=r(206),p=r(207),f=r(209),h=r(19),m=r(212),v=r(213),y=r(215),g=r(216),S=r(218),C=r(219),P=r(221),b=r(222),O=r(223),D=r(225),_=o.module("purchase.dropOff",["ui.router","ngCookies","deliveryMethods",s.default.name,l.default.name]).controller("DropOffFakeDoorCtrl",b.DropOffFakeDoorCtrl).controller("DropOffCheckboxCtrl",i.DropOffCheckboxCtrl).controller("DropOffSelectCtrl",h.DropOffSelectCtrl).controller("DropOffPointCtrl",y.DropOffPointCtrl).controller("DropOffPointSelectModalCtrl",m.DropOffPointSelectModalCtrl).controller("DropOffPointsMapCtrl",g.DropOffPointsMapCtrl).controller("DropOffAddressCtrl",D.DropOffAddressCtrl).component("dropOffFakeDoor",new C.DropOffFakeDoorComponent).component("dropOffCheckbox",new u.DropOffCheckboxComponent).component("dropOffSelect",new f.DropOffSelectComponent).component("dropOffPoint",new v.DropOffPointComponent).component("dropOffPointsMap",new S.DropOffPointsMapComponent).component("dropOffDisclaimer",new p.DropOffDisclaimerComponent).component("dropOffAddress",new O.DropOffAddressComponent).service("dropOffFakeDoorSvc",P.DropOffFakeDoorSvc).service("dropOffSvc",d.DropOffSvc);t.default=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffSelectCtrl(e,t,r,n){"ngInject";this.PurchaseNgaSvc=e,this.dropOffSvc=t,this.dropOffFakeDoorSvc=r,this.$uibModal=n,this.isDropOffPointSelected=!1,this.PurchaseNgaSvc.onDropOffAvailable(this.getVariant()),this.dropOffFakeDoorSvc.onDropOffAvailable()}return DropOffSelectCtrl.$inject=["PurchaseNgaSvc","dropOffSvc","dropOffFakeDoorSvc","$uibModal"],DropOffSelectCtrl.prototype.$onChanges=function(e){if(e.activeAddress){var t=e.activeAddress,r=t.currentValue;r!==t.previousValue&&(this.address=r.city+" "+r.street,this.updateDropOffs())}},DropOffSelectCtrl.prototype.openDropOffSelectionModal=function(){var e=this,t=this.$uibModal.open({template:r(211),size:"lg modal-xs delivery-spots-modal",controller:"DropOffPointSelectModalCtrl",controllerAs:"modalCtrl",bindToController:!0,resolve:{points:function(){return e.dropOffPoints||[]},selectedPoint:function(){return e.selectedPoint}}});this.PurchaseNgaSvc.onDropOffMapShown(this.getVariant()),t.result.then(function(t){e.selectedPoint=t.selectedPoint,e.PurchaseNgaSvc.onDropOffRequested(e.getVariant()),e.dropOffFakeDoorSvc.onDropOffRequested()}).catch(function(){return e.isDropOffPointSelected=!1})},DropOffSelectCtrl.prototype.onDropOffClicked=function(){this.isDropOffPointSelected=!0,this.pointsAvailableInArea()?this.openDropOffSelectionModal():(this.PurchaseNgaSvc.onDropOffRequested(this.getVariant()),this.dropOffFakeDoorSvc.onDropOffRequested(),this.PurchaseNgaSvc.onDropOffNoPoints(this.getVariant()))},DropOffSelectCtrl.prototype.isInteractionLocked=function(){return!!this.selectedPoint||this.isDropOffPointSelected&&!this.pointsAvailableInArea()},DropOffSelectCtrl.prototype.pointsAvailableInArea=function(){return this.dropOffPoints&&this.dropOffPoints.length>0},DropOffSelectCtrl.prototype.getVariant=function(){return"select"},DropOffSelectCtrl.prototype.updateDropOffs=function(){var e=this;this.isDropOffPointSelected=!1,this.selectedPoint=null,this.dropOffSvc.findNearAddresses(this.address).then(function(t){e.dropOffPoints=t},function(){e.dropOffPoints=[]})},DropOffSelectCtrl}();t.DropOffSelectCtrl=n},function(e,t,r){r(21),e.exports=r(22)},function(e,t,r){"use strict";Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{value:function(e){return[].concat.apply([],this.map(e))},enumerable:!1})},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(23);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(25),a=r(26),s=r(40),c=r(41),l=r(42);r(8),r(10),r(5);var u=r(2),d=_interopRequireDefault(u),p=r(51),f=_interopRequireDefault(p),h=r(4),m=_interopRequireDefault(h),v=r(116),y=_interopRequireDefault(v),g=r(120),S=_interopRequireDefault(g),C=r(15),P=_interopRequireDefault(C),b=r(9),O=_interopRequireDefault(b),D=r(131),_=_interopRequireDefault(D),$=r(6),E=_interopRequireDefault($),I=r(3),A=_interopRequireDefault(I),k=r(7),R=_interopRequireDefault(k),M=r(151),w=_interopRequireDefault(M),T=r(180),N=_interopRequireDefault(T),B=r(184),j=_interopRequireDefault(B),x=r(231),U=_interopRequireDefault(x),F=r(18),L=_interopRequireDefault(F),V=r(233),z=_interopRequireDefault(V),q=r(235),G=_interopRequireDefault(q),Y=r(1),H=_interopRequireDefault(Y),W=r(16),K=_interopRequireDefault(W),Q=o.module("purchase",["ui.mask","ui.bootstrap","ui.router","gettext","customError","rt.debounce","ngStorage",H.default.name,z.default.name,d.default.name,R.default.name,w.default.name,P.default.name,j.default.name,f.default.name,E.default.name,L.default.name,_.default.name,A.default.name,N.default.name,m.default.name,O.default.name,y.default.name,S.default.name,U.default.name,G.default.name,K.default.name]);Q.service("HttpInterceptorSvc",c.HttpInterceptorSvc).service("GuestAuthInterceptorSvc",s.GuestAuthInterceptorSvc).controller("PurchaseCtrl",l.PurchaseCtrl).config(a.config).run(i.run),t.default=Q},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Error trace id":"Identyfikator błędu","I choose size":"Wybieram rozmiar","Please try again.":"Spróbuj ponownie.","Unexpected error has occurred":"Przepraszamy, wystąpił nieoczekiwany błąd"})}])},,function(e,t,r){"use strict";function run(e,t,r,n,o,i){"ngInject";var a=i.getLocale(),s=i.getVteName(r.host()),c={Accept:"application/vnd.allegro.public.v1+json","Content-Type":"application/vnd.allegro.public.v1+json","Accept-Language":a.languageTag};s&&(c["service-tag"]=s),t.defaults.headers.common=c,t.defaults.headers.put=c,t.defaults.headers.post=c,o.setCurrentLanguage(a.language),o.debug=!i.isProduction(),e.$on("$stateChangeSuccess",function(){n()})}Object.defineProperty(t,"__esModule",{value:!0}),t.run=run,run.$inject=["$rootScope","$http","$location","$anchorScroll","gettextCatalog","ConfigurationSvc"]},function(e,t,r){"use strict";function config(e,t,n,o,i,a,s,c){"ngInject";e.html5Mode(!0),a.preAssignBindingsEnabled(!0),a.debugInfoEnabled(!1),s.debugEnabled(!1),c.errorOnUnhandledRejections(!1),n.otherwise("/transaction-front/app/404"),n.rule(function(e,t){var r=t.path();0!==r.indexOf("/transaction-front/app/user/")&&0!==r.indexOf("/transaction-front/app/guest/")&&(r=r.replace("/transaction-front/app/","/transaction-front/app/user/"),t.replace().path(r))}),t.state("purchase",{abstract:!0,url:"/transaction-front/app/{userFlow:user|guest}/purchase/:purchaseId",template:r(27),controller:"PurchaseCtrl",controllerAs:"purchase"}).state("purchase.preBuyNow",{url:"/pre-buy-now",template:r(28),controller:"PreBuyNowCtrl",controllerAs:"preBuyNow"}).state("purchase.related",{url:"/related?referrer",template:r(29),controller:"RelatedCtrl",controllerAs:"related",params:{referrer:{value:"",squash:!0}}}).state("purchase.dapf",{url:"/dapf?referrer",template:r(30),controller:"DapfCtrl",controllerAs:"dapf",params:{referrer:{value:"",squash:!0}}}).state("purchase.summary",{abstract:!0,template:r(31),controller:"SummaryCtrl",controllerAs:"summary"}).state("purchase.summary.view",{url:"/summary",views:{"delivery@purchase.summary":{template:r(32)}}}).state("cvvVerification",{url:"/transaction-front/app/{userFlow:user|guest}/payments/cvv?paymentId&url&destination&statusCode&refReqId&posId&sig",template:r(33),controller:"CvvVerificationCtrl",controllerAs:"cvvVerification"}).state("thankYou",{url:"/transaction-front/app/{userFlow:user|guest}/thankYou/:purchaseId?transactionToken",template:r(34),controller:"ThankYouCtrl",controllerAs:"thankYou"}).state("thankYou.success",{url:"/success",template:r(35)}).state("thankYou.blik",{url:"/blik",template:r(36)}).state("thankYou.error",{url:"/error",template:r(37)}).state("thankYou.announcement",{url:"/announcement",template:r(38)}).state("errorLanding",{url:"/transaction-front/app/{userFlow:user|guest}/error/{purchaseFlow:cart|buy-now}/:id?validationId",template:r(39),controller:"ErrorLandingCtrl",controllerAs:"errorLanding"}),o.decorator("$exceptionHandler",["$log","$delegate","ErrorLoggerSvc",function(e,t,r){return function(n,o){n.userMessage&&e.info(n.userMessage),r.report(n),t(n,o)}}]),i.interceptors.push("HttpInterceptorSvc"),i.interceptors.push("GuestAuthInterceptorSvc"),i.defaults.withCredentials=!0}Object.defineProperty(t,"__esModule",{value:!0}),t.config=config,config.$inject=["$locationProvider","$stateProvider","$urlRouterProvider","$provide","$httpProvider","$compileProvider","$logProvider","$qProvider"]},function(e,t){e.exports='<div ng-class="{\'metrumize metrumize-body\': purchase.isThemeMetrumize}">\n    <purchase-header purchase="purchase" ng-if="purchase.isPurchaseLoaded"></purchase-header>\n    <section class="purchase-wrapper">\n        <div ng-if="!purchase.isPurchaseLoaded" class="loader-wrapper">\n            <div class="spinner spinner-medium"></div>\n        </div>\n        <alert-error ng-if="purchase.getPurchaseFailed"\n                     reason="purchase.getPurchaseFailReason"></alert-error>\n\n        <ui-view ng-if="purchase.isPurchaseLoaded && !purchase.getPurchaseFailed"></ui-view>\n    </section>\n</div>\n\n'},function(e,t){e.exports='<section id="pre-buy-now" class="pre-buy-now">\n    <section class="seller-items" ng-repeat="order in ::purchase.data.orders track by order.id">\n        <offer ng-repeat="offer in order.offers track by $index" offer="offer"></offer>\n\n        <rebate-info ng-if="order.offers[0].options.rebates.multipack && !preBuyNow.isRebateInfoHidden"\n                     label="order.offers[0].options.rebates.multipack.label"\n                     quantity="order.offers[0].quantity"\n                     required-quantity="order.offers[0].options.rebates.multipack.requiredQuantity"\n                     offer-type="order.offers[0].quantityType"\n        ></rebate-info>\n\n        <additional-services\n            ng-if="::preBuyNow.shouldShowAdditionalServices()"\n            read-only="false"\n            disabled="preBuyNow.isUpdateInProgress || !preBuyNow.isPurchaseEditable()"\n            offer="order.offers[0]">\n        </additional-services>\n\n        <display-delivery-methods\n            seller="::order.seller"\n            offer="::order.offers[0]"\n            on-delivery-cheapest-price="preBuyNow.deliveryCheapestPrice = deliveryCheapestPrice"\n        ></display-delivery-methods>\n\n        <pharmacy\n            ng-if="::order.seller.pharmacy.available"\n            order-id="::order.id"\n            pharmacy-address="::order.seller.pharmacy.address"\n            buyer-address="::purchase.residenceAddress">\n        </pharmacy>\n\n    </section>\n\n    <rebate-stopper\n            purchase-id="::purchase.data.id">\n    </rebate-stopper>\n\n    <section id="total-cost" class="summation">\n        <purchase-summation orders="::purchase.data.orders" purchase-service="::purchase.data.service"></purchase-summation>\n    </section>\n    <section id="confirm" class="confirm">\n        <div class="row">\n            <buy-button\n                class="primary-action"\n                purchase="::purchase"\n                disabled="preBuyNow.isUpdateInProgress"\n                on-success="::preBuyNow.onSuccess()"\n                on-buy-command-error="::preBuyNow.onBuyCommandError(error)"\n                ng-click="preBuyNow.enableTradeDoubler()">\n            </buy-button>\n\n            <div class="secondary-action">\n                <a class="btn btn-link" ng-href="{{::purchase.data.orders[0].offers[0].viewUrl}}" translate target="_self">\n                    back to item page\n                </a>\n            </div>\n\n        </div>\n        <div class="row">\n            <installments-button\n                    class="primary-action"\n                    on-success="::preBuyNow.onInstallmentSuccess()"\n                    installments="preBuyNow.installmentsData"\n            ></installments-button>\n            <leaselink-button\n                    purchase="::purchase.data"\n                    leasing="preBuyNow.installmentsData.leasing"\n                    mode="preBuyNow.installmentsData.mode">\n            </leaselink-button>\n        </div>\n        <div class="row" ng-if="preBuyNow.deliveryCheapestPrice">\n            <installments-calculator\n                    purchase="purchase.data"\n                    domain-api="purchase.apiUrl"\n                    env="purchase.env"\n                    delivery-cheapest-price="preBuyNow.deliveryCheapestPrice.amount"\n                    on-installments-change="preBuyNow.installmentsData = installmentsData"\n            ></installments-calculator>\n        </div>\n\n        <trade-doubler ng-if="preBuyNow.isTradeDoublerEnabled"\n                       organization-id="preBuyNow.tradeDoublerData.organizationId"\n                       purchase-id="preBuyNow.tradeDoublerData.purchaseId"\n                       currency="preBuyNow.tradeDoublerData.currency"\n                       trade-doubler-uid="preBuyNow.tradeDoublerData.uid"\n                       products="preBuyNow.tradeDoublerData.products">\n        </trade-doubler>\n    </section>\n\n</section>'},function(e,t){e.exports='<section id="related-orders" class="related-orders">\n    <h2 translate>Select offers for payment</h2>\n    <header class="global-options seller-items">\n        <div class="table">\n            <div class="table-row">\n                <div class="table-cell select-all">\n                    <input type="checkbox"\n                           id="select-all-orders"\n                           ng-model="related.isToggleAllSelected"\n                           ng-change="related.toggleSelectAllOrders()"\n                           ng-disabled="!related.isLoaded">\n                </div>\n                <div class="table-cell select-all-label">\n                    <label for="select-all-orders">\n                        <translate>select all</translate>\n                        (<offers-from-sellers offers-count="related.offersCount" sellers-count="related.sellersCount"></offers-from-sellers>)\n                    </label>\n                </div>\n            </div>\n        </div>\n    </header>\n\n    <div ng-if="!related.isLoaded" class="loader-wrapper">\n        <div class="spinner spinner-medium"></div>\n    </div>\n\n    <div ng-if="related.isLoaded">\n        <section class="seller-items no-quantity separator separator-top"\n                 ng-repeat="myorder in ::related.allOrders track by myorder.id">\n            <related-order my-order="::myorder" model="related.ordersToPay"></related-order>\n        </section>\n    </div>\n\n    <section class="separator separator-top summary" ng-if="related.isLoaded">\n        <translate>total for</translate>\n        <offers-from-sellers offers-count="related.selectedOrdersOffersCount"\n                             sellers-count="related.selectedOrdersSellersCount"></offers-from-sellers>:\n        <span class="total">\n            {{related.selectedOrdersTotalCost | currency}}\n        </span>\n        <span class="didascalia delivery-cost">\n            <translate>+ delivery cost</translate>\n        </span>\n    </section>\n\n    <section id="confirm" class="confirm">\n        <div class="row">\n            <div class="primary-action">\n                <button translate\n                        class="btn btn-primary"\n                        ng-class="{spinner: related.creatingPurchaseInProgress}"\n                        ng-click="related.goToDapf()"\n                        ng-disabled="!related.isLoaded || related.creatingPurchaseInProgress || related.ordersToPay.length === 0">\n                    go to delivery and payment form\n                </button>\n            </div>\n            <aside class="secondary-action">\n                <a class="btn btn-link"\n                   ng-href="/dashboard/myorders/"\n                   translate\n                   target="_self">\n                    go back to my orders\n                </a>\n            </aside>\n        </div>\n    </section>\n</section>'},function(e,t){e.exports='<form class="form-horizontal alle-form auto-number-headings" ng-if="purchase.isPurchaseLoaded && !purchase.getPurchaseFailed" name="purchase.dapfForm" accept-charset="utf-8" novalidate>\n\n    <delivery-promo message="::dapf.deliveryPromoMessage"></delivery-promo>\n\n    <delivery-section\n        orders="purchase.data.orders"\n        purchase-options="purchase.data.options"\n        show-payment-icons="purchase.showPaymentIcons"\n        service="purchase.data.service"\n        user-address="purchase.data.options.addresses[0]"\n        env="purchase.env">\n    </delivery-section>\n\n    <section id="shipment-data" class="shipment" ng-if="!purchase.isPaymentInProgress && purchase.dapfForm.delivery.$valid">\n        <h2 class="auto-num" translate>shipping address data</h2>\n\n        <drop-off-fake-door purchase="purchase"></drop-off-fake-door>\n\n        <addresses-section\n            has-account-address="purchase.hasAccountAddress"\n            user-addresses="purchase.userAddresses"\n            active-address="purchase.activeAddress"\n            has-invoice-address="purchase.isInvoiceAvailable"\n            invoice-address="purchase.invoiceAddress"\n            is-phone-required="purchase.isPhoneRequired"\n            locale="purchase.locale"\n            phone-number-mask="purchase.phoneNumberMask"\n            phone-number-pattern="purchase.phoneNumberPattern"\n            is-company-user="purchase.buyer.company"\n            is-guest="::purchase.isGuest">\n        </addresses-section>\n\n        <sms-verification\n            ng-if="::purchase.isBuyerVerificationRequired"\n            purchase-id="::purchase.data.id"\n            phone-number="purchase.activeAddress.phoneNumber"\n            on-sms-code-update="dapf.setSmsCode(smsCode)"\n            is-phone-number-valid="purchase.dapfForm.addresses.phoneForm.phoneNumber.$valid || purchase.dapfForm.addresses.guestForm.phoneNumber.$valid">\n        </sms-verification>\n    </section>\n\n    <section id="payment-component"\n             class="payment-component"\n             ng-if="purchase.dapfForm.delivery.$valid && purchase.dapfForm.addresses.$valid && purchase.paymentId"\n             ng-hide="purchase.isUpdateInProgress || purchase.isPurchasePostpaidOnly">\n        <h2 id="payment-title" class="auto-num" translate>payment methods</h2>\n        <payments-methods\n            payments="purchase.paymentsData.payments"\n            payment-id="purchase.paymentId"\n            metadata="purchase.data.metadata"\n            method-list-status="purchase.paymentsData.methodListStatus"\n            domain-api="purchase.apiUrl"\n            locale="purchase.locale"\n            theme-metrumize="purchase.isThemeMetrumize"\n            env="purchase.env"\n            purchase-id="purchase.data.id"\n            is-guest="purchase.isGuest">\n        </payments-methods>\n\n        <discount-coupons ng-if="purchase.paymentsData.payments.discounts"\n                payments="purchase.paymentsData.payments"\n                payment-id="purchase.paymentId"\n                locale="purchase.locale"\n        ></discount-coupons>\n    </section>\n\n    <section ng-if="purchase.dapfForm.delivery.$valid && purchase.dapfForm.addresses.$valid && dapf.isInstallmentsSelected()">\n        <installments-calculator\n                purchase="purchase.data"\n                domain-api="purchase.apiUrl"\n                env="purchase.env"\n                delivery-cheapest-price="dapf.totalDeliveryCost(purchase.data.orders)"\n                on-installments-change="purchase.installmentsData = installmentsData"\n        ></installments-calculator>\n    </section>\n\n    <section id="total-cost" class="summation">\n        <purchase-summation\n            payment-id="purchase.paymentId"\n            orders="purchase.data.orders"\n            purchase-service="::purchase.data.service"\n            payments="purchase.paymentsData.payments">\n        </purchase-summation>\n    </section>\n\n    <section id="confirm" class="confirm">\n        <div class="row">\n            <div class="primary-action">\n                <button id="go-to-summary-btn"\n                        ng-class="{\'btn-installments\': dapf.isInstallmentsSelected()}"\n                        class="btn spinner btn-primary"\n                        type="button"\n                        ng-click="dapf.submitDapf(purchase.dapfForm)"\n                        ng-disabled="purchase.isUpdateInProgress || dapf.isDapfSubmitBtnDisabled">\n                    <span translate>Go to summary</span>\n                </button>\n                <span ng-if="purchase.isCartProcess" class="didascalia hidden-xs hidden-ss" translate>\n                    You can check all data before making a purchase.\n                </span>\n            </div>\n\n            <div class="secondary-action" ng-if="::purchase.isGuest">\n                <a class="btn btn-link btn-guest-data"\n                   target="_self"\n                   ng-href="{{::purchase.backToGuestDataFormUrl}}"\n                   ng-if="::purchase.isGuest" translate>back to your guest data</a>\n            </div>\n\n            <div class="secondary-action" ng-if="::!purchase.isGuest && purchase.isCartProcess">\n                <a class="btn btn-link"\n                   ng-href="{{purchase.data.orders[0].offers[0].viewUrl}}"\n                   ng-if="::purchase.isStartedFromBuyNow"\n                   target="_self"\n                   translate>back to offer</a>\n                <button class="btn btn-link" type="button"\n                   ng-click="purchase.redirectTo((\'cart\' | url))"\n                   ng-if="::!purchase.isStartedFromBuyNow" translate>back to your cart</button>\n            </div>\n            <div class="secondary-action" ng-if="::!purchase.isGuest && !purchase.isCartProcess">\n                <a class="btn btn-link"\n                   ng-href="/dashboard/myorders/#/"\n                   target="_self"\n                   translate>back to my orders</a>\n            </div>\n        </div>\n    </section>\n</form>\n\n<affiliate-program></affiliate-program>\n'},function(e,t){e.exports='<section id="summary" class="summary auto-number-headings">\n\n    <section class="alert alert-success" ng-if="purchase.isPaymentInProgress">\n        <h4 translate>You can not edit anything in this purchase.</h4>\n        <p>\n            <translate>Payment has already started.</translate>\n            <span ng-if="!purchase.isGuest">\n                <a ng-href="/dashboard/myorders"\n                   target="_self"\n                   translate>Check status at My orders</a>.\n            </span>\n        </p>\n    </section>\n\n    <section class="buyers-address" ng-if="::purchase.isGuest">\n        <h2 class="auto-num" translate>your address data</h2>\n        <addresses-section\n                user-addresses="purchase.userAddresses"\n                active-address="purchase.mainUserAddress"\n                has-invoice-address="false"\n                invoice-address=""\n                locale="purchase.locale"\n                summary-mode="true"\n                summary-show-back-url="true"\n                summary-back-url="::purchase.backToGuestDataFormUrl"\n                is-guest="::purchase.isGuest">\n        </addresses-section>\n    </section>\n\n    <section ui-view="delivery"></section>\n\n    <section class="selected-address">\n        <h2 class="auto-num" translate>shipping address data</h2>\n        <addresses-section\n            user-addresses="purchase.userAddresses"\n            active-address="purchase.activeAddress"\n            has-invoice-address="purchase.isInvoiceAvailable"\n            invoice-address="purchase.invoiceAddress"\n            locale="purchase.locale"\n            summary-mode="true"\n            summary-show-back-url="::!purchase.isPaymentInProgress"\n            summary-back-url="::summary.backUrl"\n            is-guest="::purchase.isGuest">\n        </addresses-section>\n    </section>\n\n    <section class="selected-payment-method payment-component" ng-if="!purchase.isPaymentInProgress" ng-hide="purchase.isPurchasePostpaidOnly">\n        <h2 class="auto-num" translate>chosen payment method</h2>\n        <payments-methods\n            payments="purchase.paymentsData.payments"\n            payment-id="purchase.paymentId"\n            metadata="purchase.data.metadata"\n            domain-api="purchase.apiUrl"\n            locale="purchase.locale"\n            env="purchase.env"\n            summary-mode="true"\n            summary-show-back-url="::!purchase.isPaymentInProgress"\n            summary-back-url="::summary.backUrl">\n        </payments-methods>\n    </section>\n\n    <switch-payment-method-provider\n        ng-if="purchase.paymentsData.payments"\n        payment-id="purchase.paymentId"\n        payments="purchase.paymentsData.payments"\n        selected-method="purchase.paymentsData.payments.selectedMethod"\n        purchase-id="purchase.data.id"\n        on-toggle-provider="summary.setUpdated($event.isUpdated)"\n    ></switch-payment-method-provider>\n\n    <toggle-blik-alias\n        ng-if="purchase.paymentsData.payments"\n        payments="purchase.paymentsData.payments"\n        payment-id="purchase.paymentId"\n        selected-method="purchase.paymentsData.payments.selectedMethod"\n        available-methods="purchase.paymentsData.payments.availableMethods"\n        purchase-id="purchase.data.id"\n        on-toggle-blik-mode="summary.setUpdated($event.isUpdated)"\n    ></toggle-blik-alias>\n\n    <section class="m-card" ng-if="summary.isInstallmentsSelected()">\n        <installments-calculator\n                purchase="purchase.data"\n                domain-api="purchase.apiUrl"\n                env="purchase.env"\n                delivery-cheapest-price="summary.totalDeliveryCost(purchase.data.orders)"\n                on-installments-change="purchase.installmentsData = installmentsData"\n        ></installments-calculator>\n    </section>\n\n    <section id="total-cost" class="summation">\n        <purchase-summation\n            payment-id="purchase.paymentId"\n            orders="::purchase.data.orders"\n            purchase-service="::purchase.data.service"\n            summary-mode="::true"\n            payments="purchase.paymentsData.payments">\n        </purchase-summation>\n    </section>\n\n    <blik-confirm selected-method="purchase.paymentsData.payments.selectedMethod"></blik-confirm>\n\n    <guest-verification\n        ng-if="!purchase.isPaymentInProgress"\n        is-guest="::purchase.isGuest"\n        guest-data="purchase.activeAddress"\n        verification-code="purchase.guestVerificationCode"\n        purchase-id="purchase.data.id"\n        buy-validation-error="summary.buyValidationError"\n    ></guest-verification>\n\n    <section id="confirm" class="confirm" ng-if="!purchase.isPaymentInProgress">\n        <div class="row">\n            <buy-button\n                class="primary-action"\n                ng-if="purchase.paymentsData.payments && !summary.isInstallmentPayment()"\n                purchase="::purchase"\n                disabled="!summary.isVerificationCodeSet() || summary.paymentsMethodsService.isSetBlikCode(purchase.paymentsData.payments.selectedMethod) || summary.isUpdated"\n                on-success="::summary.onBought()"\n                on-buy-command-error="summary.onBuyCommandError(error)"\n                ng-click="summary.enableTradeDoubler()">\n            </buy-button>\n\n            <div class="primary-action"\n                 ng-if="purchase.paymentsData.payments && summary.isInstallmentPayment()">\n                <button id="confirm-summary"\n                        ng-class="{\'btn-installments\': summary.isInstallmentsSelected()}"\n                        class="btn spinner btn-primary"\n                        type="submit"\n                        ng-disabled="summary.isBuying"\n                        ng-click="summary.enableTradeDoubler(); summary.buyDeferred()">\n                    <span translate>go to application</span>\n                </button>\n            </div>\n\n            <div class="secondary-action">\n                <a class="btn btn-link" ui-sref="purchase.dapf" translate>go back to delivery form</a>\n            </div>\n        </div>\n        <div class="row">\n            <installments-agreement payments="purchase.paymentsData.payments"></installments-agreement>\n        </div>\n\n        <trade-doubler ng-if="summary.isTradeDoublerEnabled"\n                       organization-id="summary.tradeDoublerData.organizationId"\n                       purchase-id="summary.tradeDoublerData.purchaseId"\n                       currency="summary.tradeDoublerData.currency"\n                       trade-doubler-uid="summary.tradeDoublerData.uid"\n                       products="summary.tradeDoublerData.products">\n        </trade-doubler>\n    </section>\n</section>\n\n<affiliate-program></affiliate-program>\n'},function(e,t){e.exports='<section id="delivery-data" class="delivery">\n    <h2 class="auto-num" ng-if="::!purchase.isGuest" translate>chosen delivery method</h2>\n    <h2 class="auto-num" ng-if="::purchase.isGuest" translate>purchase and delivery methods</h2>\n    <section class="delivery-group">\n        <summary-delivery-bundle\n            class="summary-delivery-bundle"\n            ng-repeat="order in ::purchase.data.orders track by order.id"\n            service="::purchase.data.service"\n            order="::order"\n            locale="::purchase.locale"\n            show-payment-icons="::purchase.showPaymentIcons"\n            back-url="::summary.backUrl"\n            show-back-url="::!purchase.isPaymentInProgress"\n            residence-address="::purchase.residenceAddress"\n            is-last="$last">\n        </summary-delivery-bundle>\n    </section>\n</section>\n'},function(e,t){e.exports='<div ng-if="!cvvVerification.showWidget" class="spinner spinner-large"></div>\n<section id="cvv-verification" class="page-default cvv-verification fb" ng-if="cvvVerification.showWidget">\n    <header class="page-header divider-mask-bottom">\n        <h1 translate>confirm CVV code</h1>\n    </header>\n\n    <section class="content">\n        <h2 translate>To complete your payment, provide the CVV code that secures your card.</h2>\n        <p translate>In some cases, we ask you to confirm the CVV code due to security reasons.</p>\n\n        <cvv-confirmation\n                env="cvvVerification.environment"\n                cvv-params="cvvVerification.cvvParams"\n                locale="cvvVerification.locale">\n        </cvv-confirmation>\n\n    </section>\n</section>'},function(e,t){e.exports='<svg class="thank-you-mask" width="0" height="0">\n    <filter id="m-color-filter-orange" color-interpolation-filters="sRGB">\n        <feColorMatrix values="0 0 0 0 1 0 0 0 0 0.352 0 0 0 0 0 0 0 0 1 0" />\n    </filter>\n</svg>\n\n<prime-banner ng-if="thankYou.shouldDisplayPrimeBanner()"></prime-banner>\n<section\n    id="thank-you" class="thank-you m-grid m-flex-column"\n    ng-class="{\n        \'metrumize\': thankYou.isThemeMetrumize, \n        \'thank-you-background\': thankYou.isThankYouLoaded && !thankYou.getPurchaseFailed\n    }">\n    <div ng-if="thankYou.isThankYouLoaded && !thankYou.getPurchaseFailed" class="thank-you-column m-grid__col m-grid__col--6@lg">\n        <header class="thank-you-header">\n            <h3 class="thank-you-header-heading m-heading m-heading--md" translate>Thank you for purchase.</h3>\n            <p class="m-type m-type--paragraph" translate>We hope, you will come back to use soon.</p>\n        </header>\n        <ui-view></ui-view>\n        <div class="m-grid__col--12">\n            <a ng-if="thankYou.isRegistrationEligible" ng-href="{{::thankYou.hostUrl}}/rejestracja/#/gosc" target="_self" class="btn btn-primary" nga-action="thp-guest-registration" translate>Finish registration</a>\n        </div>\n    </div>\n\n    <alert-error ng-if="thankYou.getPurchaseFailed" reason="thankYou.getPurchaseFailReason"></alert-error>\n\n    <section id="thank-you-ad" ng-if="thankYou.purchaseDfpConfig\n             && thankYou.purchaseDfpConfig.active\n             && thankYou.isThankYouLoaded\n             && !thankYou.getPurchaseFailed"\n             class="m-grid__col m-grid__col--12">\n        <dfp class="dfp" dfp-config="thankYou.purchaseDfpConfig"></dfp>\n    </section>\n\n    <div ng-if="!thankYou.isThankYouLoaded" class="loader-wrapper">\n        <div class="m-spinner"></div>\n    </div>\n</section>'},function(e,t){e.exports='<section id="details" class="details">\n    <bought-from offers-count="thankYou.offersCount" sellers-count="thankYou.sellersCount"></bought-from>\n    <payment-status type="success" status="{{thankYou.paymentStatus}}" is-guest="thankYou.isGuestFlow"></payment-status>\n    <payment-cycle cycle="thankYou.paymentStatus" is-blik-method="thankYou.isBlikSelectedMethod" is-guest="thankYou.isGuestFlow" is-provider-offline="thankYou.isProviderOffline"></payment-cycle>\n</section>'},function(e,t){e.exports='<section id="details" class="details">\n    <bought-from offers-count="thankYou.offersCount" sellers-count="thankYou.sellersCount"></bought-from>\n    <payment-status type="blik" status="{{thankYou.paymentStatus}}" is-guest="thankYou.isGuestFlow"></payment-status>\n    <payment-cycle cycle="thankYou.paymentStatus" is-blik-method="thankYou.isBlikSelectedMethod" is-guest="thankYou.isGuestFlow" is-provider-offline="thankYou.isProviderOffline"></payment-cycle>\n</section>'},function(e,t){e.exports='<section id="details" class="details">\n    <bought-from offers-count="thankYou.offersCount" sellers-count="thankYou.sellersCount"></bought-from>\n    <payment-status type="error" status="{{thankYou.paymentStatus}}" is-guest="thankYou.isGuestFlow"></payment-status>\n    <payment-cycle cycle="thankYou.paymentStatus" is-blik-method="thankYou.isBlikSelectedMethod" is-guest="thankYou.isGuestFlow" is-provider-offline="thankYou.isProviderOffline"></payment-cycle>\n</section>'},function(e,t){e.exports='<section id="details" class="details">\n    <payment-status type="announcement" status="{{thankYou.paymentStatus}}" is-guest="thankYou.isGuestFlow"></payment-status>\n</section>'},function(e,t){e.exports='<section ng-class="{\'metrumize\': errorLanding.isThemeMetrumize}" id="purchase-error-handler" class="purchase-error-handler">\n    <header class="page-header separator separator-bottom">\n        <h1 translate>An error occurred</h1>\n    </header>\n    <section class="details">\n        <buy-error-list\n            ng-if="errorLanding.isValidationIdAvailable"\n            validation-id="errorLanding.validationId">\n        </buy-error-list>\n    </section>\n    <section class="confirm">\n        <div class="row">\n            <div class="primary-action">\n                <button class="btn btn-primary"\n                    ng-if="::errorLanding.isCart"\n                    type="button"\n                    ng-click="errorLanding.redirectTo((\'cart\' | url))">\n                    <span translate>back to cart</span>\n                </button>\n                <button class="btn btn-primary"\n                    ng-if="::!errorLanding.isCart"\n                    type="button"\n                    ng-click="errorLanding.redirectTo((\'offer\' | url:errorLanding.id))">\n                    <span translate>back to item page</span>\n                </button>\n            </div>\n        </div>\n    </section>\n</section>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function GuestAuthInterceptorSvc(e,t){"ngInject";GuestAuthInterceptorSvc.$injector=e,GuestAuthInterceptorSvc.configurationSvc=t}return GuestAuthInterceptorSvc.$inject=["$injector","ConfigurationSvc"],GuestAuthInterceptorSvc.prototype.request=function(e){var t=GuestAuthInterceptorSvc.$injector.get("$state");if(GuestAuthInterceptorSvc.shouldProxyRequest(t,e)){var r=/(https?:\/\/.*?)(\/.*)/,n=r.exec(e.url);e.url=n[1]+GuestAuthInterceptorSvc.guestProxyPrefix+n[2]}return e},GuestAuthInterceptorSvc.shouldProxyRequest=function(e,t){return GuestAuthInterceptorSvc.configurationSvc.isGuest(e)&&!GuestAuthInterceptorSvc.guestProxyPattern.test(t.url)&&GuestAuthInterceptorSvc.urlPatterns.some(function(e){return e.test(t.url)})},GuestAuthInterceptorSvc.urlPatterns=[/\/purchases\/.+/,/\/payments\/.+\/methods/,/\/contributions\/acl/,/\/payment\/finalize/,/\/payments\/public/],GuestAuthInterceptorSvc.guestProxyPattern=/\/guest/,GuestAuthInterceptorSvc.guestProxyPrefix="/guest",GuestAuthInterceptorSvc}();t.GuestAuthInterceptorSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpInterceptorSvc=void 0;var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=function(){function HttpInterceptorSvc(e,t,r,n,o,i){"ngInject";HttpInterceptorSvc.$q=e,HttpInterceptorSvc.$location=t,HttpInterceptorSvc.$window=r,HttpInterceptorSvc.$injector=n,HttpInterceptorSvc.purchaseConstants=o,HttpInterceptorSvc.configurationSvc=i}return HttpInterceptorSvc.$inject=["$q","$location","$window","$injector","PURCHASE_CONSTANTS","ConfigurationSvc"],HttpInterceptorSvc.prototype.responseError=function(e){var t=o.isDefined(e.config.headers[HttpInterceptorSvc.X_RETRIES])?e.config.headers[HttpInterceptorSvc.X_RETRIES]:0;return e.config.headers[HttpInterceptorSvc.X_RETRIES]=t+1,401===e.status&&HttpInterceptorSvc.invalidTokenRedirect(),(503===e.status||-1===e.status)&&e.config.headers[HttpInterceptorSvc.X_RETRIES]<=HttpInterceptorSvc.purchaseConstants.HTTP_RETRIES?(e.config.headers[HttpInterceptorSvc.X_RETRIES_CAUSE]=""+e.status,HttpInterceptorSvc.$injector.get("$http")(e.config)):HttpInterceptorSvc.$q.reject(e)},HttpInterceptorSvc.invalidTokenRedirect=function(){var e=HttpInterceptorSvc.configurationSvc.getHost().replace("ssl.",""),t=encodeURIComponent(this.$location.absUrl());HttpInterceptorSvc.$window.location.href="https://"+e+"/login/auth?origin_url="+t},HttpInterceptorSvc.X_RETRIES="X-RETRIES",HttpInterceptorSvc.X_RETRIES_CAUSE="X-RETRIES-CAUSE",HttpInterceptorSvc}();t.HttpInterceptorSvc=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PurchaseCtrl=void 0;var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=function(){function PurchaseCtrl(e,t,r,n,o,i,a,s,c,l,u,d,p,f,h,m,v,y,g){"ngInject";this.isCartProcess=!1,this.isRelatedProcess=!1,this.isStartedFromBuyNow=!1,this.showPaymentIcons=!1,this.isPurchaseLoaded=!1,this.getPurchaseFailed=!1,this.purchaseUpdateFailed=!1,this.paymentId=null,this.isPaymentInProgress=!1,this.isUpdateInProgress=!1,this.isPhoneRequired=!1,this.hasAccountAddress=null,this.buyerId=null,this.buyer=null,this.isPurchasePostpaidOnly=!1,this.isBuyerVerificationRequired=!1,this.guestVerificationCode="",this.flags=[],this.$state=e,this.$q=t,this.$scope=r,this.$exceptionHandler=n,this.$timeout=o,this.gettextCatalog=i,this.redirectTo=m,this.purchaseSvc=a,this.purchaseConstants=c,this.CustomException=f,this.purchaseSummationSvc=v,this.modalSvc=y,this.configurationSvc=s,this.setConfigurationFields(),this.paymentsData=p.paymentsData,this.initializeAnalytics(d,l,u),this.initializePurchase(),this.debouncer=g,this.debouncedUpdatePurchase=this.createDebouncedUpdatePurchase(h),this.backToGuestDataFormUrl=s.getBackToGuestDataFormUrl()}return PurchaseCtrl.$inject=["$state","$q","$scope","$exceptionHandler","$timeout","gettextCatalog","PurchaseSvc","ConfigurationSvc","PURCHASE_CONSTANTS","PurchaseNgaSvc","PurchaseGtmSvc","AnalyticsCfgSvc","StorageSvc","CustomException","debounce","redirectTo","PurchaseSummationSvc","ModalSvc","DebouncerSvc"],PurchaseCtrl.prototype.updatePurchase=function(){var e=this,t=o.copy(this.data),r=this.data.options.addresses[0];return this.isUpdateInProgress=!0,t.orders.forEach(function(t){t.delivery.address=e.activeAddress||r,delete t.delivery.address.id,e.invoiceAddress&&e.invoiceAddress.street?(t.invoice.address=o.copy(e.invoiceAddress),t.invoice.address.countryCode=e.activeAddress.countryCode):t.invoice.address=null}),this.purchaseSvc.updatePurchase(t.id,t).then(function(t){if(t.payment&&t.payment.id)e.paymentId=t.payment.id;else{var r=new e.CustomException({name:"PurchaseCtrlException",message:"No payment id after purchase update"});e.$exceptionHandler(r)}return e.purchaseUpdateFailed=!1,e.isPurchasePostpaidOnly=e.purchaseSvc.isPurchasePostpaidOnly(t.orders),t},function(t){var r=e.modalSvc.prepareOptionsFromReason(t);e.modalSvc.showErrorReason(r),e.purchaseUpdateFailed=!0}).finally(function(){e.isUpdateInProgress=!1})},PurchaseCtrl.prototype.setConfigurationFields=function(){this.locale=this.configurationSvc.getLocale(),this.language=this.locale.language,this.countryCode=this.locale.country,this.env=this.configurationSvc.getEnvironment(),this.apiUrl=this.configurationSvc.getApiUrl(),this.isThemeMetrumize=this.configurationSvc.isThemeMetrumize(),this.isGuest=this.configurationSvc.isGuest(this.$state)},PurchaseCtrl.prototype.initializeAnalytics=function(e,t,r){e.getConfig().then(function(e){t.initialize(e.nga)})},PurchaseCtrl.prototype.initializePurchase=function(){var e=this;this.purchaseSvc.getPurchase(this.$state.params.purchaseId).then(function(t){return e.consumePurchase(t)},function(t){t.data&&Array.isArray(t.data.errors)&&t.data.errors[0]&&(e.getPurchaseFailReason={statusCode:t.status,userMessage:t.data.errors[0].userMessage,traceId:"function"==typeof t.headers?t.headers("Trace-Id"):""}),e.getPurchaseFailed=!0,e.isPurchaseLoaded=!0})},PurchaseCtrl.prototype.consumePurchase=function(e){var t=this;this.data=e,PurchaseCtrl.removeInvoiceAddressIdIfPresent(e.orders),this.setVariantSizeInMessageToSeller(e.orders),this.processEntry=e.metadata&&e.metadata.processEntry||null,this.flags=e.metadata&&e.metadata.flags||[],this.buyerId=e.buyer.id,this.buyer=e.buyer,this.hasAccountAddress=e.buyer.hasAccountAddress,this.userAddresses=this.$q.when(e.options.addresses),this.userAddresses.then(function(e){return t.mainUserAddress=e[0]||null}),this.residenceAddress=e.options.addresses[0]||null,this.activeAddress=PurchaseCtrl.getActiveAddress(e.orders),this.invoiceAddress=PurchaseCtrl.getInvoiceAddress(e.orders),this.isInvoiceAvailable=PurchaseCtrl.isInvoiceAvailableForOrders(e.orders),this.isPhoneRequired=e.buyer.verificationRequired||PurchaseCtrl.isPhoneRequiredForOrders(e.orders),this.isPurchasePostpaidOnly=this.purchaseSvc.isPurchasePostpaidOnly(e.orders),this.isCartProcess=!this.$state.includes("purchase.preBuyNow")&&e.status!==this.purchaseConstants.PURCHASE_STATUS.BOUGHT,this.isRelatedProcess=this.isRelatedProcessActive(),this.isStartedFromBuyNow=this.processEntry===this.purchaseConstants.FLOW.BUY_NOW,this.isPurchaseLoaded=!0,this.isBuyerVerificationRequired=e.buyer.verificationRequired,this.isBuyerVerificationRequired&&(this.phoneNumberPattern=this.configurationSvc.getValidationRules().phoneNumberPattern,this.phoneNumberMask=this.configurationSvc.getValidationRules().phoneNumberMask),e.payment&&(this.isPaymentStatusInProgress(e.payment)&&(this.isPaymentInProgress=!0,this.$state.go("purchase.summary.view",null,{location:"replace"})),e.payment.id&&(this.paymentId=e.payment.id)),this.summationMock(e.orders),this.setWatchers()},PurchaseCtrl.prototype.isRelatedProcessActive=function(){return this.$state.includes("purchase.preBuyNow")||this.$state.includes("purchase.related")||this.processEntry===this.purchaseConstants.FLOW.RELATED},PurchaseCtrl.removeInvoiceAddressIdIfPresent=function(e){e.forEach(function(e){e.invoice&&!0===e.invoice.available&&e.invoice.address&&e.invoice.address.id&&delete e.invoice.address.id})},PurchaseCtrl.prototype.setVariantSizeInMessageToSeller=function(e){var t=this.gettextCatalog.getString("I choose size");e.forEach(function(e){if(null===e.messageToSeller){var r=e.offers.filter(function(e){return!!e.variantDetails}).reduce(function(e,r){return e+r.id+": "+t+" "+r.variantDetails.size+"\n"},"");e.messageToSeller=r||null}})},PurchaseCtrl.getActiveAddress=function(e){var t=e[0].delivery;return t&&t.address?t.address:{}},PurchaseCtrl.getInvoiceAddress=function(e){var t=null;return e.some(function(e){return!(!e.invoice||!0!==e.invoice.available)&&(t=e.invoice.address,!0)}),t},PurchaseCtrl.isInvoiceAvailableForOrders=function(e){return e.some(function(e){return e.invoice&&!0===e.invoice.available})},PurchaseCtrl.isPhoneRequiredForOrders=function(e){return e.some(function(e){return e.delivery&&e.delivery.features&&!0===e.delivery.features.phoneRequired})},PurchaseCtrl.prototype.isPaymentStatusInProgress=function(e){return!(!e||!e.status||e.status.toUpperCase()===this.purchaseConstants.PAYMENT_STATUS.CREATED)},PurchaseCtrl.prototype.createDebouncedUpdatePurchase=function(e){var t=this,r=this.debouncer.debouncePromise(function(){return t.updatePurchase()}),n=e(1e3,function(){t.isDapfFormReadyForUpdate()?r():n.cancel()});return n},PurchaseCtrl.prototype.isDapfFormReadyForUpdate=function(){return this.dapfForm&&(this.dapfForm.$dirty||this.dapfForm.addresses&&this.dapfForm.addresses.$dirty)&&this.dapfForm.delivery&&this.dapfForm.delivery.$valid&&this.dapfForm.addresses&&this.dapfForm.addresses.$valid},PurchaseCtrl.prototype.summationMock=function(e){e.forEach(function(e){var t=e.offers.reduce(function(e,t){return e+parseFloat(t.price.amount)*t.quantity},0),r=e.offers.map(function(e){return(e.additionalServices||[]).reduce(function(t,r){return t+parseFloat(r.unitPrice.amount)*e.quantity},0)}).reduce(function(e,t){return e+t},0);e.summation={currency:e.offers[0].price.currency,totalOffersPrice:t,totalAdditionalServicesPrice:r}})},PurchaseCtrl.prototype.setWatchers=function(){var e=this,t=function(){e.$timeout(function(){e.isDapfFormReadyForUpdate()&&(e.isPhoneRequired=PurchaseCtrl.isPhoneRequiredForOrders(e.data.orders),e.isUpdateInProgress=!0,e.debouncedUpdatePurchase())},0)};this.data.orders.forEach(function(r){e.$scope.$watch(function(){return r.delivery},t,!0),e.$scope.$watch(function(){return r.messageToSeller},t,!0)}),this.$scope.$watch(function(){return e.activeAddress},t,!0),this.$scope.$watch(function(){return e.invoiceAddress},t,!0)},PurchaseCtrl}();t.PurchaseCtrl=i},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function GuestRegistrationSvc(e,t){"ngInject";this.$http=e,this.ConfigurationSvc=t}return GuestRegistrationSvc.$inject=["$http","ConfigurationSvc"],GuestRegistrationSvc.prototype.sendGuestRegistrationRequest=function(e){return this.$http.post(this.getApiUrl(),{verificationCode:e})},GuestRegistrationSvc.prototype.getApiUrl=function(){return this.ConfigurationSvc.getApiUrl()+"/guest/registration"},GuestRegistrationSvc}();t.GuestRegistrationSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PurchaseSvc(e,t,r,n,o,i,a,s){"ngInject";this.$q=e,this.$http=t,this.$state=r,this.$timeout=n,this.ConfigurationSvc=o,this.CustomException=i,this.PURCHASE_CONSTANTS=a,this.$exceptionHandler=s}return PurchaseSvc.$inject=["$q","$http","$state","$timeout","ConfigurationSvc","CustomException","PURCHASE_CONSTANTS","$exceptionHandler"],PurchaseSvc.prototype.getPurchasesApiUrl=function(e){return this.ConfigurationSvc.getApiUrl()+"/purchases/"+e},PurchaseSvc.prototype.getId=function(){return this.$state.params.purchaseId},PurchaseSvc.prototype.getPurchase=function(e,t){var r=this,n=this.getPurchasesApiUrl(e);return this.$http.get(n,t).then(function(e){return e.data},function(e){return r.onFailure("GetPurchaseException","Failed to load purchase",e)})},PurchaseSvc.prototype.getPurchaseV2=function(e){return this.getPurchase(e,{headers:this.requestHeadersV2(),params:{decorators:PurchaseSvc.CATEGORY_PURCHASE_DECORATOR}})},PurchaseSvc.prototype.updatePurchase=function(e,t){var r=this,n=this.getPurchasesApiUrl(e);return this.$http.put(n,t).then(function(e){return e.data},function(e){return r.onFailure("UpdatePurchaseException","Failed to update purchase",e)})},PurchaseSvc.prototype.buyPurchase=function(e,t,r){var n=this,o=this.getPurchasesApiUrl(e)+"/buy-commands/web",i={headers:{"Transaction-Type":this.getTransactionType(t)}},a={};return this.ConfigurationSvc.isGuest(this.$state)&&r&&"string"==typeof r&&(a.verificationCode=r),this.$http.put(o,a,i).then(function(e){if(201!==e.status){var t=new n.CustomException({name:"BuyCommandException",message:"Buy command returned invalid status code: "+e.status,error:e});return n.$exceptionHandler(t),n.$q.reject(t)}return e.data},function(e){return Array.isArray(e.data.errors)&&!n.shouldThrowExceptionOnBuyAttempt(e.data.errors[0])||n.handleCustomException("BuyCommandException","Failed to execute buy command",e),n.$q.reject(e)})},PurchaseSvc.prototype.createPurchaseFromOrderIds=function(e){var t=this,r=this.ConfigurationSvc.getApiUrl()+"/purchases/related/internal",n={service:{countryCode:this.ConfigurationSvc.getLocale().country},orders:e.map(function(e){return{id:e}})};return this.$http.post(r,n).then(function(e){return e.data},function(e){return t.onFailure("CreatePurchaseException","Failed to create purchase from orders",e)})},PurchaseSvc.prototype.getTransactionType=function(e){return e?this.PURCHASE_CONSTANTS.FLOW.CART:this.PURCHASE_CONSTANTS.FLOW.BUY_NOW},PurchaseSvc.prototype.checkPurchaseStatusInIntervals=function(e,t){var r=this,n=this.getPurchasesApiUrl(e)+"/status";return this.$http.get(n).then(function(n){if(n.data.status===r.PURCHASE_CONSTANTS.PURCHASE_STATUS.BUYING){if(t.length){var o=t[0];return r.$timeout(o).then(function(){return r.checkPurchaseStatusInIntervals(e,t.slice(1))})}return n.data}return n.data},function(e){return r.onFailure("CheckPurchaseStatusException","Failed to check purchase status",e)})},PurchaseSvc.prototype.isPrepaidMethodInOrder=function(e){return!!(e.delivery&&e.delivery.deliveryMethod&&e.delivery.deliveryMethod.payment&&e.delivery.deliveryMethod.payment.type===this.PURCHASE_CONSTANTS.DELIVERY.PAYMENT.PREPAID)},PurchaseSvc.prototype.isPurchasePostpaidOnly=function(e){return!e.some(this.isPrepaidMethodInOrder,this)},PurchaseSvc.prototype.shouldThrowExceptionOnBuyAttempt=function(e){return e.code!==PurchaseSvc.GUEST_VERIFICATION_FAILED_ERROR},PurchaseSvc.prototype.requestHeadersV2=function(){return{Accept:"application/vnd.allegro.public.v2+json","Content-Type":"application/vnd.allegro.public.v2+json"}},PurchaseSvc.prototype.onFailure=function(e,t,r){return this.handleCustomException(e,t,r),this.$q.reject(r)},PurchaseSvc.prototype.handleCustomException=function(e,t,r){var n=new this.CustomException({name:e,message:t,error:r});this.$exceptionHandler(n)},PurchaseSvc.GUEST_VERIFICATION_FAILED_ERROR="VERIFICATION_FAILED_ERROR",PurchaseSvc.CATEGORY_PURCHASE_DECORATOR="Category",PurchaseSvc}();t.PurchaseSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function StorageSvc(){this.installmentsData={},this.paymentsData={}}return StorageSvc.prototype.clearPaymentsData=function(){this.paymentsData={}},StorageSvc}();t.StorageSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function UserSvc(e,t,r,n,o,i){"ngInject";this.$http=e,this.$q=t,this.$exceptionHandler=r,this.configurationSvc=n,this.CustomException=o,this.gettextCatalog=i}return UserSvc.$inject=["$http","$q","$exceptionHandler","ConfigurationSvc","CustomException","gettextCatalog"],UserSvc.prototype.saveUserAddress=function(e,t){var r=this,n=this.configurationSvc.getApiUrl()+"/users/"+e,o={headers:{environment:this.configurationSvc.getHost()}};return this.$http.put(n,this.mapAddressToUsersDBFormat(t),o).catch(function(e){var t=new r.CustomException({name:"SaveUserAddressException",message:"Failed to save user address to DB",userMessage:r.gettextCatalog.getString("Failed to save address, please try again."),error:e});return r.$exceptionHandler(t),r.$q.reject(e)})},UserSvc.prototype.mapAddressToUsersDBFormat=function(e){var t={person:{firstName:e.firstName,lastName:e.lastName,nationality:e.countryCode},addresses:{residence:{countryCode:e.countryCode,zipCode:e.zipCode,city:e.city}},contacts:{phone:{fullNumber:e.phoneNumber}}};return t.addresses.residence.addressLine=e.street,t},UserSvc}();t.UserSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function Constants(){}return Constants.getPurchase=function(){return{PURCHASE_STATUS:{DRAFT:"DRAFT",BUYING:"BUYING",BOUGHT:"BOUGHT",PARTIALLY_BOUGHT:"PARTIALLY_BOUGHT",BUY_FAILED:"BUY_FAILED"},FLOW:{CART:"CART",BUY_NOW:"BUY_NOW",RELATED:"RELATED"},USER_FLOW:{USER:"user",GUEST:"guest"},PAYMENT_STATUS:{CREATED:"CREATED"},DELIVERY:{PAYMENT:{POSTPAID:"POSTPAID",PREPAID:"PREPAID"}},CHECK_STATUS_INTERVALS:[200,300,500,500,1e3,3e3,3e3,3e3,3e3,5e3,5e3,5e3],HTTP_RETRIES:5,NGA_STATE_TAG:{PRE_BUY_NOW:"PreBuyNow",RELATED:"Related",DAPF:"Delivery&PaymentForm",SUMMARY:"Summary",THANK_YOU:"ThankYouPage"},NGA_VALID_REFERRERS:["MyOrders"]}},Constants.getConfiguration=function(){return{ENVIRONMENT:{PRODUCTION:{ID:"PRODUCTION",CLIENT_ID:"order_fnd"},TEST:{ID:"TEST",CLIENT_ID:"client_id"}},LOCALE:[{service:"allegro.pl",language:"pl",country:"PL",languageTag:"pl-PL",currency:"PLN"},{service:"aukro.cz",language:"cs",country:"CZ",languageTag:"cs-CZ",currency:"CZK"},{service:"localhost",language:"pl",country:"PL",languageTag:"pl-PL",currency:"PLN"}],FEATURES:{THEME_METRUMIZE:[]},VALIDATION:{PL:{messageToSellerMaxLength:1e3,phoneNumberMask:"+48 999 999 999",phoneNumberPattern:/^(00|\+)?48([- ]*[\d]{3}){3}[- ]*$/},CZ:{messageToSellerMaxLength:1e3,phoneNumberMask:"+420 999 999 999",phoneNumberPattern:/^(00|\+)?420([- ]*[\d]{3}){3}[- ]*$/}},URLS:{PL:{cart:"/cart",bought:"/dashboard/myorders/#",contact:"https://pomoc.allegro.pl/kontakt",offer:"/show_item.php?item=%1"},CZ:{cart:"/cart",bought:"/myaccount/won.php",contact:"https://napoveda.aukro.cz/kontakt",offer:"/show_item.php?item=%1"}}}},Constants}();t.Constants=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ConfigurationSvc(e,t,r){"ngInject";this.currentEnvironment=null,this.locale=null,this.apiUrl=null,this.host=null,this.$location=e,this.configuration=t,this.purchaseConstants=r}return ConfigurationSvc.$inject=["$location","CONFIGURATION","PURCHASE_CONSTANTS"],ConfigurationSvc.prototype.getHost=function(){return null===this.host&&(this.host=this.$location.host()),this.host},ConfigurationSvc.prototype._getEnvironment=function(){return new RegExp("(^|.*\\.)(allegro\\.pl|aukro\\.cz)$").test(this.getHost())?this.configuration.ENVIRONMENT.PRODUCTION.ID:this.configuration.ENVIRONMENT.TEST.ID},ConfigurationSvc.prototype.getEnvironment=function(){return null===this.currentEnvironment&&(this.currentEnvironment=this._getEnvironment()),this.currentEnvironment},ConfigurationSvc.prototype._getLocale=function(){var e,t=this;return e=this.configuration.LOCALE.filter(function(e){return t.getHost().indexOf(e.service)>-1}),e[0]||this.configuration.LOCALE[0]},ConfigurationSvc.prototype.getLocale=function(){return null===this.locale&&(this.locale=this._getLocale()),this.locale},ConfigurationSvc.prototype._getApiUrl=function(){var e=this.getHost().split(".");return"ssl"===e[0]&&e.shift(),"localhost"===this.getLocale().service?"http://"+this.getHost()+":"+this.$location.port():"https://edge."+e.join(".")},ConfigurationSvc.prototype.getApiUrl=function(){return null===this.apiUrl&&(this.apiUrl=this._getApiUrl()),this.apiUrl},ConfigurationSvc.prototype.getClientId=function(){var e=this.getEnvironment();return this.configuration.ENVIRONMENT[e].CLIENT_ID},ConfigurationSvc.prototype.getVteName=function(e){var t=/^vte(\d+)$/,r=null;return e.split(".").some(function(e){if(t.test(e))return r=e,!0}),r},ConfigurationSvc.prototype.isProduction=function(){return this.getEnvironment()===this.configuration.ENVIRONMENT.PRODUCTION.ID},ConfigurationSvc.prototype.isThemeMetrumize=function(){return this.configuration.FEATURES.THEME_METRUMIZE.some(this._isCurrentCountry,this)},ConfigurationSvc.prototype.getValidationRules=function(){var e=this.getLocale().country;return this.configuration.VALIDATION[e]},ConfigurationSvc.prototype.getUrls=function(){var e=this.getLocale().country;return this.configuration.URLS[e]},ConfigurationSvc.prototype._isCurrentCountry=function(e){return e===this.getLocale().country},ConfigurationSvc.prototype.isGuest=function(e){return"guest"==this.getUserFlow(e)},ConfigurationSvc.prototype.getBackToDapfUrl=function(e,t){return"/transaction-front/app/"+this.getUserFlow(t)+"/purchase/"+e+"/dapf"},ConfigurationSvc.prototype.getBackToGuestDataFormUrl=function(){return"/guest/order-form"},ConfigurationSvc.prototype.getV1Header=function(){return"application/vnd.allegro.public.v1+json"},ConfigurationSvc.prototype.getUserFlow=function(e){return e&&e.params&&e.params.userFlow?e.params.userFlow:this.purchaseConstants.USER_FLOW.USER},ConfigurationSvc}();t.ConfigurationSvc=n},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(52);Object.defineProperty(t,"__esModule",{value:!0}),t.SummaryModule=void 0;var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(53),a=r(54),s=r(2),c=_interopRequireDefault(s),l=r(3),u=_interopRequireDefault(l),d=r(4),p=_interopRequireDefault(d),f=r(11),h=_interopRequireDefault(f),m=r(13),v=_interopRequireDefault(m),y=r(14),g=_interopRequireDefault(y),S=r(1),C=_interopRequireDefault(S),P=t.SummaryModule=o.module("purchase.summary",["ui.router","ui.bootstrap",c.default.name,u.default.name,p.default.name,h.default.name,v.default.name,"offerQuantity","customError","formattedPrice",g.default.name,C.default.name]).controller("SummaryCtrl",i.SummaryCtrl).directive("summaryDeliveryBundle",a.SummaryDeliveryBundle.instance);t.default=P},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Check status at My orders":"Sprawdź status w zakładce Kupione","Payment data are out of date":"Dane płatności są nieaktualne","Payment has already started.":"Płatność została już rozpoczęta.","Please update your delivery and payment form.":"Wybierz ponownie metodę dostawy i sposób płatności, by zapłacić za ten zakup.","You can not edit anything in this purchase.":"Nie możesz nic edytować w tym zakupie.","You will purchase the items if you receive the loan":"Do zakupu przedmiotów dojdzie, tylko jeśli otrzymasz pożyczkę","choose delivery and payment":"wybierz dostawę i płatność","chosen payment method":"wybrana metoda płatności","chosen delivery method":"sposób dostawy","go back to delivery form":"wróć do opcji dostawy i płatności","go to application":"przejdź do wniosku","purchase and delivery methods":"Twoje zakupy i dostawa","shipping address data":"dane odbiorcy przesyłki","your address data":"Twoje dane"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function SummaryCtrl(e,t,r,n,o,i,a,s,c,l,u,d,p,f,h,m,v,y,g){"ngInject";this.PURCHASE_CONSTANTS=y,this.purchaseTradeDoublerSvc=g,this.isTradeDoublerEnabled=!1,this.$state=t,this.$log=r,this.$exceptionHandler=n,this.$window=o,this.$q=c,this.paymentsMethodsService=l,this.emailGuestVerificationSvc=u,this.storageSvc=p,this.modalSvc=s,this.userSvc=a,this.purchaseNgaSvc=d,this.guestRegistrationSvc=v,this.gettextCatalog=f,this.purchaseSummationSvc=h,this.purchaseCtrl=e.purchase,this.isBuying=!1,this.isCheckLimitExceeded=!1,this.purchaseId=i.getId(),this.backUrl=m.getBackToDapfUrl(this.purchaseId,this.$state),this.purchaseNgaSvc.sendPageView(y.NGA_STATE_TAG.SUMMARY,this.purchaseCtrl.processEntry,this.purchaseCtrl.isCartProcess,null,!this.purchaseCtrl.isGuest,this.purchaseCtrl.flags)}return SummaryCtrl.$inject=["$scope","$state","$log","$exceptionHandler","$window","PurchaseSvc","UserSvc","ModalSvc","$q","PaymentsMethodsService","EmailGuestVerificationSvc","PurchaseNgaSvc","StorageSvc","gettextCatalog","PurchaseSummationSvc","ConfigurationSvc","GuestRegistrationSvc","PURCHASE_CONSTANTS","purchaseTradeDoublerSvc"],SummaryCtrl.prototype.totalDeliveryCost=function(e){return this.purchaseSummationSvc.getTotalDeliveryCost(e)},SummaryCtrl.prototype.isInstallmentsSelected=function(){return this.paymentsMethodsService.isInstallmentsGroupSelected(this.purchaseCtrl.paymentsData)},SummaryCtrl.prototype.isInstallmentPayment=function(){return this.paymentsMethodsService.isMethodOfInstallmentGroup(this.storageSvc.paymentsData.payments.selectedMethod)},SummaryCtrl.prototype.setUpdated=function(e){this.isUpdated=e},SummaryCtrl.prototype.isPaymentDeferred=function(){return this.paymentsMethodsService.isMethodDeferred(this.storageSvc.paymentsData.payments.selectedMethod)},SummaryCtrl.prototype.isVerificationCodeSet=function(){return!this.purchaseCtrl.isGuest||this.emailGuestVerificationSvc.isVerificationCodeSet(this.purchaseCtrl.guestVerificationCode)},SummaryCtrl.prototype.buyDeferred=function(){var e=this;this.isPaymentDeferred()&&(this.purchaseCtrl.isGuest&&this.purchaseCtrl.guestVerificationCode?this.guestRegistrationSvc.sendGuestRegistrationRequest(this.purchaseCtrl.guestVerificationCode).finally(function(){e.buyImpl()}):this.buyImpl())},SummaryCtrl.prototype.buyImpl=function(){var e=this;this.isBuying=!0,this.purchaseCtrl.hasAccountAddress?this.enterPayment(this.purchaseCtrl.paymentId):this.userSvc.saveUserAddress(this.purchaseCtrl.buyerId,this.purchaseCtrl.activeAddress).then(function(){return e.enterPayment(e.purchaseCtrl.paymentId)},function(t){var r=e.modalSvc.prepareOptionsFromReason(t);e.modalSvc.showErrorReason(r),e.isBuying=!1})},SummaryCtrl.prototype.onBought=function(){var e=this;return function(t){var r;return e.$log.debug("Paying for purchase ",t),e.purchaseCtrl.isCartProcess?e.purchaseNgaSvc.publishPostBuyCart(t,e.purchaseCtrl.isGuest):e.purchaseNgaSvc.publishStartPayment(t),r=e.purchaseCtrl.isGuest&&e.purchaseCtrl.guestVerificationCode?e.guestRegistrationSvc.sendGuestRegistrationRequest(e.purchaseCtrl.guestVerificationCode):e.$q.when(),r.finally(function(){if(t&&t.payment&&t.payment.id)return e.enterPayment(t.payment.id);var r={title:e.gettextCatalog.getString("Payment data are out of date"),content:e.gettextCatalog.getString("Please update your delivery and payment form.")},n={confirm:e.gettextCatalog.getString("choose delivery and payment")};e.modalSvc.showMessageModal(r,n).closed.then(function(){e.storageSvc.clearPaymentsData(),e.$state.transitionTo("purchase.dapf",e.$state.params,{reload:"purchase",inherit:!0,notify:!0})})})}},SummaryCtrl.prototype.onBuyCommandError=function(e){this.purchaseNgaSvc.onSummaryBuyCommandError(),this.buyValidationError=e},SummaryCtrl.prototype.enableTradeDoubler=function(){this.purchaseCtrl.isPaymentInProgress||this.purchaseCtrl.data.status!==this.PURCHASE_CONSTANTS.PURCHASE_STATUS.DRAFT||(this.isTradeDoublerEnabled=!0,this.tradeDoublerData=this.purchaseTradeDoublerSvc.getTradeDoublerData(this.purchaseCtrl.data))},SummaryCtrl.prototype.enterPayment=function(e){var t=this;return this.paymentsMethodsService.createPayment(e,this.storageSvc.paymentsData.payments,this.purchaseId,this.purchaseCtrl.guestVerificationCode,this.purchaseCtrl.data.metadata).then(function(e){var r=e?e.redirectUrl:"";return t.$log.debug("Payment created and is redirected to: ",r),t.$window.location.href=r,e},function(e){t.isBuying=!1,t.$exceptionHandler(e),t.$window.location.href=t.$state.href("thankYou.error",t.$state.params,{absolute:!1})})},SummaryCtrl}();t.SummaryCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function SummaryDeliveryBundle(){this.restrict="E",this.scope={},this.controller=function(){},this.controllerAs="$ctrl",this.bindToController={service:"=",locale:"=",order:"=",showPaymentIcons:"=",backUrl:"=",isLast:"=",showBackUrl:"=",residenceAddress:"="},this.template=r(55)}return SummaryDeliveryBundle.instance=function(){return new SummaryDeliveryBundle},SummaryDeliveryBundle}();t.SummaryDeliveryBundle=n},function(e,t){e.exports='<div class="order">\n    <ul class="offers">\n        <li id="offer-id-{{::offer.id}}" class="offer" ng-repeat="offer in ::$ctrl.order.offers track by $index">\n            <div class="offer-name summary-label">\n                <span ng-bind="::offer.name"></span>\n                \x3c!-- TODO: is payu? --\x3e\n                <i ng-if="::$ctrl.showPaymentIcons" class="payu-icons payu-logo"></i>\n            </div>\n            <div class="offer-quantity didascalia">\n                <offer-quantity quantity="::offer.quantity" quantity-type="::offer.quantityType"></offer-quantity>\n            </div>\n            <div class="offer-total-price items-price price">\n                <formatted-price amount="::(offer.price.amount * offer.quantity)"\n                                 currency="::offer.price.currency"\n                                 target-currency="::$ctrl.locale.currency"\n                                 conversion-rates="::$ctrl.service.currencyConversionRates"\n                ></formatted-price>\n            </div>\n            <div class="offer-additional-services" ng-if="::(offer.additionalServices && offer.additionalServices.length > 0)">\n                <additional-services read-only="::true" offer="::offer"></additional-services>\n            </div>\n        </li>\n    </ul>\n    <div class="selected-delivery-method">\n        <delivery-methods-select\n            order="::$ctrl.order"\n            locale="::$ctrl.locale"\n            service="::$ctrl.service"\n            summary-mode="true"\n            summary-show-back-url="::$ctrl.showBackUrl"\n            summary-back-url="::$ctrl.backUrl"\n        ></delivery-methods-select>\n    </div>\n\n    <div class="message-to-seller" ng-if="::$ctrl.order.messageToSeller.length">\n        <p ng-bind="::$ctrl.order.messageToSeller"></p>\n    </div>\n\n    <pharmacy ng-if="::$ctrl.order.seller.pharmacy.available"\n              order-id="::$ctrl.order.id"\n              pharmacy-address="::$ctrl.order.seller.pharmacy.address"\n              buyer-address="::$ctrl.residenceAddress"></pharmacy>\n</div>\n<hr class="separator separator-top" ng-if="::!$ctrl.isLast" />\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function AnalyticsCfgSvc(e,t){"ngInject";this.config={PL:{gtm:{active:!0,account:"GTM-FXVJ",taxRate:23},nga:{active:!0,account:"CM.991213.tz_pl",domain:".allegro.pl",environment:null,defaultEventParams:{category:"PurchasingProcess"}},dfp:{active:!0,tagId:"thank-you-doubleclick",unitPath:"/21612525419/Allegro.pl/thankyoupage/postbuy",sizes:[[1,1],[750,200],[750,100],[750,300]],targeting:[],sizeMapping:[{viewport:[0,0],sizes:[]},{viewport:[1024,600],sizes:[[1,1],[750,200],[750,100],[750,300]]}]}}},this.$q=e,this.configurationSvc=t}return AnalyticsCfgSvc.$inject=["$q","ConfigurationSvc"],AnalyticsCfgSvc.prototype.getConfig=function(){var e=this.config[this.configurationSvc.getLocale().country];return e.gtm.active=e.gtm.active&&this.configurationSvc.isProduction(),e.nga.environment=this.configurationSvc.getEnvironment(),this.$q.when(e)},AnalyticsCfgSvc}();t.AnalyticsCfgSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PurchaseGtmSvc(e,t,r){"ngInject";this.taxRate=0,this.gtmSvc=e,this.purchaseSummationSvc=t,this.purchaseConstants=r}return PurchaseGtmSvc.$inject=["GtmSvc","PurchaseSummationSvc","PURCHASE_CONSTANTS"],PurchaseGtmSvc.prototype.initialize=function(e){e&&e.taxRate&&(this.taxRate=e.taxRate),this.gtmSvc.initialize(e)},PurchaseGtmSvc.prototype.publishThankYouEntry=function(e){var t,r=this.getThankYouProducts(e),n=this.purchaseSummationSvc.getTotalsByStatus(e.orders);t=n[this.purchaseConstants.PURCHASE_STATUS.BOUGHT]?n[this.purchaseConstants.PURCHASE_STATUS.BOUGHT]:{amount:0,offersCount:0,shippingCost:0};var o=e.orders.map(function(e){return e.seller.id});this.publish({pageType:"conversion",transactionId:e.id,transactionProductQuantity:t.offersCount,transactionTotal:t.amount.toFixed(2),transactionShipping:t.shippingCost.toFixed(2),transactionTax:this.calculateTax(t.amount),transactionCurrency:e.service.currency,transactionProducts:r,transactionSellerIds:o,transactionPaymentMethod:null})},PurchaseGtmSvc.prototype.publish=function(e){e.event="purchaseDataReady",this.gtmSvc.publish(e)},PurchaseGtmSvc.prototype.getThankYouProducts=function(e){var t=this;return e.orders.map(function(e){return e.offers.filter(function(e){return e.status===t.purchaseConstants.PURCHASE_STATUS.BOUGHT}).map(function(t){return{sku:t.id,name:t.name,categoryId:t.category.id,category:t.category,price:t.price.amount,currency:t.price.currency,quantity:t.quantity,sellerId:e.seller.id,orderOfferId:t.orderOfferId,total:parseFloat(t.price.amount)*t.quantity}})}).flatMap(function(e){return e})},PurchaseGtmSvc.prototype.calculateTax=function(e){return(e*this.taxRate/100).toFixed(2)},PurchaseGtmSvc}();t.PurchaseGtmSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PurchaseNgaSvc(e,t){"ngInject";this.ngaSvc=e,this.constants=t}return PurchaseNgaSvc.$inject=["NgaSvc","PURCHASE_CONSTANTS"],PurchaseNgaSvc.prototype.initialize=function(e){this.ngaSvc.initialize(e)},PurchaseNgaSvc.prototype.publishPostBuyNow=function(e,t){var r=PurchaseNgaSvc.getItemsList(e)[0];this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.POST_BUY_NOW_ACTION,null,null,{oid:e.id,source:"preBuyNow",offerId:r.offerId,price:r.price,quantity:r.quantity,isFastForward:!t})},PurchaseNgaSvc.prototype.publishStartPayment=function(e){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.START_PAYMENT_ACTION,PurchaseNgaSvc.BUY_NOW_LABEL,null,{oid:e.id,label:PurchaseNgaSvc.BUY_NOW_LABEL})},PurchaseNgaSvc.prototype.publishPostBuyCart=function(e,t){var r=t?PurchaseNgaSvc.FILL_DATA_LABEL:null;this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.POST_BUY_CART_ACTION,r,null,{itemsList:PurchaseNgaSvc.getItemsList(e),transactions:e.orders.length,oid:e.id,userType:t?this.constants.USER_FLOW.GUEST:this.constants.USER_FLOW.USER,cartId:e.cart?e.cart.id:null,source:"summary"})},PurchaseNgaSvc.prototype.publishRelatedResult=function(e,t){var r=this.excludeMatchingOrders(t,e);this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.RELATED_ORDERS_RESULT_ACTION,null,null,{selectedOffers:this.getOffersIds(e),selectedOrders:this.getOrdersIds(e),notSelectedOffers:this.getOffersIds(r),notSelectedOrders:this.getOrdersIds(r)})},PurchaseNgaSvc.prototype.publishRelatedOrderRemoval=function(e){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.RELATED_ORDER_REMOVED_ACTION,null,null,{orderId:e.id,offerIds:this.getOffersIds([e])})},PurchaseNgaSvc.prototype.publishLeaseLinkClick=function(e,t,r){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.LEASE_LINK_CLICK_ACTION,PurchaseNgaSvc.LEASE_LINK_CLICK_LABEL,null,{offers:[{offerId:e,offerQuantity:t,offerPrice:r}]})},PurchaseNgaSvc.prototype.publishGuestVerificationCodeResend=function(){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.SEND_VERIFICATION_CODE_ACTION,this.constants.USER_FLOW.GUEST,null,{})},PurchaseNgaSvc.prototype.publishDeliveryOptionsClicked=function(){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.SHOW_DELIVERY_METHOD_ACTION,PurchaseNgaSvc.USER_LABEL)},PurchaseNgaSvc.prototype.publishGoToFreeDeliveryTerms=function(){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.GO_TO_FREE_DELIVERY_TERMS,PurchaseNgaSvc.DELIVERY_FORM_LABEL,null,{})},PurchaseNgaSvc.prototype.confirmBuyModalOnOpen=function(){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.CONFIRM_MODAL_ON_OPEN)},PurchaseNgaSvc.prototype.errorModalOnOpen=function(){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.ERROR_MODAL_ON_OPEN)},PurchaseNgaSvc.prototype.onBuyNowBuyCommandError=function(){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.ON_BUY_COMMAND_ERROR,PurchaseNgaSvc.BUY_NOW_LABEL)},PurchaseNgaSvc.prototype.onSummaryBuyCommandError=function(){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.ON_BUY_COMMAND_ERROR,PurchaseNgaSvc.SUMMARY_LABEL)},PurchaseNgaSvc.prototype.onDropOffAvailable=function(e){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.DROP_OFF_ACTION,PurchaseNgaSvc.DROP_OFF_AVAILABLE+e)},PurchaseNgaSvc.prototype.onDropOffRequested=function(e){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.DROP_OFF_ACTION,PurchaseNgaSvc.DROP_OFF_REQUESTED+e)},PurchaseNgaSvc.prototype.onDropOffMapShown=function(e){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.DROP_OFF_ACTION,PurchaseNgaSvc.DROP_OFF_MAP_SHOW+e)},PurchaseNgaSvc.prototype.onDropOffNoPoints=function(e){this.ngaSvc.sendEvent(PurchaseNgaSvc.CATEGORY,PurchaseNgaSvc.DROP_OFF_ACTION,PurchaseNgaSvc.DROP_OFF_NO_POINTS+e)},PurchaseNgaSvc.prototype.sendPageView=function(e,t,r,n,o,i){void 0===e&&(e=null),void 0===t&&(t=null),void 0===r&&(r=null),void 0===n&&(n=null),void 0===o&&(o=!0),void 0===i&&(i=[]),this.ngaSvc.sendPageView({tag:"PurchasingProcess_"+e,transaction:{entry:t,isCartProcess:r,isUser:o,referrer:this.validateReferrerParameter(n),purchaseFlags:i}})},PurchaseNgaSvc.getItemsList=function(e){return e.orders.flatMap(function(e){return e.offers}).map(function(e){return{offerId:e.id,price:e.price.amount,quantity:e.quantity}})},PurchaseNgaSvc.prototype.excludeMatchingOrders=function(e,t){var r={};return t.forEach(function(e){return r[e.id]=!0}),e.filter(function(e){return!r[e.id]})},PurchaseNgaSvc.prototype.getOffersIds=function(e){return e.flatMap(function(e){return e.offers}).map(function(e){return e.id})},PurchaseNgaSvc.prototype.getOrdersIds=function(e){return e.map(function(e){return e.id})},PurchaseNgaSvc.prototype.validateReferrerParameter=function(e){return-1!=this.constants.NGA_VALID_REFERRERS.indexOf(e)?e:null},PurchaseNgaSvc.CATEGORY="PurchasingProcess",PurchaseNgaSvc.POST_BUY_NOW_ACTION="PostBuyNow",PurchaseNgaSvc.START_PAYMENT_ACTION="StartPayment",PurchaseNgaSvc.POST_BUY_CART_ACTION="PostBuyCart",PurchaseNgaSvc.RELATED_ORDERS_RESULT_ACTION="RelatedOrdersResult",PurchaseNgaSvc.RELATED_ORDER_REMOVED_ACTION="RelatedOrderRemoved",PurchaseNgaSvc.BUY_NOW_LABEL="BuyNow",PurchaseNgaSvc.SUMMARY_LABEL="Summary",PurchaseNgaSvc.FILL_DATA_LABEL="FillData",PurchaseNgaSvc.SEND_VERIFICATION_CODE_ACTION="SendVerifyCode",PurchaseNgaSvc.CONFIRM_MODAL_ON_OPEN="ConfirmBuyModal.OnOpen",PurchaseNgaSvc.ERROR_MODAL_ON_OPEN="ErrorModal.OnOpen",PurchaseNgaSvc.ON_BUY_COMMAND_ERROR="OnBuyCommandError",PurchaseNgaSvc.LEASE_LINK_CLICK_ACTION="GoToOffer",PurchaseNgaSvc.LEASE_LINK_CLICK_LABEL="Leasing",PurchaseNgaSvc.SHOW_DELIVERY_METHOD_ACTION="ShowDeliveryMethod",PurchaseNgaSvc.USER_LABEL="user",PurchaseNgaSvc.GO_TO_FREE_DELIVERY_TERMS="GoToFreeDeliveryTerms",PurchaseNgaSvc.DELIVERY_FORM_LABEL="fod",PurchaseNgaSvc.DROP_OFF_ACTION="DropOffAction",PurchaseNgaSvc.DROP_OFF_AVAILABLE="DropOffAvailable_",PurchaseNgaSvc.DROP_OFF_REQUESTED="DropOffRequested_",PurchaseNgaSvc.DROP_OFF_MAP_SHOW="DropOffMapShown_",PurchaseNgaSvc.DROP_OFF_NO_POINTS="DropOffNoPoints_",PurchaseNgaSvc}();t.PurchaseNgaSvc=n},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"This price is an approximation based on currency exchange rate. You will pay exactly {{totalAmount}}.":"Podana cena jest przybliżoną wartością wynikającą z aktualnego kursu wymiany walut. Zapłacisz dokładnie {{totalAmount}}.","including offers to pay in advance":"w tym płatne z góry",total:"razem"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PurchaseSummationComponent(){this.bindings={purchaseService:"<",orders:"<",paymentId:"<?",summaryMode:"<?",payments:"<?"},this.controller="PurchaseSummationCtrl",this.template=r(61)}return PurchaseSummationComponent}();t.PurchaseSummationComponent=n},function(e,t){e.exports='<installments-summary-info\n        payments="$ctrl.payments"\n        total-cost="$ctrl.purchaseCost.total">\n</installments-summary-info>\n<div class="total-cost" ng-class="{\'original-price\': $ctrl.payments.selectedDiscounts.length}">\n    <span id="summation-total" class="total">\n        <translate ng-if="!$ctrl.payments.selectedDiscounts.length">total</translate>\n        <strong>\n            <formatted-price amount="$ctrl.purchaseCost.total"\n                             currency="$ctrl.purchaseCost.currency"\n                             target-currency="::$ctrl.locale.currency"\n                             conversion-rates="::$ctrl.purchaseService.currencyConversionRates"\n            ></formatted-price>\n        </strong>\n    </span>\n</div>\n\n<div class="didascalia"\n     ng-if="$ctrl.isConversionInfoVisible"\n     translate\n     translate-params-total-amount="$ctrl.purchaseCost.total | formattedPrice : $ctrl.purchaseCost.currency">\n    This price is an approximation based on currency exchange rate. You will pay exactly {{totalAmount}}.\n</div>\n\n<div class="total-cost discounted-color" ng-if="$ctrl.payments.selectedDiscounts.length">\n    <span class="total">\n        <translate>total</translate>\n        <strong>\n            <discounted-price amount="$ctrl.purchaseCost.total"\n                              discount-amount="$ctrl.payments.selectedDiscounts[0].value.amount"\n                              discount-currency="$ctrl.payments.selectedDiscounts[0].value.currency"\n            ></discounted-price>\n        </strong>\n    </span>\n</div>\n\n<div class="prepaid-cost" ng-if="!$ctrl.payments.selectedDiscounts.length">\n    <span id="summation-prepaid" class="prepaid didascalia">\n        <translate>including offers to pay in advance</translate>\n        <strong>\n            <formatted-price amount="$ctrl.purchaseCost.prepaid"\n                             currency="$ctrl.purchaseCost.currency"\n                             target-currency="::$ctrl.locale.currency"\n                             conversion-rates="::$ctrl.purchaseService.currencyConversionRates"\n            ></formatted-price>\n        </strong>\n    </span>\n</div>\n<div class="prepaid-cost" ng-if="$ctrl.payments.selectedDiscounts.length">\n    <span class="prepaid didascalia">\n        <translate>including offers to pay in advance</translate>\n        <strong>\n            <discounted-price amount="$ctrl.purchaseCost.prepaid"\n                              discount-amount="$ctrl.payments.selectedDiscounts[0].value.amount"\n                              discount-currency="$ctrl.payments.selectedDiscounts[0].value.currency"\n            ></discounted-price>\n        </strong>\n    </span>\n</div>\n\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PurchaseSummationCtrl(e,t,r,n){"ngInject";this.$scope=e,this.PurchaseSummationSvc=t,this.ConfigurationSvc=r,this.PriceConverterSvc=n,this.isConversionInfoVisible=null,this.purchaseCost={currency:null,total:null,prepaid:null},this.locale=r.getLocale()}return PurchaseSummationCtrl.$inject=["$scope","PurchaseSummationSvc","ConfigurationSvc","PriceConverterSvc"],PurchaseSummationCtrl.prototype.$onInit=function(){var e=this;this.purchaseCost.currency=this.orders[0].offers[0].price.currency||this.purchaseService.currency,this.orders.forEach(function(t){e.$scope.$watch(function(){return t.delivery},function(){e.setTotals()},!0),t.offers.forEach(function(t){e.$scope.$watch(function(){return t.additionalServices},function(){e.setTotals()},!0)})})},PurchaseSummationCtrl.prototype.shouldShowConversionInfo=function(){return!(!this.purchaseService.currencyConversionRates||!this.PriceConverterSvc.isConversionRequired(this.purchaseCost.currency,this.locale.currency))},PurchaseSummationCtrl.prototype.setTotals=function(){this.purchaseCost.total=this.PurchaseSummationSvc.getTotalCost(this.orders),this.purchaseCost.prepaid=this.PurchaseSummationSvc.getPrepaidCost(this.orders),this.isConversionInfoVisible=this.shouldShowConversionInfo()},PurchaseSummationCtrl}();t.PurchaseSummationCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PurchaseSummationSvc(e,t){"ngInject";this.purchaseConstants=e,this.purchaseSvc=t}return PurchaseSummationSvc.$inject=["PURCHASE_CONSTANTS","PurchaseSvc"],PurchaseSummationSvc.prototype.getPrepaidCost=function(e){var t=this,r=e.reduce(function(e,r){return PurchaseSummationSvc.isDeliveryAmountInOrder(r)&&t.purchaseSvc.isPrepaidMethodInOrder(r)?e+parseFloat(r.delivery.cost.amount):e},0);return e.map(function(e){return t.purchaseSvc.isPrepaidMethodInOrder(e)?e.offers.reduce(function(e,t){return e+parseFloat(t.price.amount)*t.quantity},0+t.getTotalAdditionalServicesCost(e)):0}).reduce(function(e,t){return e+t},0)+r},PurchaseSummationSvc.prototype.getTotalDeliveryCost=function(e){return e.reduce(function(e,t){return PurchaseSummationSvc.isDeliveryAmountInOrder(t)?e+parseFloat(t.delivery.cost.amount):e},0)},PurchaseSummationSvc.prototype.getTotalCost=function(e){var t=this,r=this.getTotalDeliveryCost(e);return e.map(function(e){return e.offers.reduce(function(e,t){return e+parseFloat(t.price.amount)*t.quantity},0)}).reduce(function(e,t){return e+t},0)+e.map(function(e){return t.getTotalAdditionalServicesCost(e)}).reduce(function(e,t){return e+t},0)+r},PurchaseSummationSvc.prototype.getTotalsByStatus=function(e){return e.reduce(function(e,t){return PurchaseSummationSvc.ensureStatusInTotals(e,t.status),PurchaseSummationSvc.isDeliveryAmountInOrder(t)&&(e[t.status].shippingCost+=parseFloat(t.delivery.cost.amount)),t.offers.reduce(function(e,t){return PurchaseSummationSvc.ensureStatusInTotals(e,t.status),e[t.status].amount+=t.quantity*parseFloat(t.price.amount),e[t.status].offersCount+=t.quantity,e},e)},{})},PurchaseSummationSvc.prototype.getTotalMyOrdersOffersCost=function(e){return e.reduce(function(e,t){return e.concat(t.offers)},[]).map(function(e){return e.quantity*parseFloat(e.unitPrice.amount)}).reduce(function(e,t){return e+t},0)},PurchaseSummationSvc.prototype.getOffersCount=function(e){return e.map(function(e){return e.offers.length}).reduce(function(e,t){return e+t},0)},PurchaseSummationSvc.prototype.getSellersCount=function(e){return e.map(function(e){return e.seller.id}).filter(function(e,t,r){return t===r.lastIndexOf(e)}).length},PurchaseSummationSvc.prototype.getSellersCountWithBoughtStatus=function(e){var t=this;return this.getSellersCount(e.filter(function(e){return e.status===t.purchaseConstants.PURCHASE_STATUS.BOUGHT||e.status===t.purchaseConstants.PURCHASE_STATUS.PARTIALLY_BOUGHT}))},PurchaseSummationSvc.prototype.getTotalAdditionalServicesCost=function(e){return e.offers.map(function(e){return(e.additionalServices||[]).reduce(function(t,r){return t+parseFloat(r.unitPrice.amount)*e.quantity},0)}).reduce(function(e,t){return e+t},0)},PurchaseSummationSvc.isDeliveryAmountInOrder=function(e){return!!(e.delivery&&e.delivery.cost&&e.delivery.cost.amount)},PurchaseSummationSvc.ensureStatusInTotals=function(e,t){e[t]||(e[t]={amount:0,offersCount:0,shippingCost:0})},PurchaseSummationSvc}();t.PurchaseSummationSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(65),a=r(66),s=o.module("purchase.discountedPrice",[]).component("discountedPrice",new a.DiscountedPrice).controller("DiscountedPriceCtrl",i.DiscountedPriceCtrl);t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DiscountedPriceCtrl(){}return DiscountedPriceCtrl.prototype.$onChanges=function(){var e=this.amount,t=this.discountAmount;this.discountedPrice=e-t},DiscountedPriceCtrl}();t.DiscountedPriceCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DiscountedPrice(){this.bindings={amount:"<",discountAmount:"<",discountCurrency:"<"},this.controller="DiscountedPriceCtrl",this.template=r(67)}return DiscountedPrice}();t.DiscountedPrice=n},function(e,t){e.exports="<span>{{ $ctrl.discountedPrice | currency }}</span>"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PurchaseDfpSvc(e,t){"ngInject";this.purchaseSummationSvc=e,this.purchaseConstants=t}return PurchaseDfpSvc.$inject=["PurchaseSummationSvc","PURCHASE_CONSTANTS"],PurchaseDfpSvc.prototype.getDfpTargeting=function(e){return[{name:"offerIds",value:this.getOfferIds(e)},{name:"totalAmount",value:this.getBoughtTotalAmount(e)}]},PurchaseDfpSvc.prototype.getBoughtTotalAmount=function(e){var t=this.purchaseSummationSvc.getTotalsByStatus(e.orders),r=this.purchaseConstants.PURCHASE_STATUS.BOUGHT;return t&&t[r]?Math.round(t[r].amount):0},PurchaseDfpSvc.prototype.getOfferIds=function(e){var t=this;return e.orders.flatMap(function(e){return e.offers}).filter(function(e){return e.status===t.purchaseConstants.PURCHASE_STATUS.BOUGHT}).map(function(e){return"offerId="+e.id+";"}).join("")},PurchaseDfpSvc}();t.PurchaseDfpSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function AffiliateProgramComponent(){this.template=r(70),this.controller="AffiliateProgramCtrl"}return AffiliateProgramComponent}();t.AffiliateProgramComponent=n},function(e,t){e.exports='<iframe id="awin-sandbox" src="https://seo.allegrostatic.pl/scripts/awin/awin-mastertag.html" height="0" border="0"\n        sandbox="allow-scripts allow-same-origin" style="visibility:hidden;position: absolute;" iframe-onload="$ctrl.sendData(contentWindow)">\n</iframe>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function AffiliateProgramController(){}return AffiliateProgramController.prototype.sendData=function(e){e&&e.postMessage&&e.postMessage({},"*")},AffiliateProgramController}();t.AffiliateProgramController=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function IframeOnloadDirective(){this.restrict="A",this.scope={iframeOnload:"&"}}return IframeOnloadDirective.prototype.link=function(e,t,r){t.one("load",function(r){var n=t.length>0&&t[0].contentWindow?t[0].contentWindow:void 0;e.iframeOnload({contentWindow:n})})},IframeOnloadDirective}();t.IframeOnloadDirective=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PurchaseTradeDoublerSvc(e){"ngInject";this.$cookies=e}return PurchaseTradeDoublerSvc.$inject=["$cookies"],PurchaseTradeDoublerSvc.prototype.getTradeDoublerData=function(e){return{uid:this.$cookies.get(PurchaseTradeDoublerSvc.TRADE_DOUBLER_UID_COOKIE_ID),organizationId:PurchaseTradeDoublerSvc.ORGANIZATION_ID,purchaseId:e.id,currency:e.orders[0].offers[0].price.currency,products:e.orders.flatMap(function(e){return e.offers}).map(function(e){return{id:e.id,name:e.name,unitPrice:parseFloat(e.price.amount),quantity:e.quantity}})}},PurchaseTradeDoublerSvc.TRADE_DOUBLER_UID_COOKIE_ID="TRADEDOUBLER",PurchaseTradeDoublerSvc.ORGANIZATION_ID=2150697,PurchaseTradeDoublerSvc}();t.PurchaseTradeDoublerSvc=n},function(e,t,r){"use strict";function provideHttpsImageFilter(){return function(e){return e.replace("http://","https://").replace("allegroimg.pl","allegroimg.com")}}Object.defineProperty(t,"__esModule",{value:!0}),t.provideHttpsImageFilter=provideHttpsImageFilter},function(e,t,r){"use strict";function provideUrlFilter(e){"ngInject";return function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e.getUrls()[t];return r&&Array.isArray(r)&&r.forEach(function(e,t){o=o.replace("%"+(t+1),e)}),o}}Object.defineProperty(t,"__esModule",{value:!0}),t.provideUrlFilter=provideUrlFilter,provideUrlFilter.$inject=["ConfigurationSvc"]},function(e,t,r){"use strict";function provideRedirectTo(e){"ngInject";return function(t){return e.location.href="//"+e.location.host+(t[0]&&"/"==t[0]?"":"/")+t}}Object.defineProperty(t,"__esModule",{value:!0}),t.provideRedirectTo=provideRedirectTo,provideRedirectTo.$inject=["$window"]},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Are you sure you want to buy it again?":"Czy na pewno chcesz dokonać zakupu ponownie?","Please refer to Bought Items list in My Account section to finish your payment.":"Opłać kupione przedmioty, korzystając z zakładki Moje Allegro > Kupione.","Unable to buy offer":["Nie udało się kupić przedmiotu","Nie udało się kupić przedmiotów","Nie udało się kupić przedmiotów"],"Unable to buy some offers":"Nie udało się kupić niektórych przedmiotów","You already bought this offer":"Zauważyliśmy, że kupiłeś już przedmiot w tej ofercie","back to cart":"wróć do koszyka","back to offer page":"wróć do strony oferty","buy and pay":"kupuję i płacę","buying in progress":"trwa kupowanie","check status":"sprawdź status","checking status":"sprawdzanie statusu","confirm buy now again":"ponowny zakup przedmiotu","go to bought items":"przejdź do listy kupionych","no, back to my orders":"nie, przejdź do Moich zakupów",pay:"płacę","pressing button buys item":"Klikając przycisk, potwierdzasz zakup","yes, I confirm buy now":"tak, potwierdzam zakup"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BuyButtonCtrl=void 0;var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=function(){function BuyButtonCtrl(e,t,r,n,o,i,a,s,c,l,u,d){"ngInject";this.purchaseSvc=e,this.userSvc=t,this.purchaseConstants=r,this.confirmBuySvc=n,this.CustomException=o,this.buyFailedSvc=i,this.$q=a,this.$log=s,this.$exceptionHandler=c,this.$uibModal=l,this.modalSvc=u,this.purchaseNgaSvc=d}return BuyButtonCtrl.$inject=["PurchaseSvc","UserSvc","PURCHASE_CONSTANTS","confirmBuySvc","CustomException","BuyFailedSvc","$q","$log","$exceptionHandler","$uibModal","ModalSvc","PurchaseNgaSvc"],BuyButtonCtrl.prototype.$onInit=function(){this.isCartProcess=this.purchase.isCartProcess,this.isBuying=!1,this.isCheckLimitExceeded=!1,this.isBought=this.purchase.data.status===this.purchaseConstants.PURCHASE_STATUS.BOUGHT},BuyButtonCtrl.prototype.processSummaryConfirmation=function(){var e=this;this.shouldShowBuyConfirmationModal()?this.showConfirmBuyModal().then(function(){return e.processConfirmation()}).catch(function(){return e.$log.debug("Buy not confirmed")}):this.processConfirmation()},BuyButtonCtrl.prototype.checkStatus=function(){this.isBuying=!0,this.checkPurchaseStatusInIntervals()},BuyButtonCtrl.prototype.shouldShowBuyConfirmationModal=function(){var e=this.purchase.data.orders[0].offers[0].id,t=this.purchase.buyerId,r=this.confirmBuySvc.isOfferAlreadyBought(e,t);return!this.isCartProcess&&!this.isBought&&r},BuyButtonCtrl.prototype.processConfirmation=function(){this.isBuying=!0,this.isBought?this.onBought():this.purchase.hasAccountAddress?this.buy():this.saveUserAddressAndBuy(this.purchase.buyerId,this.purchase.activeAddress)},BuyButtonCtrl.prototype.buy=function(){var e=this;this.purchaseSvc.buyPurchase(this.purchaseSvc.getId(),this.isCartProcess,this.purchase.guestVerificationCode).then(function(){e.checkPurchaseStatusInIntervals(),e.$log.debug("buying")},function(t){e.isBuying=!1,o.isFunction(e.onBuyCommandError)&&t&&t.data&&Array.isArray(t.data.errors)&&e.onBuyCommandError({error:t.data.errors[0]})})},BuyButtonCtrl.prototype.checkPurchaseStatusInIntervals=function(){var e=this;this.purchaseSvc.checkPurchaseStatusInIntervals(this.purchaseSvc.getId(),this.purchaseConstants.CHECK_STATUS_INTERVALS.slice(0)).then(function(t){switch(e.purchase.data.status=t.status,t.status){case e.purchaseConstants.PURCHASE_STATUS.DRAFT:e.onDraft();break;case e.purchaseConstants.PURCHASE_STATUS.BUYING:e.onBuying();break;case e.purchaseConstants.PURCHASE_STATUS.BOUGHT:e.onBought();break;case e.purchaseConstants.PURCHASE_STATUS.BUY_FAILED:e.onBuyFailed();break;case e.purchaseConstants.PURCHASE_STATUS.PARTIALLY_BOUGHT:e.onPartiallyBought();break;default:var r=new e.CustomException({name:"BuyButtonCtrlException",message:"Unknown purchase status"});return e.$q.reject(r)}},function(){return e.isBuying=!1}).catch(function(t){e.isBuying=!1,e.$exceptionHandler(t)})},BuyButtonCtrl.prototype.saveUserAddressAndBuy=function(e,t){var r=this;this.userSvc.saveUserAddress(e,t).then(function(){return r.buy()},function(e){var t=r.modalSvc.prepareOptionsFromReason(e);r.modalSvc.showErrorReason(t),r.isBuying=!1})},BuyButtonCtrl.prototype.onDraft=function(){this.$log.debug("draft"),this.isBuying=!1,this.isCheckLimitExceeded=!1},BuyButtonCtrl.prototype.onBuying=function(){this.$log.debug("buying"),this.isCheckLimitExceeded=!0},BuyButtonCtrl.prototype.onBought=function(){var e=this,t=this.onSuccess();this.$log.debug("bought"),this.isCartProcess||this.confirmBuySvc.saveOffersToConfirm(this.purchase.data.orders[0].offers[0].id,this.purchase.buyerId),o.isFunction(t)&&this.getPurchase().then(function(r){t(r).catch(function(){return e.isBuying=!1})}).catch(function(t){e.$log.debug(t)})},BuyButtonCtrl.prototype.onPartiallyBought=function(){var e=this;this.$log.debug("partially bought"),this.isBuying=!1,this.getPurchase().then(function(t){e.showPartiallyBoughtModal(t)})},BuyButtonCtrl.prototype.onBuyFailed=function(){var e=this;this.$log.debug("buy failed"),this.isBuying=!1,this.getPurchase().then(function(t){e.showBuyErrorModal(t)})},BuyButtonCtrl.prototype.getPurchase=function(){var e=this;return this.purchaseSvc.getPurchase(this.purchaseSvc.getId()).catch(function(){return e.isBuying=!1,e.$q.reject()})},BuyButtonCtrl.prototype.showPartiallyBoughtModal=function(e){var t=this;this.$uibModal.open({template:r(79),controller:"PartiallyBoughtModalCtrl",controllerAs:"partiallyBoughtModal",bindToController:!0,windowClass:"info-modal",backdrop:"static",keyboard:!1,resolve:{failedOffers:function(){return t.buyFailedSvc.getFailedOffers(e)}}})},BuyButtonCtrl.prototype.showBuyErrorModal=function(e){var t=this;this.$uibModal.open({template:r(80),controller:"BuyErrorModalCtrl",controllerAs:"buyErrorModal",bindToController:!0,windowClass:"info-modal",backdrop:"static",keyboard:!1,resolve:{purchase:function(){return e},isCartProcess:function(){return t.purchase.isCartProcess}}})},BuyButtonCtrl.prototype.showConfirmBuyModal=function(){var e=this,t=this.$uibModal.open({template:r(81),controller:"confirmBuyModalCtrl",controllerAs:"$ctrl",bindToController:!0,windowClass:"info-modal",backdrop:"static",keyboard:!1,resolve:{orders:function(){return e.purchase.data.orders}}});return t.opened.finally(function(){return e.purchaseNgaSvc.confirmBuyModalOnOpen()}),t.result},BuyButtonCtrl}();t.BuyButtonCtrl=i},function(e,t){e.exports='<div class="modal-header">\n    <h3 class="modal-title" translate>Unable to buy some offers</h3>\n</div>\n<div class="partially-bought modal-body">\n\n    <section class="seller-items no-quantity">\n        <ul class="table items-list">\n            <li ng-repeat="offer in partiallyBoughtModal.offers" class="item table-row">\n                <div class="table-cell item-photo">\n                    <a ng-href="{{ offer.viewUrl }}" target="_self" ng-class="{\'no-photo\' : !offer.image.url }">\n                        <img ng-if="offer.image.url" ng-src="{{ offer.image.url | httpsImage }}" title="{{ offer.image.title }}" alt="{{ offer.image.title }}"/>\n                    </a>\n                </div>\n                <div class="table-cell item-title">\n                    <div class="item-name">\n                        <a ng-href="{{ offer.viewUrl }}">{{ offer.name }}</a>\n                    </div>\n                </div>\n            </li>\n        </ul>\n    </section>\n\n    <translate>Please refer to Bought Items list in My Account section to finish your payment.</translate>\n    \n</div>\n<div class="modal-footer">\n    <button type="button" class="btn btn-primary" translate ng-click="partiallyBoughtModal.redirectTo((\'bought\' | url))">go to bought items</button>\n</div>'},function(e,t){e.exports='<div class="modal-header">\n    <h3 class="modal-title" translate translate-n="buyErrorModal.failedOffersCount" translate-plural="Unable to buy offers">Unable to buy offer</h3>\n</div>\n<div class="partially-bought modal-body">\n    <buy-error-list failed-offers="buyErrorModal.failedOffers" validation-id="buyErrorModal.validationId"></buy-error-list>\n</div>\n<div class="modal-footer">\n    <button type="button"\n            class="btn btn-primary"\n            translate\n            ng-if="buyErrorModal.isCartProcess"\n            ng-click="buyErrorModal.redirectTo((\'cart\' | url))">\n        back to cart\n    </button>\n    <button type="button"\n            class="btn btn-primary"\n            translate\n            ng-if="!buyErrorModal.isCartProcess"\n            ng-click="buyErrorModal.redirectTo((\'offer\' | url:buyErrorModal.preBuyNowOfferId))">\n        back to offer page\n    </button>\n</div>'},function(e,t){e.exports='<div class="modal-header">\n    <h3 class="modal-title" translate>confirm buy now again</h3>\n</div>\n<div class="partially-bought modal-body">\n    <p><translate>You already bought this offer</translate>:</p>\n\n    <section class="already-bought-offers">\n        <offer class="item table-row"\n               ng-repeat="offer in $ctrl.offers"\n               offer="offer"\n               show-quantity="false"\n               show-price="false"></offer>\n\n    </section>\n\n    <p><strong translate>Are you sure you want to buy it again?</strong></p>\n</div>\n<div class="modal-footer">\n    <a nga-action="ConfirmBuyModal.OnDismiss" class="btn btn-link" ng-href="/dashboard/myorders/#/" target="_self" translate>no, back to my orders</a>\n    <button type="button"\n            nga-action="ConfirmBuyModal.OnConfirm"\n            class="btn btn-primary"\n            translate\n            ng-click="$ctrl.confirm()">\n        yes, I confirm buy now\n    </button>\n</div>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function BuyErrorModalCtrl(e,t,r,n){"ngInject";this.validationId=e.validationResult.id,this.failedOffers=t.getFailedOffers(e),this.failedOffersCount=this.failedOffers.length,this.redirectTo=r,this.isCartProcess=n,this.preBuyNowOfferId=e.orders[0].offers[0].id}return BuyErrorModalCtrl.$inject=["purchase","BuyFailedSvc","redirectTo","isCartProcess"],BuyErrorModalCtrl}();t.BuyErrorModalCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ConfirmBuyModalCtrl(e,t){"ngInject";this.orders=e,this.$uibModalInstance=t,this.offers=e[0].offers}return ConfirmBuyModalCtrl.$inject=["orders","$uibModalInstance"],ConfirmBuyModalCtrl.prototype.confirm=function(){this.$uibModalInstance.close()},ConfirmBuyModalCtrl}();t.ConfirmBuyModalCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PartiallyBoughtModalCtrl(e,t){"ngInject";this.offers=e,this.redirectTo=t}return PartiallyBoughtModalCtrl.$inject=["failedOffers","redirectTo"],PartiallyBoughtModalCtrl}();t.PartiallyBoughtModalCtrl=n},function(e,t,r){"use strict";function provideBuyButtonDirective(){return new n}Object.defineProperty(t,"__esModule",{value:!0}),t.provideBuyButtonDirective=provideBuyButtonDirective;var n=function(){function BuyButtonDirective(){this.restrict="E",this.scope={},this.controller="BuyButtonCtrl",this.controllerAs="buyButton",this.template=r(86),this.bindToController={purchase:"=",onSuccess:"&",onBuyCommandError:"&",disabled:"=?"}}return BuyButtonDirective}()},function(e,t){e.exports='<button\n        ng-if="!buyButton.isCheckLimitExceeded"\n        id="buy-and-pay-btn"\n        class="btn btn-primary"\n        ng-class="{spinner: buyButton.isBuying}"\n        type="submit"\n        ng-click="buyButton.processSummaryConfirmation()"\n        ng-disabled="buyButton.isBuying || buyButton.disabled">\n    <span ng-if="!buyButton.isBuying && !buyButton.isBought" translate>buy and pay</span>\n    <span ng-if="buyButton.isBuying && !buyButton.isBought" translate>buying in progress</span>\n    <span ng-if="buyButton.isBought" translate>pay</span>\n</button>\n<button\n        ng-if="buyButton.isCheckLimitExceeded"\n        id="check-status-btn"\n        class="btn btn-primary spinner"\n        type="submit"\n        ng-click="buyButton.checkStatus()"\n        ng-disabled="buyButton.isBuying">\n    <span ng-if="!buyButton.isBuying" translate>check status</span>\n    <span ng-if="buyButton.isBuying" translate>checking status</span>\n</button>\n\n<span class="didascalia hidden-xm hidden-xs hidden-ss"\n      ng-if="!buyButton.isBought\n              && !buyButton.isBuying\n              && !buyButton.isCartProcess">\n    <translate>pressing button buys item</translate>\n</span>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function BuyFailedSvc(e){"ngInject";this.purchaseConstants=e}return BuyFailedSvc.$inject=["PURCHASE_CONSTANTS"],BuyFailedSvc.prototype.getFailedOffers=function(e){var t=this;return e.orders.filter(function(e){return e.status==t.purchaseConstants.PURCHASE_STATUS.PARTIALLY_BOUGHT||e.status==t.purchaseConstants.PURCHASE_STATUS.BUY_FAILED}).flatMap(function(e){return e.offers}).filter(function(e){return e.status==t.purchaseConstants.PURCHASE_STATUS.BUY_FAILED})},BuyFailedSvc}();t.BuyFailedSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ConfirmBuySvc(e){"ngInject";this.$log=e}return ConfirmBuySvc.$inject=["$log"],ConfirmBuySvc.prototype.saveOffersToConfirm=function(e,t){if(e&&t){var r=this.filterOldOffers(this.getOffersToConfirm()).filter(function(r){return r.buyerId!==t||r.id!==e});r.push({id:e,buyerId:t,timestamp:(new Date).getTime().toString()});var n=JSON.stringify(r.slice(-ConfirmBuySvc.MAX_STORED_OFFERS));try{localStorage.setItem("offersToConfirm",n)}catch(e){this.$log.debug("Error: Cannot save items to local storage ("+e+")")}}},ConfirmBuySvc.prototype.isOfferAlreadyBought=function(e,t){return this.filterOldOffers(this.getOffersToConfirm()).some(function(r){return r.id===e&&r.buyerId===t})},ConfirmBuySvc.prototype.getOffersToConfirm=function(){var e=localStorage.getItem("offersToConfirm");return JSON.parse(e)||[]},ConfirmBuySvc.prototype.filterOldOffers=function(e){var t=(new Date).getTime()-ConfirmBuySvc.DAYS_TO_CONFIRM;return e.filter(function(e){return Number(e.timestamp)>=t})},ConfirmBuySvc.DAYS_TO_CONFIRM=1728e5,ConfirmBuySvc.MAX_STORED_OFFERS=5,ConfirmBuySvc}();t.ConfirmBuySvc=n},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"offer {{::offer.id}}":"oferta nr {{::offer.id}}"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function BuyErrorListComponent(){this.bindings={failedOffers:"<?",validationId:"<"},this.controller="BuyErrorListCtrl",this.template=r(91)}return BuyErrorListComponent}();t.BuyErrorListComponent=n},function(e,t){e.exports='<section class="buy-error-list">\n    <section class="validator-result" ng-if="$ctrl.isLoaded && $ctrl.isPurchaseValidatorErrorsAvailable">\n        <section class="validator-error-generic" ng-if="$ctrl.genericPurchaseValidatorMessage">\n            <p>{{$ctrl.genericPurchaseValidatorMessage}}</p>\n        </section>\n        <section class="validator-error-items" ng-if="!$ctrl.genericPurchaseValidatorMessage">\n            <ul class="validator-error-item-list">\n                <li class="validator-error-item" ng-repeat="offer in ::$ctrl.failedOffers track by $index">\n                    <div class="validator-error-item-photo">\n                        <a ng-href="{{ ::offer.viewUrl }}" target="_self" ng-class="{\'no-photo\' : !offer.image.url }">\n                            <img ng-if="::offer.image.url" ng-src="{{ ::offer.image.url | httpsImage }}"\n                                title="{{ ::offer.image.title }}" alt="{{ ::offer.image.title }}"/>\n                        </a>\n                    </div>\n                    <div class="validator-error-item-name">\n                        <a ng-href="{{ ::offer.viewUrl }}">\n                            <span ng-if="::offer.name">{{ ::offer.name }}</span>\n                            <span ng-if="::!offer.name" translate>offer {{::offer.id}}</span>\n                        </a>\n                    </div>\n                    <div class="validator-error-item-message" ng-init="validationMessage = $ctrl.getPurchaseValidatorMessageByOfferId(offer.id)">\n                        <span ng-if="::validationMessage">{{ ::validationMessage }}</span>\n                        <span ng-if="::!validationMessage" translate>Unable to buy offer</span>\n                    </div>\n                </li>\n            </ul>\n        </section>\n    </section>\n    <div ng-if="!$ctrl.isLoaded" class="loader-wrapper">\n        <div class="spinner spinner-medium"></div>\n    </div>\n</section>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function BuyErrorListCtrl(e,t,r){"ngInject";this.urlFilter=e("url"),this.isLoaded=!1,this.configurationSvc=r,this.country=r.getLocale().country,this.isPurchaseValidatorErrorsAvailable=!1,this.getValidationErrors(t)}return BuyErrorListCtrl.$inject=["$filter","BuyValidationSvc","ConfigurationSvc"],BuyErrorListCtrl.prototype.getValidationErrors=function(e){var t=this;e.getPurchaseValidatorErrors(this.validationId).then(function(e){t.isPurchaseValidatorErrorsAvailable=!0,t.purchaseValidatorResult=e,t.genericPurchaseValidatorMessage=BuyErrorListCtrl.getGeneralPurchaseValidatorMessageByCountry(e.generalErrors,t.country),t.ensureFailedOffers(e)},function(){t.isPurchaseValidatorErrorsAvailable=!1}).finally(function(){t.isLoaded=!0})},BuyErrorListCtrl.prototype.getPurchaseValidatorMessageByOfferId=function(e){var t=this.purchaseValidatorResult.itemErrors.filter(function(t){return t.id===e});return t&&t[0]&&t[0].errorMessages?t[0].errorMessages[this.country]:""},BuyErrorListCtrl.getGeneralPurchaseValidatorMessageByCountry=function(e,t){return Array.isArray(e)&&e[0]&&e[0].errorMessages&&e[0].errorMessages[t]?e[0].errorMessages[t]:null},BuyErrorListCtrl.prototype.ensureFailedOffers=function(e){this.failedOffers&&this.failedOffers.length||(this.failedOffers=this.createOffersFromValidationResult(e.itemErrors))},BuyErrorListCtrl.prototype.createOffersFromValidationResult=function(e){var t=this;return e?e.map(function(e){return e.id}).filter(function(e,t,r){return r.indexOf(e)===t}).map(function(e){return{id:e,image:{title:"",url:""},viewUrl:"//"+t.configurationSvc.getHost()+t.urlFilter("offer",e),name:""}}):[]},BuyErrorListCtrl}();t.BuyErrorListCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function BuyValidationSvc(e,t,r,n,o){"ngInject";this.$q=e,this.$http=t,this.$exceptionHandler=r,this.CustomException=n,this.configurationSvc=o}return BuyValidationSvc.$inject=["$q","$http","$exceptionHandler","CustomException","ConfigurationSvc"],BuyValidationSvc.prototype.getPurchaseValidatorErrors=function(e){var t=this;if(!e)return this.$q.reject("No validation ID is available.");var r=this.configurationSvc.getApiUrl()+"/purchases/validation-result/"+e;return this.$http.get(r).then(function(e){if(e.data.result)throw new t.CustomException({name:"GetPurchaseValidatorErrorsException",message:"Validation error"});return e.data},function(e){var r=new t.CustomException({name:"GetPurchaseValidatorErrorsException",message:"Failed to get purchase validator errors",error:e});return t.$exceptionHandler(r),t.$q.reject(e)})},BuyValidationSvc}();t.BuyValidationSvc=n},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Error trace id":"Identyfikator błędu","Unexpected error has occurred":"Przepraszamy, wystąpił nieoczekiwany błąd",close:"zamknij","try again":"spróbuj ponownie"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ErrorReasonModalCtrl(e,t,r){"ngInject";void 0===e&&(e={}),this.header=null,this.$uibModalInstance=t,this.message=e.message,this.header=e.header||r.getString("Unexpected error has occurred"),this.andamioError=e.andamioError,this.traceId=e.traceId,this.statusCode=e.status,this.andamioError&&this.andamioError.userMessage&&(this.header=this.andamioError.userMessage)}return ErrorReasonModalCtrl.$inject=["options","$uibModalInstance","gettextCatalog"],ErrorReasonModalCtrl.prototype.reload=function(){this.$uibModalInstance.close({reload:!0})},ErrorReasonModalCtrl}();t.ErrorReasonModalCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ModalSvc(e,t,r,n){"ngInject";this.$uibModal=e,this.$state=t,this.PurchaseNgaSvc=r,this.isThemeMetrumize=n.isThemeMetrumize()}return ModalSvc.$inject=["$uibModal","$state","PurchaseNgaSvc","ConfigurationSvc"],ModalSvc.prototype.showErrorReason=function(e){var t=this,n=this.isThemeMetrumize?"error-modal error-modal-metrumize":"error-modal",o=this.$uibModal.open({template:r(97),controller:"ErrorReasonModalCtrl",controllerAs:"$ctrl",bindToController:!0,windowClass:n,backdrop:"static",keyboard:!1,resolve:{options:function(){return e}}});o.opened.finally(function(){return t.PurchaseNgaSvc.errorModalOnOpen()}),o.result.then(function(e){e&&e.reload&&t.$state.reload()}).catch(function(){})},ModalSvc.prototype.showMessageModal=function(e,t){return void 0===t&&(t={}),this.$uibModal.open({template:r(98),controller:"MessageModalCtrl",controllerAs:"$ctrl",bindToController:!0,backdrop:"static",keyboard:!1,resolve:{message:function(){return e},buttons:function(){return t}}})},ModalSvc.prototype.prepareOptionsFromReason=function(e){return{status:e.status||null,traceId:"function"==typeof e.headers?e.headers("Trace-Id"):"",andamioError:e.data&&Array.isArray(e.data.errors)&&e.data.errors[0]?e.data.errors[0]:null}},ModalSvc}();t.ModalSvc=n},function(e,t){e.exports='<div class="modal-header">\n    <h3 class="modal-title">\n        {{::$ctrl.header}}\n    </h3>\n</div>\n<div class="modal-body">\n    <div ng-if="::$ctrl.message">{{::$ctrl.message}}</div>\n    <div ng-if="::$ctrl.traceId">\n        <translate>Error trace id</translate>: {{::$ctrl.traceId}}\n        <span>[{{::$ctrl.statusCode}}]</span>\n    </div>\n</div>\n<div class="modal-footer">\n    <button type="button" class="btn btn-primary" translate ng-click="$ctrl.reload()">try again</button>\n</div>'},function(e,t){e.exports='<div class="modal-header">\n    <h3 class="modal-title">\n        {{::$ctrl.message.title}}\n    </h3>\n</div>\n<div class="modal-body">\n    <div>{{::$ctrl.message.content}}</div>\n</div>\n<div class="modal-footer">\n    <button type="button" class="btn btn-primary" ng-click="$ctrl.close()">\n        <span ng-if="$ctrl.buttons.confirm">{{::$ctrl.buttons.confirm}}</span>\n        <span translate ng-if="!$ctrl.buttons.confirm">close</span>\n    </button>\n</div>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function MessageModalCtrl(e,t,r){"ngInject";this.$uibModalInstance=r,this.message=e,this.buttons=t}return MessageModalCtrl.$inject=["message","buttons","$uibModalInstance"],MessageModalCtrl.prototype.close=function(){this.$uibModalInstance.close()},MessageModalCtrl}();t.MessageModalCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function OfferCtrl(){}return OfferCtrl.prototype.$onInit=function(){void 0===this.showPrice&&(this.showPrice=!0),void 0===this.showQuantity&&(this.showQuantity=!0),this.offer&&this.offer.image&&this.offer.image.url&&(this.imageUrl=this.offer.image.url.replace("/original/","/s64/"))},OfferCtrl}();t.OfferCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function OfferPriceCtrl(){}return OfferPriceCtrl.prototype.$onInit=function(){var e=this.totalPriceBeforeDiscount&&Number(this.totalPriceBeforeDiscount.amount)||null,t=this.totalDiscountedPrice&&Number(this.totalDiscountedPrice.amount)||null;this.isDiscounted=e>t},OfferPriceCtrl}();t.OfferPriceCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function OfferComponent(){this.bindings={offer:"<",showQuantity:"<?",showPrice:"<?"},this.controller="offerCtrl",this.template=r(103)}return OfferComponent}();t.OfferComponent=n},function(e,t){e.exports='<div class="offer row">\n    <div class="col-xs-12">\n        <div class="row offer-row">\n            <div class="col-xm-12 middle-wrapper offer-title" ng-class="{\n                \'col-ss-7\': $ctrl.showQuantity && $ctrl.showPrice,\n                \'col-ss-10\': !$ctrl.showQuantity && $ctrl.showPrice,\n                \'col-ss-9\': $ctrl.showQuantity && !$ctrl.showPrice\n            }">\n                <div class="middle photo">\n                    <a ng-href="{{::$ctrl.offer.viewUrl}}" ng-class="{ \'no-photo\': !$ctrl.imageUrl }" target="_self">\n                        <img ng-if="::$ctrl.imageUrl" ng-src="{{::$ctrl.imageUrl | httpsImage}}" alt="{{::$ctrl.offer.image.title}}"/>\n                    </a>\n                </div>\n                <div class="middle offer-name">\n                    <a class="offer-link" href="{{::$ctrl.offer.viewUrl}}" target="_self">\n                        <span class="title">{{$ctrl.offer.name}}</span>\n                    </a>\n                </div>\n            </div>\n\n            <div ng-if="$ctrl.showQuantity"\n                 class="col-xm-6 col-ss-2 offer-count middle-wrapper">\n                <div class="middle">\n                    <offer-quantity class="didascalia-color" quantity="$ctrl.offer.quantity" quantity-type="$ctrl.offer.type"></offer-quantity>\n                </div>\n            </div>\n            <offer-price ng-if="$ctrl.showPrice"\n                         class="col-xm-6 col-ss-3 offer-price middle-wrapper"\n                         unit-price="$ctrl.offer.price"\n                         quantity="$ctrl.offer.quantity"\n                         quantity-type="$ctrl.offer.quantityType"\n                         total-discounted-price="$ctrl.offer.options.rebates.multipack.totalDiscountedPrice"\n                         total-price-before-discount="$ctrl.offer.options.rebates.multipack.totalOriginalPrice"></offer-price>\n        </div>\n    </div>\n</div>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function OfferPriceComponent(){this.bindings={quantity:"<",quantityType:"<",unitPrice:"<",totalPriceBeforeDiscount:"<?",totalDiscountedPrice:"<?"},this.controller="offerPriceCtrl",this.template=r(105)}return OfferPriceComponent}();t.OfferPriceComponent=n},function(e,t){e.exports='<div class="middle">\n    <div class="original-price didascalia-color" ng-if="$ctrl.isDiscounted">\n        <del>\n            <formatted-price amount="::$ctrl.totalPriceBeforeDiscount.amount"\n                             currency="::$ctrl.totalPriceBeforeDiscount.currency"></formatted-price>\n        </del>\n    </div>\n    <formatted-price class="total" amount="::($ctrl.unitPrice.amount * $ctrl.quantity)" currency="::$ctrl.unitPrice.currency"></formatted-price>\n\n    <div class="small didascalia-color" ng-if="!$ctrl.isDiscounted">\n        <per-piece quantity-type="::offer.quantityType"></per-piece>\n        <strong>{{$ctrl.unitPrice.amount | currency}}</strong>\n    </div>\n</div>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function OfferSvc(){}return OfferSvc.prototype.mapMyOrderOfferToPurchaseOffer=function(e){var t=e.id,r=e.imageUrl,n=e.title;return{id:t,image:{url:r,title:n},name:n,quantity:e.quantity,quantityType:e.type,price:e.unitPrice,viewUrl:e.friendlyUrl}},OfferSvc}();t.OfferSvc=n},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Order No.":"Zamówienie nr","adopted by":"przyjmowane przez",buyer:"kupujący",dated:"z dnia","pharmacy address":"adres apteki"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PharmacyComponent(){this.bindings={orderId:"<",pharmacyAddress:"<",buyerAddress:"<"},this.controller="PharmacyCtrl",this.template=r(109)}return PharmacyComponent}();t.PharmacyComponent=n},function(e,t){e.exports='<hr class="separator separator-top" ng-if="::$ctrl.pharmacyAddress">\n<section class="pharmacy row" ng-if="::$ctrl.pharmacyAddress">\n    <div class="pharmacy-info col-ss-12 col-xm-12">\n        <p>\n            <translate>Order No.</translate> <strong>{{::$ctrl.orderId}}</strong>\n            <translate>dated</translate> {{::$ctrl.orderDate | date:\'shortDate\'}}\n            <span ng-if="::($ctrl.pharmacyAddress.lastName || $ctrl.pharmacyAddress.firstName)">\n                <translate>adopted by</translate> {{::$ctrl.pharmacyAddress.firstName}} {{::$ctrl.pharmacyAddress.lastName}}.\n            </span>\n        </p>\n    </div>\n    <div class="col-ss-6 col-xm-12">\n        <section class="pharmacy-info pharmacy-address">\n            <header class="pharmacy-section-title">\n                <h5 translate>pharmacy address</h5>\n            </header>\n            <div>{{::$ctrl.pharmacyAddress.company}}</div>\n            <div>{{::$ctrl.pharmacyAddress.street}}</div>\n            <div>{{::$ctrl.pharmacyAddress.zipCode}} {{::$ctrl.pharmacyAddress.city}}</div>\n        </section>\n    </div>\n    <div class="col-ss-6 col-xm-12" ng-if="::$ctrl.buyerAddress">\n        <section class="pharmacy-info pharmacy-buyer">\n            <header class="pharmacy-section-title">\n                <h5 translate>buyer</h5>\n            </header>\n            <div>{{::$ctrl.buyerAddress.firstName}} {{::$ctrl.buyerAddress.lastName}}</div>\n            <div>{{::$ctrl.buyerAddress.street}}</div>\n            <div>{{::$ctrl.buyerAddress.zipCode}} {{::$ctrl.buyerAddress.city}}</div>\n        </section>\n    </div>\n</section>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PharmacyCtrl(){"ngInject";this.orderDate=new Date}return PharmacyCtrl}();t.PharmacyCtrl=n},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Message not received or expired?":"Wiadomość nie dotarła lub kod stracił ważność?","re-send":"Wyślij ponownie","write here your sent code":"wpisz tutaj kod wysłany na adres:","Mail has been sent":"kod został wysłany"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function GuestVerificationCtrl(e,t,r){"ngInject";this.EmailGuestVerificationSvc=e,this.PurchaseNgaSvc=t,this.ModalSvc=r,this.showResent=!1}return GuestVerificationCtrl.$inject=["EmailGuestVerificationSvc","PurchaseNgaSvc","ModalSvc"],GuestVerificationCtrl.prototype.$onChanges=function(e){e.buyValidationError&&e.buyValidationError.currentValue!==e.buyValidationError.previousValue&&this.setVerificationCodeMessage(e.buyValidationError.currentValue)},GuestVerificationCtrl.prototype.setVerificationCodeMessage=function(e){var t=this.EmailGuestVerificationSvc.getVerificationCodeError(e);this.verificationCodeErrorMessage=null,t&&(this.verificationCodeErrorMessage=t.userMessage)},GuestVerificationCtrl.prototype.resendVerificationCode=function(){var e=this;this.showResent=!1,this.verificationCodeErrorMessage=null,this.PurchaseNgaSvc.publishGuestVerificationCodeResend(),this.EmailGuestVerificationSvc.sendVerificationEmail(this.purchaseId,!0).then(function(){return e.showResent=!0}).catch(function(t){t.data&&Array.isArray(t.data.errors)&&e.EmailGuestVerificationSvc.isGuestVerificationCodeSendToManyTimes(t.data.errors[0])&&e.ModalSvc.showMessageModal({title:t.data.errors[0].userMessage})})},GuestVerificationCtrl}();t.GuestVerificationCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function EmailGuestVerificationSvc(e,t,r,n,o){"ngInject";this.$http=e,this.$q=t,this.$exceptionHandler=r,this.configurationSvc=n,this.CustomException=o}return EmailGuestVerificationSvc.$inject=["$http","$q","$exceptionHandler","ConfigurationSvc","CustomException"],EmailGuestVerificationSvc.prototype.sendVerificationEmail=function(e,t){return void 0===t&&(t=!1),this.$http.post(this.getApiUrl(),{purchaseId:e,resend:t,language:this.configurationSvc.getLocale().language})},EmailGuestVerificationSvc.prototype.getVerificationCodeError=function(e){return e&&this.isGuestVerificationCodeMismatch(e)?e:null},EmailGuestVerificationSvc.prototype.isGuestVerificationCodeMismatch=function(e){return e.code===EmailGuestVerificationSvc.VERIFICATION_FAILED_ERROR},EmailGuestVerificationSvc.prototype.isGuestVerificationCodeSendToManyTimes=function(e){return e.code===EmailGuestVerificationSvc.TOO_MANY_REQUESTS},EmailGuestVerificationSvc.prototype.isVerificationCodeSet=function(e){return!!e},EmailGuestVerificationSvc.prototype.getApiUrl=function(){return this.configurationSvc.getApiUrl()+"/guest/processGuestVerification"},EmailGuestVerificationSvc.VERIFICATION_FAILED_ERROR="VERIFICATION_FAILED_ERROR",EmailGuestVerificationSvc.TOO_MANY_REQUESTS="TOO_MANY_REQUESTS",EmailGuestVerificationSvc}();t.EmailGuestVerificationSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function GuestVerification(){this.bindings={isGuest:"<",guestData:"<",verificationCode:"=",purchaseId:"<",buyValidationError:"<"},this.controller="GuestVerificationCtrl",this.template=r(115)}return GuestVerification}();t.GuestVerification=n},function(e,t){e.exports='<section class="guest-verification-section" id="guest-verification-section" ng-if="$ctrl.isGuest">\n    <label for="guest-verification-code">\n        <translate>write here your sent code</translate>\n        <strong>{{$ctrl.guestData.email}}</strong>\n    </label>\n    <div>\n        <input type="text"\n            name="guestDataInput"\n            id="guest-verification-code"\n            class="form-control guest-verification-input"\n            ng-model="$ctrl.verificationCode"\n            ng-class="{\'input-error\': $ctrl.verificationCodeErrorMessage}"\n            ui-mask="9999">\n        <em class="validation-message in" ng-if="$ctrl.verificationCodeErrorMessage">\n            <span>{{$ctrl.verificationCodeErrorMessage}}</span>\n        </em>\n        <p class="guest-verification-note didascalia">\n            <span translate>Message not received or expired?</span>\n            <button ng-click="$ctrl.resendVerificationCode()" type="button" class="btn btn-link" translate>re-send</button>\n            <span id="guest-verification-resend-done" ng-show="$ctrl.showResent" translate>Mail has been sent</span>\n        </p>\n    </div>\n</section>'},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(117);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(118),a=r(119),s=r(2),c=_interopRequireDefault(s),l=r(1),u=_interopRequireDefault(l),d=o.module("purchase.cvvVerification",["ui.router","paymentsMethods",c.default.name,u.default.name]).controller("CvvVerificationCtrl",i.CvvVerificationCtrl).service("CvvVerificationSvc",a.CvvVerificationSvc);t.default=d},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"confirm CVV code":"podaj ponownie kod CVV",Continue:"Dalej","CVV2/CVC2 code":"kod CVV2/CVC2","In some cases, we ask you to confirm the CVV code due to security reasons.":"O ponowne wprowadzenie kodu CVV prosimy ze względów bezpieczeństwa tylko w niektórych przypadkach.","Invalid format":"Nieprawidłowy format","last three digits of a code<br>printed on the reverse of your card":"ostatnie 3 cyfry kodu<br>znajdującego się z tyłu karty","To complete your payment, provide the CVV code that secures your card.":"Aby dokończyć płatność wpisz kod CVV zabezpieczający Twoją kartę.","Your credit card:":"Twoja karta"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function CvvVerificationCtrl(e,t,r,n,o,i){"ngInject";this.$log=r,this.$window=t,this.$state=e,this.cvvVerificationSvc=o,this.CustomException=i,this.environment=n.getEnvironment(),this.cvvParams={url:e.params.url,posId:e.params.posId,sig:e.params.sig},this.showWidget=this.isVerificationRequired(),this.showWidget||this.handleRedirection(),this.locale=n.getLocale(),this.setupPayuWidgetCallback()}return CvvVerificationCtrl.$inject=["$state","$window","$log","ConfigurationSvc","CvvVerificationSvc","CustomException"],CvvVerificationCtrl.prototype.isVerificationRequired=function(){if(!this.$state.params)return!1;var e=this.$state.params.url,t=this.$state.params.statusCode===CvvVerificationCtrl.WARNING_CONTINUE_CVV;return e||t},CvvVerificationCtrl.prototype.setupPayuWidgetCallback=function(){var e=this;this.$window.__OpenPayuWidgetCallback=function(t){e.$log.debug("CVV callback data",t),e.handleRedirection()}},CvvVerificationCtrl.prototype.handleRedirection=function(){var e=this;this.cvvVerificationSvc.getThankYouPageUrl(this.$state.params.paymentId).then(function(t){return e.doRedirect(t)},function(){return e.doRedirect("/")})},CvvVerificationCtrl.prototype.doRedirect=function(e){this.$log.debug("redirecting to url",e),this.$window.location.href=e},CvvVerificationCtrl.WARNING_CONTINUE_CVV="WARNING_CONTINUE_CVV",CvvVerificationCtrl}();t.CvvVerificationCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function CvvVerificationSvc(e,t,r,n,o,i){"ngInject";this.$http=e,this.$log=r,this.$q=o,this.$exceptionHandler=n,this.CustomException=i,this.configurationSvc=t}return CvvVerificationSvc.$inject=["$http","ConfigurationSvc","$log","$exceptionHandler","$q","CustomException"],CvvVerificationSvc.prototype.getThankYouPageUrl=function(e,t,r){var n=this,o={method:"GET",url:this.getPaymentDetailsUrl(e),headers:this.requestHeaders()};return this.$http(o).then(function(e){var o=e&&e.data&&e.data.thankYouPageUrl?e.data.thankYouPageUrl:"";return n.$log.debug("get payment success",o),t&&r&&(o=n.addUrlParams(o,t,r)),o},function(e){n.$log.debug("get payment details failure",e);var t=new n.CustomException({name:"CvvSvcException",message:"Failed to get thankyou url",error:e});return n.$exceptionHandler(t),n.$q.reject(e)})},CvvVerificationSvc.prototype.addUrlParams=function(e,t,r){return e+(-1===e.indexOf("?")?"?":"&")+t+"="+r},CvvVerificationSvc.prototype.requestHeaders=function(){return{Accept:"application/vnd.allegro.public.v1+json"}},CvvVerificationSvc.prototype.getPaymentDetailsUrl=function(e){return this.configurationSvc.getApiUrl()+"/payments/"+e+"/thankYouPageUrl"},CvvVerificationSvc}();t.CvvVerificationSvc=n},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(121);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(122),a=r(4),s=_interopRequireDefault(a),c=r(2),l=_interopRequireDefault(c),u=r(12),d=_interopRequireDefault(u),p=r(1),f=_interopRequireDefault(p),h=o.module("purchase.errorLanding",[s.default.name,l.default.name,d.default.name,f.default.name]).controller("ErrorLandingCtrl",i.ErrorLandingCtrl);t.default=h},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"An error occurred":"Wystąpił błąd.","back to cart":"wróć do koszyka","back to item page":"wróć do strony przedmiotu"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ErrorLandingCtrl(e,t,r){"ngInject";this.redirectTo=t,this.isThemeMetrumize=r.isThemeMetrumize(),this.isCart="cart"===e.params.purchaseFlow,this.id=e.params.id,this.validationId=e.params.validationId,this.isValidationIdAvailable=!!this.validationId}return ErrorLandingCtrl.$inject=["$state","redirectTo","ConfigurationSvc"],ErrorLandingCtrl}();t.ErrorLandingCtrl=n},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"+ delivery cost":"+ koszty dostawy","1 offer":["{{$count}} przedmiot","{{$count}} przedmioty","{{$count}} przedmiotów"],"Already paid for these offers?":"Zapłaciłeś już za te zakupy?","Remove them from this list":"Usuń je z tej listy","Removing order from this list doesn't mean cancelling it.":"Pamiętaj, że usunięcie zakupu z tej listy nie oznacza jego anulowania.","Select offers for payment":"Wybierz oferty do zapłaty","You may pay for all already grouped offers only.":"Jeśli kupiłeś od jednego sprzedawcy kilka przedmiotów przez koszyk lub próbowałeś wcześniej za nie zapłacić razem, do wspólnej zapłaty dodajesz całość, a nie pojedyncze zakupy.","go back to my orders":"wróć","from 1 seller":["od {{$count}} sprzedającego","od {{$count}} sprzedających","od {{$count}} sprzedających"],"go to delivery and payment form":"wybierz dostawę i płatność","select all":"zaznacz wszystkie","seller:":"sprzedający:","total for":"razem za"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function OffersFromSellersComponent(){this.bindings={offersCount:"<",sellersCount:"<"},this.template=r(125)}return OffersFromSellersComponent}();t.OffersFromSellersComponent=n},function(e,t){e.exports='<translate translate-n="$ctrl.offersCount" translate-plural="{{$count}} offers">1 offer</translate>\n<translate translate-n="$ctrl.sellersCount" translate-plural="from {{$count}} sellers">from 1 seller</translate>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RelatedOrderComponent(){this.bindings={myOrder:"<",model:"<"},this.template=r(127),this.controller="RelatedOrderCtrl"}return RelatedOrderComponent}();t.RelatedOrderComponent=n},function(e,t){e.exports='<section class="table related-order" ng-class="{\'selected\': $ctrl.model.indexOf($ctrl.myOrder) != -1}">\n    <div class="table-row">\n        <div class="table-cell select-order">\n            <input type="checkbox"\n                   id="related-order-{{::$ctrl.myOrder.id}}"\n                   checklist-model="$ctrl.model"\n                   checklist-value="::$ctrl.myOrder">\n        </div>\n        <div class="table-cell seller-info">\n            <label for="related-order-{{::$ctrl.myOrder.id}}" class="didascalia">\n                <translate>seller:</translate>\n                <strong>{{::$ctrl.myOrder.seller.login}}</strong>\n            </label>\n            <i class="icon-q"\n               ng-if="::($ctrl.myOrder.offers.length > 1)"\n               uib-popover="{{\'You may pay for all already grouped offers only.\' | translate}}"\n               popover-placement="bottom"\n               popover-trigger="\'mouseenter outsideClick\'"></i>\n        </div>\n    </div>\n    <div class="table-row">\n        <div class="table-cell"></div>\n        <div class="table-cell order-content">\n            <offer offer="offer" ng-repeat="offer in ::$ctrl.offers track by $index"></offer>\n        </div>\n    </div>\n    <div class="table-row">\n        <div class="table-cell"></div>\n        <div class="table-cell">\n            \x3c!-- order removal feature is not developed yet--\x3e\n            <span ng-if="false" class="didascalia order-removal"\n                  uib-popover="{{\'Removing order from this list doesn\\\'t mean cancelling it.\' | translate}}"\n                  popover-placement="bottom"\n                  popover-trigger="\'mouseenter outsideClick\'">\n                <translate>Already paid for these offers?</translate>\n                <button class="btn btn-link"\n                        type="button"\n                        ng-click="$ctrl.removeFromRelated()"\n                        translate>Remove them from this list</button>\n            </span>\n        </div>\n    </div>\n</section>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RelatedCtrl(e,t,r,n,o,i,a,s,c){"ngInject";this.isLoaded=!1,this.creatingPurchaseInProgress=!1,this.$state=t,this.$stateParams=c,this.purchaseNgaSvc=r,this.purchaseConstants=o,this.relatedSvc=i,this.purchaseSvc=a,this.summationSvc=s,this.modalSvc=n,this.purchaseCtrl=e.purchase,this.boughtOrders=this.relatedSvc.mapOrdersToMyOrders(this.purchaseCtrl.data.orders),this.allOrders=this.boughtOrders,this.getRelatedOrders(),this.prepareOrdersToPay(e)}return RelatedCtrl.$inject=["$scope","$state","PurchaseNgaSvc","ModalSvc","PURCHASE_CONSTANTS","RelatedSvc","PurchaseSvc","PurchaseSummationSvc","$stateParams"],RelatedCtrl.prototype.goToDapf=function(){var e=this;this.sendAnalyticsEventsOnExit(),this.relatedSvc.areOrderListsEqual(this.ordersToPay,this.boughtOrders)?this.$state.go("purchase.dapf"):(this.creatingPurchaseInProgress=!0,this.purchaseSvc.createPurchaseFromOrderIds(this.ordersToPay.map(function(e){return e.id})).then(function(t){return e.$state.go("purchase.dapf",{purchaseId:t.id})}).catch(function(t){var r=e.modalSvc.prepareOptionsFromReason(t);e.modalSvc.showErrorReason(r)}).finally(function(){return e.creatingPurchaseInProgress=!1}))},RelatedCtrl.prototype.toggleSelectAllOrders=function(){this.isToggleAllSelected?this.ordersToPay=this.allOrders.slice(0):this.ordersToPay=[]},RelatedCtrl.prototype.prepareOrdersToPay=function(e){var t=this;this.ordersToPay=this.boughtOrders.slice(0),e.$watch(function(){return t.ordersToPay},function(){return t.handleOrdersToPayChange()},!0)},RelatedCtrl.prototype.handleOrdersToPayChange=function(){this.isToggleAllSelected=this.isEveryOrderSelected(),this.selectedOrdersOffersCount=this.summationSvc.getOffersCount(this.ordersToPay),this.selectedOrdersSellersCount=this.summationSvc.getSellersCount(this.ordersToPay),this.selectedOrdersTotalCost=this.summationSvc.getTotalMyOrdersOffersCost(this.ordersToPay)},RelatedCtrl.prototype.isEveryOrderSelected=function(){return this.ordersToPay.length===this.allOrders.length},RelatedCtrl.prototype.getRelatedOrders=function(){var e=this;this.relatedSvc.getRelatedOrders(this.purchaseCtrl.data).then(function(t){return e.relatedOrders=t}).catch(function(){}).finally(function(){return e.finalizeGettingRelatedOrders()})},RelatedCtrl.prototype.finalizeGettingRelatedOrders=function(){if(this.isLoaded=!0,!(this.relatedOrders&&this.relatedOrders.hasRelatedOrders&&this.relatedOrders.related&&this.relatedOrders.related.length))return void this.$state.go("purchase.dapf");this.allOrders=this.boughtOrders.concat(this.relatedOrders.related),this.offersCount=this.summationSvc.getOffersCount(this.allOrders),this.sellersCount=this.summationSvc.getSellersCount(this.allOrders),this.sendAnalyticsEventsOnEntry()},RelatedCtrl.prototype.sendAnalyticsEventsOnEntry=function(){this.purchaseNgaSvc.sendPageView(this.purchaseConstants.NGA_STATE_TAG.RELATED,this.purchaseCtrl.processEntry,this.purchaseCtrl.isCartProcess,this.$stateParams.referrer,!this.purchaseCtrl.isGuest,this.purchaseCtrl.flags)},RelatedCtrl.prototype.sendAnalyticsEventsOnExit=function(){var e=this.relatedOrders&&this.relatedOrders.related?this.relatedOrders.related:[];this.purchaseNgaSvc.publishRelatedResult(this.ordersToPay,e)},RelatedCtrl}();t.RelatedCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RelatedOrderCtrl(e,t){"ngInject";this.PurchaseNgaSvc=e,this.offerSvc=t}return RelatedOrderCtrl.$inject=["PurchaseNgaSvc","offerSvc"],RelatedOrderCtrl.prototype.$onInit=function(){var e=this;this.offers=this.myOrder.offers.map(function(t){return e.offerSvc.mapMyOrderOfferToPurchaseOffer(t)})},RelatedOrderCtrl.prototype.removeFromRelated=function(){this.PurchaseNgaSvc.publishRelatedOrderRemoval(this.myOrder)},RelatedOrderCtrl}();t.RelatedOrderCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RelatedSvc(e,t,r,n,o){"ngInject";this.$http=e,this.$q=o,this.configurationSvc=t,this.$exceptionHandler=r,this.CustomException=n}return RelatedSvc.$inject=["$http","ConfigurationSvc","$exceptionHandler","CustomException","$q"],RelatedSvc.prototype.getRelatedOrders=function(e){var t=this,r={params:{serviceCountry:this.configurationSvc.getLocale().country},cache:!0};return this.$http.get(this.getMyOrdersApiUrl(),r).then(function(t){return RelatedSvc.mapResponseToModel(t.data,e)},function(e){var r=new t.CustomException({name:"GetRelatedOrdersException",message:"Failed to get related orders",error:e});return t.$exceptionHandler(r),t.$q.reject(e)})},RelatedSvc.mapResponseToModel=function(e,t){var r=t.orders.map(function(e){return e.id}),n=e&&Array.isArray(e.myorders)?e.myorders.filter(function(e){return-1===r.indexOf(e.id)}):[];return{related:n,hasRelatedOrders:n.length>0}},RelatedSvc.prototype.mapOrdersToMyOrders=function(e){var t=this;return e.map(function(e){return t.mapOrderToMyOrder(e)})},RelatedSvc.prototype.mapOrderToMyOrder=function(e){return{id:e.id,purchaseId:null,seller:e.seller,offers:RelatedSvc.mapOffersToMyOrderOffers(e.offers),delivery:null,totalCost:null,payment:null,timestamp:null,createDate:null,orderVersion:null,serviceCountry:null}},RelatedSvc.prototype.areOrderListsEqual=function(e,t){if(e.length!==t.length)return!1;var r=e.map(function(e){return e.id}),n=t.map(function(e){return e.id});return r.every(function(e){return-1!==n.indexOf(e)})},RelatedSvc.mapOffersToMyOrderOffers=function(e){return e.map(function(e){return{id:e.id,unitPrice:e.price,quantity:e.quantity,orderDate:null,title:e.name,friendlyUrl:e.viewUrl,type:e.quantityType,imageUrl:e.image.url,offerPrice:null}})},RelatedSvc.prototype.getMyOrdersApiUrl=function(){return this.configurationSvc.getApiUrl()+"/related-orders"},RelatedSvc}();t.RelatedSvc=n},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(132);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(133),a=r(135),s=r(137),c=r(138),l=r(140),u=r(141),d=r(142),p=r(3),f=_interopRequireDefault(p),h=r(6),m=_interopRequireDefault(h),v=r(2),y=_interopRequireDefault(v);r(8);var g=r(1),S=_interopRequireDefault(g),C=r(16),P=_interopRequireDefault(C),b=r(147),O=r(149),D=r(150),_=o.module("purchase.thankYou",["ui.router",y.default.name,m.default.name,f.default.name,S.default.name,P.default.name]).component("boughtFrom",new i.BoughtFromComponent).component("primeBanner",new b.PrimeBannerComponent).component("paymentStatus",new a.PaymentStatusComponent).component("paymentCycle",new c.PaymentCycleComponent).controller("PaymentStatusCtrl",s.PaymentStatusCtrl).controller("PaymentCycleCtrl",l.PaymentCycleCtrl).controller("ThankYouCtrl",u.ThankYouCtrl).controller("PrimeBannerCtrl",D.PrimeBannerCtrl).service("primeUserSvc",O.PrimeUserSvc).service("ThankYouSvc",d.ThankYouSvc);t.default=_},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"1 offer":["{{$count}} przedmiot","{{$count}} przedmioty","{{$count}} przedmiotów"],"Click button below, to check payment's status and retry payment.":"Kliknij w poniższy przycisk, aby przejść do szczegółów zakupu i ponowić płatność.","Contact seller to finalize purchase":"W celu zakupu koniecznie <strong>skontaktuj się ze sprzedającym</strong>.",Failed:"Nieudana","Finish registration":"Dokończ rejestrację","My orders":"Moje zakupy","Order and payment details can be found at":"Status zakupu i płatności znajdziesz w zakładce",Paid:"Zakończona","Payment failed.":"Płatność się nie udała.",Processing:"Rozpoczęta","Remember to confirm your payment with mobile app.":"Pamiętaj, aby potwierdzić płatność na swoim telefonie.","Retry payment":"Ponów płatność","Thank you for purchase.":"Dziękujemy za zakupy.","We are waiting for payment confirmation.":"Oczekujemy na odpowiedź od Twojego banku.","We are waiting for your payment. You can check its status at":"Płatność nadal się rozlicza. Jej bieżący status znajdziesz w zakładce","We emailed you your order details.":"Informacje na temat zakupu i płatności przesłaliśmy Ci mailem.","We hope, you will come back to use soon.":"Mamy nadzieję, że już wkrótce znów do nas wrócisz.","You bought":"Kupiłeś","Your payment's status:":"Status Twojej płatności:","from 1 seller":["od {{$count}} sprzedającego","od {{$count}} sprzedających","od {{$count}} sprzedających"],"Join Freebox":"Dołącz do Freebox","Welcome to Freebox!":"Witamy we Freebox!","Your delivery could be free, if you join Freebox.":"Twoja przesyłka może być darmowa, jeśli dołączysz do Allegro Freebox.","An error occured":"Wystąpił błąd"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function BoughtFromComponent(){this.bindings={offersCount:"<",sellersCount:"<"},this.template=r(134)}return BoughtFromComponent}();t.BoughtFromComponent=n},function(e,t){e.exports='<section class="details-section m-display-flex m-flex m-flex-wrap-no m-flex-items-start m-flex-justify-start m-flex-row">\n    <div class="details-section-icon">\n        <svg class="m-icon ">\n            <svg class="m-color-filter-orange" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96">\n                <path d="M36 73.243L15.879 53.121l4.242-4.242L36 64.757l39.879-39.878 4.242 4.242L36 73.243z" />\n            </svg>\n        </svg>\n    </div>\n    <div class="details-section-text">\n        <p class="m-type m-type--paragraph">\n            <translate>You bought</translate>\n            <span translate translate-n="$ctrl.offersCount" translate-plural="{{$count}} offers">1 offer</span>\n            <span translate translate-n="$ctrl.sellersCount" translate-plural="from {{$count}} sellers">from 1 seller</span>.\n        </p>\n    </div>\n</section>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PaymentStatusComponent(){this.bindings={type:"@",status:"@",isGuest:"<"},this.template=r(136),this.controller="PaymentStatusCtrl"}return PaymentStatusComponent}();t.PaymentStatusComponent=n},function(e,t){e.exports='<section class="details-section m-display-flex m-flex m-flex-wrap-no m-flex-items-start m-flex-justify-start m-flex-row">\n    <div class="details-section-icon">\n        <svg class="m-icon ">\n            <svg class="m-color-filter-orange" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96">\n                <path d="M36 73.243L15.879 53.121l4.242-4.242L36 64.757l39.879-39.878 4.242 4.242L36 73.243z" />\n            </svg>\n        </svg>\n    </div>\n    <div ng-if="!$ctrl.isGuest" class="details-section-text">\n        <section>\n            <p class="m-type m-type--paragraph">\n                <translate>Order and payment details can be found at</translate>\n                <a ng-href="{{$ctrl.myOrdersUrl}}" class="m-link m-link--non-visited" target="_self" translate>My orders</a>.\n            </p>\n            <blik-recover\n                ng-if="$ctrl.isBlik()"\n                env="$ctrl.env"\n                status="$ctrl.status"\n                on-success="$ctrl.restartPaymentCycle()"\n            ></blik-recover>\n        </section>\n        <section ng-if="$ctrl.isAnnouncement()">\n            <p class="m-type m-type--paragraph">\n                <translate>Contact seller to finalize purchase</translate>\n            </p>\n        </section>\n    </div>\n    <div ng-if="$ctrl.isGuest" class="details-section-text">\n        <section ng-if="$ctrl.isSuccess() || $ctrl.isBlik()">\n            <p class="m-type m-type--paragraph">\n                <translate>We emailed you your order details.</translate>\n            </p>\n        </section>\n        <section ng-if="$ctrl.isError()">\n            <p class="m-type m-type--paragraph">\n                <translate>Payment failed.</translate>\n            </p>\n        </section>\n        <section ng-if="$ctrl.isAnnouncement()">\n            <p class="m-type m-type--paragraph">\n                <translate>Contact seller to finalize purchase</translate>\n            </p>\n        </section>\n    </div>\n</section>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PaymentStatusCtrl(e,t,r){"ngInject";this.$rootScope=e,this.CONFIGURATION=t,this.ConfigurationSvc=r,this.myOrdersUrl=this.CONFIGURATION.URLS[this.ConfigurationSvc.getLocale().country].bought,this.env=r.getEnvironment()}return PaymentStatusCtrl.$inject=["$rootScope","CONFIGURATION","ConfigurationSvc"],PaymentStatusCtrl.prototype.isBlik=function(){return"blik"===this.type.toLowerCase()},PaymentStatusCtrl.prototype.isSuccess=function(){return"success"===this.type.toLowerCase()},PaymentStatusCtrl.prototype.isError=function(){return"error"===this.type.toLowerCase()},PaymentStatusCtrl.prototype.isAnnouncement=function(){return"announcement"===this.type.toLowerCase()},PaymentStatusCtrl.prototype.restartPaymentCycle=function(){this.$rootScope.$emit("paymentCycle:restart")},PaymentStatusCtrl}();t.PaymentStatusCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PaymentCycleComponent(){this.bindings={cycle:"<",isGuest:"<",isBlikMethod:"<",isProviderOffline:"<"},this.template=r(139),this.controller="PaymentCycleCtrl"}return PaymentCycleComponent}();t.PaymentCycleComponent=n},function(e,t){e.exports='<section ng-if="!$ctrl.isGuest && !$ctrl.isExternal()" class="details-section m-display-flex m-flex m-flex-wrap-no m-flex-items-start m-flex-justify-start m-flex-row">\n    <div ng-if="$ctrl.isPaid()" class="details-section-icon">\n        <svg class="m-icon">\n            <svg class="m-color-filter-orange" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96">\n                <path d="M36 73.243L15.879 53.121l4.242-4.242L36 64.757l39.879-39.878 4.242 4.242L36 73.243z" />\n            </svg>\n        </svg>\n    </div>\n    <div ng-if="!$ctrl.isPaid()" class="details-section-icon">\n        <svg class="m-icon">\n            <svg class="m-color-filter-orange" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96">\n                <path d="M45 30h6v30h-6zm0 36h6v6h-6zm0-36h6v30h-6zm0 36h6v6h-6zm36.775 21h-67.55a8 8 0 0 1-7.1-11.683L40.9 10.18a8 8 0 0 1 14.2 0l33.777 65.137A8 8 0 0 1 81.775 87zM48 11.862a1.955 1.955 0 0 0-1.776 1.08L12.45 78.08A2 2 0 0 0 14.224 81h67.55a2 2 0 0 0 1.775-2.92L49.776 12.94A1.955 1.955 0 0 0 48 11.863z"\n                />\n            </svg>\n        </svg>\n    </div>\n    <div class="details-section-text">\n        <p class="m-type m-type--paragraph">\n            <translate>\n                Your payment\'s status:\n            </translate>\n            <span ng-if="$ctrl.isProcessing()" class="m-color-grey details-section-status" translate>Processing</span>\n            <span ng-if="$ctrl.isPaid()" class="m-color-green details-section-status" translate>Paid</span>\n            <span ng-if="$ctrl.isFailed()" class="m-color-red details-section-status" translate>Failed</span>\n        </p>\n\n        <div ng-if="$ctrl.isProcessing()">\n            <div ng-if="!$ctrl.isRanOutOfTime()" class="details-section-spinner m-spinner"></div>\n            <p ng-if="!$ctrl.isRanOutOfTime()" class="m-hint">\n                <translate>\n                    We are waiting for payment confirmation.\n                </translate>\n                <span ng-if="$ctrl.isBlik()" translate>\n                    Remember to confirm your payment with mobile app.\n                </span>\n            </p>\n            <p ng-if="$ctrl.isRanOutOfTime()" class="m-hint">\n                <translate>We are waiting for your payment. You can check its status at</translate>\n                <a ng-href="{{$ctrl.myOrdersUrl}}" class="m-link m-link--non-visited details-section-hint-link" target="_self" translate>My orders</a>.\n            </p>\n        </div>\n\n        <div ng-if="$ctrl.isFailed()">\n            <p class="m-hint" translate>Click button below, to check payment\'s status and retry payment.</p>\n            <a ng-href="{{$ctrl.myOrdersUrl}}" class="details-section-button m-button m-button--primary" target="_self" translate>Retry payment</a>\n        </div>\n    </div>\n</section>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PaymentCycleCtrl(e,t,r,n,o,i){"ngInject";var a=this;this.CONFIGURATION=e,this.ConfigurationSvc=n,this.ThankYouSvc=o,this.$interval=i,this.ranOutOfTime=!1,this.intervalTime=5e3,this.intervalRepetition=6,this.paymentsCycles={paid:["PAID","OVERPAID","UNDERPAID"],processing:["CREATED","IN_PROGRESS","WAITING_FOR_MONEY"],failed:["CANCELLED","ERROR"],external:["EXTERNAL_PAYMENT"]},this.myOrdersUrl=this.CONFIGURATION.URLS[this.ConfigurationSvc.getLocale().country].bought,this.checkPaymentStatus(),t.$on("paymentCycle:restart",function(){a.checkPaymentStatus(),r.$apply()})}return PaymentCycleCtrl.$inject=["CONFIGURATION","$rootScope","$scope","ConfigurationSvc","ThankYouSvc","$interval"],PaymentCycleCtrl.prototype.checkPaymentStatus=function(){var e=this;this.isProcessing()&&!this.isProviderOffline&&(this.ranOutOfTime=!1,this.cycleStatusInterval&&this.$interval.cancel(this.cycleStatusInterval),this.cycleStatusInterval=this.$interval(function(){return e.fetchCycleStatus()},this.intervalTime,this.intervalRepetition),this.cycleStatusInterval.then(function(){return e.ranOutOfTime=!0},function(){},function(){return!e.isProcessing()&&e.$interval.cancel(e.cycleStatusInterval)}))},PaymentCycleCtrl.prototype.fetchCycleStatus=function(){var e=this;return this.ThankYouSvc.checkPaymentStatus().then(function(t){return t&&(e.cycle=t)})},PaymentCycleCtrl.prototype.isFailed=function(){var e=this;return this.paymentsCycles.failed.some(function(t){return t===e.cycle})},PaymentCycleCtrl.prototype.isProcessing=function(){var e=this;return this.paymentsCycles.processing.some(function(t){return t===e.cycle})},PaymentCycleCtrl.prototype.isPaid=function(){var e=this;return this.paymentsCycles.paid.some(function(t){return t===e.cycle})},PaymentCycleCtrl.prototype.isExternal=function(){return this.isProviderOffline},PaymentCycleCtrl.prototype.isBlik=function(){return this.isBlikMethod},PaymentCycleCtrl.prototype.isRanOutOfTime=function(){return this.ranOutOfTime},PaymentCycleCtrl}();t.PaymentCycleCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ThankYouCtrl(e,t,r,n,o,i,a,s,c){"ngInject";this.offersCount=null,this.sellersCount=null,this.getPurchaseFailReason=null,this.getPurchaseFailed=!1,this.isThankYouLoaded=!1,this.purchaseDfpConfig=null,this.isRegistrationEligible=!1,this.isGuestFlow=!1,this.purchaseGtmSvc=n,this.purchaseNgaSvc=o,this.purchaseDfpSvc=i,this.purchaseConstants=a,this.$state=e,this.thankYouSvc=s,this.complementaryItemsSvc=c,this.isThankYouInErrorState=e.includes("thankYou.error"),this.isAnnouncement=e.includes("thankYou.announcement"),this.isThemeMetrumize=t.isThemeMetrumize(),this.isGuestFlow=t.isGuest(e),this.hostUrl="//"+t.getHost(),this.analyticsConfigPromise=r.getConfig(),this.initializeAnalytics(),this.getThankYouData(),this.checkRegistrationEligible()}return ThankYouCtrl.$inject=["$state","ConfigurationSvc","AnalyticsCfgSvc","PurchaseGtmSvc","PurchaseNgaSvc","PurchaseDfpSvc","PURCHASE_CONSTANTS","ThankYouSvc","ComplementaryItemsSvc"],ThankYouCtrl.prototype.getThankYouData=function(){var e=this;this.thankYouSvc.prepareThankYouData().then(function(t){return e.consumeThankYouData(t)},function(t){e.setPurchaseFailReason(t),e.getPurchaseFailed=!0}).finally(function(){e.isThankYouLoaded=!0,e.purchaseNgaSvc.sendPageView(e.purchaseConstants.NGA_STATE_TAG.THANK_YOU,e.processEntry,null,null,!e.isGuestFlow,e.purchaseFlags)})},ThankYouCtrl.prototype.consumeThankYouData=function(e){var t=e.purchase,r=e.paymentId,n=e.isBlikSelectedMethod,o=e.isProviderOffline,i=e.offersCount,a=e.processEntry,s=e.sellersCount,c=e.paymentStatus;this.purchaseGtmSvc.publishThankYouEntry(t),this.complementaryItemsSvc.init(t),this.paymentId=r,this.offersCount=i,this.sellersCount=s,this.processEntry=a,this.purchaseFlags=t&&t.metadata&&t.metadata.flags||[],this.isBlikSelectedMethod=n,this.isProviderOffline=o,this.paymentStatus=c,this.prepareAdsConfig(e.purchase),this.redirectToCorrectState()},ThankYouCtrl.prototype.redirectToCorrectState=function(){this.$state.is("thankYou")&&(this.isBlikSelectedMethod?this.$state.go(".blik",{location:"replace"}):this.$state.go(".success",{location:"replace"}))},ThankYouCtrl.prototype.prepareAdsConfig=function(e){var t=this;this.analyticsConfigPromise.then(function(r){r.dfp.targeting=t.purchaseDfpSvc.getDfpTargeting(e),t.purchaseDfpConfig=r.dfp})},ThankYouCtrl.prototype.initializeAnalytics=function(){var e=this;this.analyticsConfigPromise.then(function(t){e.purchaseGtmSvc.initialize(t.gtm),e.purchaseNgaSvc.initialize(t.nga)})},ThankYouCtrl.prototype.setPurchaseFailReason=function(e){e.data&&Array.isArray(e.data.errors)&&e.data.errors[0]&&(this.getPurchaseFailReason={statusCode:e.status,userMessage:e.data.errors[0].userMessage,traceId:"function"==typeof e.headers?e.headers("Trace-Id"):""})},ThankYouCtrl.prototype.checkRegistrationEligible=function(){var e=this;this.isGuestFlow&&this.thankYouSvc.checkRegistrationEligible().then(function(t){return e.isRegistrationEligible=t})},ThankYouCtrl.prototype.shouldDisplayPrimeBanner=function(){return"true"===localStorage.getItem("showJoinFreebox")},ThankYouCtrl}();t.ThankYouCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ThankYouSvc(e,t,r,n,o,i){"ngInject";this.PurchaseSvc=e,this.BlikService=t,this.PurchaseSummationSvc=r,this.ConfigurationSvc=n,this.$http=o,this.PURCHASE_CONSTANTS=i,this.blikMethod="BLIK",this.offlineProvider="OFFLINE"}return ThankYouSvc.$inject=["PurchaseSvc","BlikService","PurchaseSummationSvc","ConfigurationSvc","$http","PURCHASE_CONSTANTS"],ThankYouSvc.prototype.prepareThankYouData=function(){var e=this;return this.PurchaseSvc.getPurchaseV2(this.PurchaseSvc.getId()).then(function(t){return e.consumePurchase(t)})},ThankYouSvc.prototype.consumePurchase=function(e){var t=this,r=this.prepareDataFromPurchase(e);return this.paymentId=r.paymentId,this.BlikService.fetchPaymentsData(r.paymentId,this.ConfigurationSvc.getApiUrl()).then(function(e){return r.isBlikSelectedMethod=e.selectedMethods[0].group===t.blikMethod,r.isProviderOffline=e.provider===t.offlineProvider,r}).catch(function(){return r})},ThankYouSvc.prototype.prepareDataFromPurchase=function(e){var t=this.PurchaseSummationSvc.getTotalsByStatus(e.orders)[this.PURCHASE_CONSTANTS.PURCHASE_STATUS.BOUGHT];return{purchase:e,paymentId:e.payment&&e.payment.id?e.payment.id:null,isBlikSelectedMethod:!1,isProviderOffline:!1,processEntry:e.metadata&&e.metadata.processEntry?e.metadata.processEntry:null,offersCount:t?t.offersCount:0,sellersCount:this.PurchaseSummationSvc.getSellersCountWithBoughtStatus(e.orders),paymentStatus:e.payment&&e.payment.status?e.payment.status:null}},ThankYouSvc.prototype.checkPaymentStatus=function(){return this.BlikService.fetchPaymentsData(this.paymentId,this.ConfigurationSvc.getApiUrl()).then(function(e){return e.status})},ThankYouSvc.prototype.checkRegistrationEligible=function(){var e=this.ConfigurationSvc.getApiUrl()+"/guest/registration/eligible";return this.$http.get(e,{headers:{Accept:this.ConfigurationSvc.getV1Header()}}).then(function(e){return e.data.eligible}).catch(function(){return!1})},ThankYouSvc}();t.ThankYouSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ComplementaryItemsComponent(){this.transclude=!0,this.template=r(144),this.controller="complementaryItemsCtrl"}return ComplementaryItemsComponent}();t.ComplementaryItemsComponent=n},function(e,t){e.exports='<section id="complementary-items-section" class="complementary-items-section">\n    <div ng-show="$ctrl.sellerId && $ctrl.offerId">\n        <div class="seller-details"\n             id="seller-details"\n             data-cart="enabled"\n             data-sellerid="{{$ctrl.sellerId}}"\n             data-itemid="{{$ctrl.offerId}}"\n        >\n        </div>\n        <div ng-transclude></div>\n    </div>\n</section>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ComplementaryItemsSvc(e,t){"ngInject";this.initialized=!1,this.offerId="",this.sellerId="",this.initialized=!1,this.$timeout=e,this.$window=t}return ComplementaryItemsSvc.$inject=["$timeout","$window"],ComplementaryItemsSvc.prototype.init=function(e){this.isSingleItemPurchase(e)&&(this.offerId=e.orders[0].offers[0].id,this.sellerId=e.orders[0].seller.id),this.initialized=!0},ComplementaryItemsSvc.prototype.isInitialized=function(){return this.initialized},ComplementaryItemsSvc.prototype.publishEventToCarouselService=function(){var e=this;this.cookieMonsterFallback();var t=new CustomEvent("complementary-data-set",{bubbles:!0,cancelable:!0});this.$timeout(function(){e.$window.dispatchEvent(t)})},ComplementaryItemsSvc.prototype.getOfferId=function(){return this.offerId},ComplementaryItemsSvc.prototype.getSellerId=function(){return this.sellerId},ComplementaryItemsSvc.prototype.cookieMonsterFallback=function(){var e=this;"function"==typeof this.$window.cm&&(this.$window.cm.event=function(t,r){void 0===r&&(r=function(){}),e.$window.cm("send","event",t.cat,t.a,t.lab,t.v,{customParams:r()})})},ComplementaryItemsSvc.prototype.isSingleItemPurchase=function(e){return e&&1===e.orders.length&&1===e.orders[0].offers.length},ComplementaryItemsSvc}();t.ComplementaryItemsSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ComplementaryItemsController(e,t){"ngInject";this.complementaryItemsSvc=t,this.initialize(e)}return ComplementaryItemsController.$inject=["$scope","ComplementaryItemsSvc"],ComplementaryItemsController.prototype.initialize=function(e){var t=this;e.$watch(function(){return t.complementaryItemsSvc.isInitialized()},function(){t.updateComplementaryData()},!0)},ComplementaryItemsController.prototype.updateComplementaryData=function(){this.offerId=this.complementaryItemsSvc.getOfferId(),this.sellerId=this.complementaryItemsSvc.getSellerId(),this.offerId&&this.sellerId&&this.complementaryItemsSvc.publishEventToCarouselService()},ComplementaryItemsController}();t.ComplementaryItemsController=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PrimeBannerComponent(){this.template=r(148),this.controller="PrimeBannerCtrl"}return PrimeBannerComponent}();t.PrimeBannerComponent=n},function(e,t){e.exports='<article class="alert alert-success promo-message" ng-if="$ctrl.showPrimeBanner">\n    <h2>\n        <translate ng-if="$ctrl.primeSubscriptionSuccess">Welcome to Freebox!</translate>\n        <translate ng-if="$ctrl.primeSubscriptionError">An error occured</translate>\n        <translate ng-if="!$ctrl.subscribeFinished()">Join Freebox</translate>\n    </h2>\n    <p ng-if="!$ctrl.subscribeFinished()">\n        <translate>Your delivery could be free, if you join Freebox.</translate>\n    </p>\n    <div class="m-display-flex m-flex-justify-end m-flex-items-center" ng-if="!$ctrl.subscribeFinished()">\n        <button class="m-button m-button--secondary" ng-click="$ctrl.subscribeToPrime()" ng-disabled="$ctrl.isSubscribeInProgress">\n            <translate>Join Freebox</translate>\n        </button>\n    </div>\n</article>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PrimeUserSvc(e,t){"ngInject";this.$http=e,this.ConfigurationSvc=t,this.NO_SUBSCRIPTION_CODE="NO_SUBSCRIPTION"}return PrimeUserSvc.$inject=["$http","ConfigurationSvc"],PrimeUserSvc.prototype.shouldShowPrimeBanner=function(){var e=this;return this.getUserPrimeSubscription().then(function(){return!1}).catch(function(t){return 404===t.status&&t.data.errorCode===e.NO_SUBSCRIPTION_CODE})},PrimeUserSvc.prototype.getUserPrimeSubscription=function(){return this.$http.get(this.ConfigurationSvc.getApiUrl()+"/user/subscription").then(function(e){return e.data})},PrimeUserSvc.prototype.subscribeToPrime=function(e){return this.$http.post(this.ConfigurationSvc.getApiUrl()+"/user/subscription",{planType:e}).then(function(e){return e.data})},PrimeUserSvc}();t.PrimeUserSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PrimeBannerCtrl(e,t){"ngInject";this.CONFIGURATION=e,this.primeUserSvc=t,this.PRIME_TYPE_BASIC="BASIC",this.primeSubscriptionSuccess=!1,this.primeSubscriptionError=!1,this.showPrimeBanner=!1,this.isSubscribeInProgress=!1}return PrimeBannerCtrl.$inject=["CONFIGURATION","primeUserSvc"],PrimeBannerCtrl.prototype.$onInit=function(){var e=this;this.primeUserSvc.shouldShowPrimeBanner().then(function(t){return e.showPrimeBanner=t})},PrimeBannerCtrl.prototype.subscribeToPrime=function(){var e=this;this.isSubscribeInProgress=!0,this.primeUserSvc.subscribeToPrime(this.PRIME_TYPE_BASIC).then(function(){return e.primeSubscriptionSuccess=!0}).catch(function(){return e.primeSubscriptionError=!0}).finally(function(){return e.isSubscribeInProgress=!1})},PrimeBannerCtrl.prototype.subscribeFinished=function(){return this.primeSubscriptionSuccess||this.primeSubscriptionError},PrimeBannerCtrl}();t.PrimeBannerCtrl=n},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(152);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(153),a=r(155),s=r(157),c=r(158),l=r(159),u=r(160),d=r(161),p=r(162),f=r(11),h=_interopRequireDefault(f),m=r(163),v=_interopRequireDefault(m),y=r(3),g=_interopRequireDefault(y),S=r(2),C=_interopRequireDefault(S),P=r(13),b=_interopRequireDefault(P),O=r(15),D=_interopRequireDefault(O),_=r(4),$=_interopRequireDefault(_),E=r(17),I=_interopRequireDefault(E),A=r(1),k=_interopRequireDefault(A),R=r(177),M=r(179),w=o.module("purchase.preBuyNow",[h.default.name,"paymentsMethods",$.default.name,b.default.name,"offerQuantity",D.default.name,C.default.name,g.default.name,I.default.name,k.default.name,v.default.name]).component("displayDeliveryMethods",new i.DisplayDeliveryMethodsComponent).component("rebateStopper",new a.RebateStopperComponent).component("rebateInfo",new R.RebateInfoComponent).controller("DisplayDeliveryMethodsCtrl",s.DisplayDeliveryMethodsComponentController).controller("PreBuyNowCtrl",c.PreBuyNowCtrl).controller("RebateStopperCtrl",l.RebateStopperController).controller("RebateInfoCtrl",M.RebateInfoController).service("DisplayDeliveryMethodsSvc",u.DisplayDeliveryMethodsSvc).service("rebateExperimentSvc",p.RebateExperimentSvc).service("RebateStopperSvc",d.RebateStopperSvc);t.default=w},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Add more":"Dodaj jeszcze","Click here":"Kliknij tutaj","Do you have a discount?":"Masz kupon?","back to item page":"wróć do strony przedmiotu","cheapest delivery from":"najtańsza dostawa od","foreign delivery":"wysyłka za granicę","hide delivery methods":"zwiń opcje dostawy","payment in advance":"Płatność z góry","payment on delivery":"Płatność przy odbiorze","show delivery methods":"wszystkie opcje dostawy","to choose order details and use discount":"aby wybrać szczegóły zamówienia oraz wykorzystać kupon","to take advantage of the promotion:":", aby skorzystać z promocji:"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DisplayDeliveryMethodsComponent(){this.bindings={seller:"<",offer:"<",onDeliveryCheapestPrice:"&"},this.controller="DisplayDeliveryMethodsCtrl",this.template=r(154)}return DisplayDeliveryMethodsComponent}();t.DisplayDeliveryMethodsComponent=n},function(e,t){e.exports='<aside class="item-delivery" ng-if="$ctrl.deliveryCosts && $ctrl.deliveryCosts.cheapest">\n    <span translate>cheapest delivery from</span>\n    <a ng-href="/listing/user/listing.php?us_id={{::$ctrl.seller.id}}" target="_self" nga-action="ShowSellerPage" nga-label="user">{{::$ctrl.seller.login}}</a>\n    <strong>{{::$ctrl.deliveryCosts.cheapest.price.amount | currency}}</strong>\n</aside>\n<aside class="item-delivery" ng-if="$ctrl.deliveryCosts">\n    <div class="text-right">\n        <button id="open-delivery-layer-btn" class="btn btn-link" type="button" ng-click="openFullDeliveryLayer = !openFullDeliveryLayer; $ctrl.onDeliveryOptionsClicked()">\n            <span ng-hide="openFullDeliveryLayer" translate>show delivery methods</span>\n            <span ng-show="openFullDeliveryLayer" translate>hide delivery methods</span>\n            <i class="icon-v" ng-class="{\'active\': openFullDeliveryLayer}"></i>\n        </button>\n    </div>\n    <section class="delivery-section" ng-show="openFullDeliveryLayer">\n        <div id="delivery-section-prepaid" ng-if="::$ctrl.deliveryCosts.prepaid.length">\n            <p><strong translate>payment in advance</strong></p>\n            <ul class="delivery-list table">\n                <li class="table-row" ng-repeat="prepaid in ::$ctrl.deliveryCosts.prepaid track by prepaid.method.id">\n                    <span class="table-cell">{{::prepaid.method.name}}</span>\n                    <span class="delivery-cost table-cell">{{::prepaid.price.amount | currency}}</span>\n                </li>\n            </ul>\n        </div>\n        <div id="delivery-section-postpaid" ng-if="::$ctrl.deliveryCosts.postpaid.length">\n            <p><strong translate>payment on delivery</strong></p>\n            <ul class="delivery-list table">\n                <li class="table-row" ng-repeat="postpaid in ::$ctrl.deliveryCosts.postpaid track by postpaid.method.id">\n                    <span class="table-cell">{{::postpaid.method.name}}</span>\n                    <span class="delivery-cost table-cell">{{::postpaid.price.amount | currency}}</span>\n                </li>\n            </ul>\n        </div>\n        <div id="delivery-section-foreign" ng-if="::$ctrl.deliveryCosts.foreign.length">\n            <p><strong translate>foreign delivery</strong></p>\n            <ul class="delivery-list table">\n                <li class="table-row" ng-repeat="foreign in ::$ctrl.deliveryCosts.foreign track by foreign.method.id">\n                    <span class="table-cell">{{::foreign.method.name}}</span>\n                    <span class="delivery-cost table-cell">{{::foreign.price.amount | currency}}</span>\n                </li>\n            </ul>\n        </div>\n    </section>\n</aside>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RebateStopperComponent(){this.bindings={purchaseId:"<"},this.controller="RebateStopperCtrl",this.template=r(156)}return RebateStopperComponent}();t.RebateStopperComponent=n},function(e,t){e.exports='<section class="rebate-stopper" ng-if="$ctrl.displayStopper">\n    <div>\n        <i class="icon-svg-md coupons-default"></i>\n        <h4 translate>Do you have a discount?</h4>\n    </div>\n    <div>\n        <p class="didascalia-color">\n            <a ui-sref="purchase.dapf" translate>Click here</a>,\n            <translate>to choose order details and use discount</translate>\n        </p>\n    </div>\n</section>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DisplayDeliveryMethodsComponentController(e,t){"ngInject";this.DisplayDeliveryMethodsSvc=e,this.PurchaseNgaSvc=t,this.deliveryCosts=null,this.hasDeliveryOptionsBeenClicked=!1}return DisplayDeliveryMethodsComponentController.$inject=["DisplayDeliveryMethodsSvc","PurchaseNgaSvc"],DisplayDeliveryMethodsComponentController.prototype.$onInit=function(){var e=this;this.DisplayDeliveryMethodsSvc.getDeliveryCosts(this.seller.id,this.offer).then(function(t){e.deliveryCosts=t,e.onDeliveryCheapestPrice({deliveryCheapestPrice:e.deliveryCosts.cheapest.price})}).catch(function(){})},DisplayDeliveryMethodsComponentController.prototype.onDeliveryOptionsClicked=function(){this.hasDeliveryOptionsBeenClicked||(this.PurchaseNgaSvc.publishDeliveryOptionsClicked(),this.hasDeliveryOptionsBeenClicked=!0)},DisplayDeliveryMethodsComponentController}();t.DisplayDeliveryMethodsComponentController=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreBuyNowCtrl=void 0;var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=function(){function PreBuyNowCtrl(e,t,r,n,o,i,a,s,c,l,u,d,p,f){"ngInject";this.rebateExperimentSvc=p,this.purchaseTradeDoublerSvc=f,this.hasRelatedOrders=!1,this.isUpdateInProgress=!1,this.isRebateInfoHidden=!0,this.isTradeDoublerEnabled=!1,this.$state=t,this.$q=r,this.$timeout=n,this.purchaseSvc=o,this.modalSvc=a,this.purchaseCtrl=e.purchase,this.checkAndSetRebateInfoHidden(this.purchaseCtrl.data.orders[0].offers[0]),this.isAnnouncement=this.purchaseCtrl.data.orders[0].offers[0].features.announcement,this.isOrderWithPayU=Array.isArray(this.purchaseCtrl.data.orders[0].features)&&this.purchaseCtrl.data.orders[0].features.some(function(e){return"PAYU"===e}),this.purchaseNgaSvc=s,this.relatedSvc=l,this.$window=u,this.confirmBuySvc=i,this.additionalServicesSvc=d,this.redirectToDapfIfUserHasToFillData(),this.isRelatedOrdersEnabled()&&this.fetchRelatedOrders(),this.purchaseNgaSvc.sendPageView(c.NGA_STATE_TAG.PRE_BUY_NOW,this.purchaseCtrl.processEntry,this.purchaseCtrl.isCartProcess,null,!this.purchaseCtrl.isGuest,this.purchaseCtrl.flags),this.setWatchers(e)}return PreBuyNowCtrl.$inject=["$scope","$state","$q","$timeout","PurchaseSvc","confirmBuySvc","ModalSvc","PurchaseNgaSvc","PURCHASE_CONSTANTS","RelatedSvc","$window","AdditionalServicesSvc","rebateExperimentSvc","purchaseTradeDoublerSvc"],PreBuyNowCtrl.prototype.checkAndSetRebateInfoHidden=function(e){var t=this;e.options&&e.options.rebates&&e.options.rebates.multipack&&(e.options.rebates.multipack.requiredQuantity>e.quantity?this.rebateExperimentSvc.getExperimentData().then(function(e){return t.isRebateInfoHidden="hide"===e.variantName}).catch(function(){return t.isRebateInfoHidden=!1}):this.isRebateInfoHidden=!1)},PreBuyNowCtrl.prototype.onSuccess=function(){var e=this;return function(){return e.purchaseCtrl.isCartProcess=!1,e.isAnnouncement?e.$window.location.href=e.$state.href("thankYou.announcement",e.$state.params,{absolute:!1}):(e.purchaseNgaSvc.publishPostBuyNow(e.purchaseCtrl.data,e.hasRelatedOrders),e.hasRelatedOrders?e.$state.go("purchase.related"):e.$state.go("purchase.dapf")),e.$q.when()}},PreBuyNowCtrl.prototype.onBuyCommandError=function(e){this.purchaseNgaSvc.onBuyNowBuyCommandError(),this.modalSvc.showErrorReason({andamioError:e})},PreBuyNowCtrl.prototype.onInstallmentSuccess=function(){this.purchaseCtrl.isCartProcess=!1,this.$state.go("purchase.dapf")},PreBuyNowCtrl.prototype.fetchRelatedOrders=function(){var e=this;this.relatedSvc.getRelatedOrders(this.purchaseCtrl.data).then(function(t){return e.hasRelatedOrders=t.hasRelatedOrders})},PreBuyNowCtrl.prototype.isRelatedOrdersEnabled=function(){return this.isOrderWithPayU},PreBuyNowCtrl.prototype.redirectToDapfIfUserHasToFillData=function(){this.purchaseCtrl.hasAccountAddress||this.$state.go("purchase.dapf")},PreBuyNowCtrl.prototype.shouldShowAdditionalServices=function(){return this.additionalServicesSvc.isAnyAdditionalServiceOptionAvailable(this.purchaseCtrl.data.orders[0].offers[0])},PreBuyNowCtrl.prototype.isPurchaseEditable=function(){return"DRAFT"==this.purchaseCtrl.data.status},PreBuyNowCtrl.prototype.enableTradeDoubler=function(){this.isPurchaseEditable()&&(this.isTradeDoublerEnabled=!0,this.tradeDoublerData=this.purchaseTradeDoublerSvc.getTradeDoublerData(this.purchaseCtrl.data))},PreBuyNowCtrl.prototype.setWatchers=function(e){var t=this;if(this.shouldShowAdditionalServices()){var r=function(e,r){e!==r&&t.$timeout(0).then(function(){return t.updatePurchase(t.purchaseCtrl.data)})};this.purchaseCtrl.data.orders.forEach(function(t){t.offers.forEach(function(t){e.$watch(function(){return t.additionalServices},r,!0)})})}},PreBuyNowCtrl.prototype.updatePurchase=function(e){var t=this;this.isUpdateInProgress=!0;var r=o.copy(e);r.orders.forEach(function(e){e.delivery&&e.delivery.address&&delete e.delivery.address.id,e.invoice&&e.invoice.address&&delete e.invoice.address.id}),this.purchaseSvc.updatePurchase(r.id,r).then(function(t){return e.orders[0].options.deliveryMethods=t.orders[0].options.deliveryMethods}).finally(function(){return t.isUpdateInProgress=!1})},PreBuyNowCtrl}();t.PreBuyNowCtrl=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RebateStopperController(e,t){"ngInject";var r=this;this.displayStopper=!1,this.$state=t,e.checkRebateAvailability(this.purchaseId).then(function(e){r.displayStopper=e}).catch(function(){})}return RebateStopperController.$inject=["RebateStopperSvc","$state"],RebateStopperController}();t.RebateStopperController=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DisplayDeliveryMethodsSvc(e,t,r,n,o,i){"ngInject";this.$http=t,this.$q=e,this.configurationSvc=r,this.$exceptionHandler=n,this.CustomException=o,this.purchaseConstants=i}return DisplayDeliveryMethodsSvc.$inject=["$q","$http","ConfigurationSvc","$exceptionHandler","CustomException","PURCHASE_CONSTANTS"],DisplayDeliveryMethodsSvc.prototype.getDeliveryCosts=function(e,t){var r=this,n=this.configurationSvc.getApiUrl()+"/offers/"+t.id+"/delivery-costs",o={sellerId:e,quantity:t.quantity,price:t.price.amount,countryCode:this.configurationSvc.getLocale().country};return this.$http.get(n,{params:o}).then(function(e){return{prepaid:r.getPrePaidCosts(e.data.deliveryCosts),postpaid:r.getPostPaidCosts(e.data.deliveryCosts),foreign:[],cheapest:r.getCheapestCost(e.data.deliveryCosts)}},function(e){var t=new r.CustomException({name:"GetDeliveryCostsException",message:"Failed to get delivery costs",error:e});return r.$exceptionHandler(t),r.$q.reject(e)})},DisplayDeliveryMethodsSvc.prototype.getPrePaidCosts=function(e){return this.getCostsByPaymentType(e,this.purchaseConstants.DELIVERY.PAYMENT.PREPAID)},DisplayDeliveryMethodsSvc.prototype.getPostPaidCosts=function(e){return this.getCostsByPaymentType(e,this.purchaseConstants.DELIVERY.PAYMENT.POSTPAID)},DisplayDeliveryMethodsSvc.prototype.getCostsByPaymentType=function(e,t){return e.filter(function(e){return e.paymentType===t})},DisplayDeliveryMethodsSvc.prototype.getCheapestCost=function(e){var t=null;return e.some(function(e){if(e.cheapestMethod)return t=e,!0}),t},DisplayDeliveryMethodsSvc}();t.DisplayDeliveryMethodsSvc=n;var o=function(){function IDeliveryCostsCollection(){}return IDeliveryCostsCollection}();t.IDeliveryCostsCollection=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RebateStopperSvc(e,t,r,n,o){"ngInject";this.$http=t,this.$q=e,this.configurationSvc=r,this.$exceptionHandler=n,this.CustomException=o}return RebateStopperSvc.$inject=["$q","$http","ConfigurationSvc","$exceptionHandler","CustomException"],RebateStopperSvc.prototype.checkRebateAvailability=function(e){var t=this,r={method:"GET",url:this.configurationSvc.getApiUrl()+"/rebates/"+e+"/info",headers:this.requestHeaders()};return this.$http(r).then(function(e){return e.data.userHasRebates},function(e){var r=new t.CustomException({name:"RebateStopperException",message:"Failed to get data about user rebates",error:e});return t.$exceptionHandler(r),t.$q.reject(e)})},RebateStopperSvc.prototype.requestHeaders=function(){return{Accept:"application/vnd.allegro.public.v1+json"}},RebateStopperSvc}();t.RebateStopperSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RebateExperimentSvc(e,t,r,n){"ngInject";this.$q=e,this.$http=t,this.$exceptionHandler=r,this.CustomException=n}return RebateExperimentSvc.$inject=["$q","$http","$exceptionHandler","CustomException"],RebateExperimentSvc.prototype.getExperimentData=function(){var e=this;return this.$http.get("/transaction-front/experiment/rebates-incentive").then(function(e){return e.data},function(t){var r=new e.CustomException({name:"RebateExperimentSvcException",message:"Failed to fetch experiment data",error:t});return e.$exceptionHandler(r),e.$q.reject(t)})},RebateExperimentSvc}();t.RebateExperimentSvc=n},function(e,t,r){r(164);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);r(5);var i=r(165),a=r(166),s=r(167),c=r(169),l=r(170),u=r(3),d=function(e){return e&&e.__esModule?e:{default:e}}(u),p=o.module("leaselinkButtonModule",[d.default.name]).component("leaselinkButton",new s.LeaselinkButtonComponent).controller("leaselinkButtonCtrl",a.LeaselinkButtonCtrl).component("leaselinkTile",new l.LeaselinkTileComponent).controller("leaselinkTileCtrl",c.LeaselinkTileCtrl).service("leaselinkButtonSvc",i.LeaselinkButtonSvc);t.default=p},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"After choosing this option, we will redirect you to the leasing partner's website.":"Po wyborze tej opcji przekierujemy Cię na stronę partnera oferującego leasing.",Lease:"Weź w leasing","Leasing is available for purchases from 700 to 60,000 PLN. If you want to use a lease, choose another trade.":"Leasing jest dostępny dla zakupów od 700 do 60 000 zł. Jeśli chcesz skorzystać z leasingu, wybierz inny przedmiot.","This option is not available because the selected premise can not be leased.":"Ta opcja jest niedostępna, ponieważ wybranego przedmiotu nie można wziąć w leasing.","You can not take a lease.":"Leasing jest niedostępny."})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function LeaselinkButtonSvc(e){"ngInject";this.$window=e,this.externalId="ALG001",this.taxRate="23",this.isNet=!1}return LeaselinkButtonSvc.$inject=["$window"],LeaselinkButtonSvc.prototype.generateLeaseUrl=function(e){var t=e.id,r=e.price.amount,n=e.quantity,o=e.name,i=e.viewUrl,a=String(Number(r)*n),s=o+" * "+n,c=e.categoryId,l=encodeURIComponent(i);return"https://online.leaselink.pl/RateCalculator/calculate?externalId="+this.externalId+"&value="+a+"&categoryLevel="+c+"&productName="+s+"("+t+")&shopUrl="+l+"&tax="+this.taxRate+"&isNet="+this.isNet},LeaselinkButtonSvc.prototype.takeOnLease=function(e){this.$window.location.href=e},LeaselinkButtonSvc}();t.LeaselinkButtonSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function LeaselinkButtonCtrl(e,t){"ngInject";this.leaselinkButtonSvc=e,this.PurchaseNgaSvc=t}return LeaselinkButtonCtrl.$inject=["leaselinkButtonSvc","PurchaseNgaSvc"],LeaselinkButtonCtrl.prototype.$onInit=function(){var e=this.purchase.orders[0].offers[0];this.offerId=e.id,this.offerPrice=e.price.amount,this.quantity=e.quantity,this.leaselinkUrl=this.leaselinkButtonSvc.generateLeaseUrl(e)},LeaselinkButtonCtrl.prototype.isVisible=function(){return this.isLeasingMode(this.mode)},LeaselinkButtonCtrl.prototype.isDisabled=function(){return!this.leasing.available},LeaselinkButtonCtrl.prototype.takeOnLease=function(){this.leaselinkButtonSvc.takeOnLease(this.leaselinkUrl),this.PurchaseNgaSvc.publishLeaseLinkClick(this.offerId,this.quantity,this.offerPrice)},LeaselinkButtonCtrl.prototype.isLeasingMode=function(e){return"LEASING"===e},LeaselinkButtonCtrl}();t.LeaselinkButtonCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function LeaselinkButtonComponent(){this.bindings={purchase:"<",leasing:"<",mode:"<"},this.controller="leaselinkButtonCtrl",this.template=r(168)}return LeaselinkButtonComponent}();t.LeaselinkButtonComponent=n},function(e,t){e.exports='<div id="leaselinkCalucalteButtonContainer" ng-if="$ctrl.isVisible()" class="lease-link-button-container">\n    <div class="lease-link-align-container">\n        <div class="lease-link-position">\n\n            <leaselink-tile\n                    leasing="$ctrl.leasing"\n                    mode="$ctrl.mode">>\n            </leaselink-tile>\n\n            <a id="lease-link-btn"\n               class="btn btn-link"\n               ng-disabled="$ctrl.isDisabled()"\n               ng-click="$ctrl.takeOnLease()">\n                <translate>Lease</translate>\n            </a>\n        </div>\n    </div>\n</div>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function LeaselinkTileCtrl(e){"ngInject";this.gettextCatalog=e,this.isTileVisible=!0}return LeaselinkTileCtrl.$inject=["gettextCatalog"],LeaselinkTileCtrl.prototype.isVisible=function(){return this.isLeasingMode(this.mode)&&this.isTileVisible},LeaselinkTileCtrl.prototype.hideTile=function(){this.isTileVisible=!1},LeaselinkTileCtrl.prototype.createMessage=function(){return this.isAvailable()?this.gettextCatalog.getString("After choosing this option, we will redirect you to the leasing partner's website."):this.isBadValue()?this.gettextCatalog.getString("Leasing is available for purchases from 700 to 60,000 PLN. If you want to use a lease, choose another trade."):this.isBadOffer()?this.gettextCatalog.getString("This option is not available because the selected premise can not be leased."):this.gettextCatalog.getString("You can not take a lease.")},LeaselinkTileCtrl.prototype.isAvailable=function(){return this.leasing.available},LeaselinkTileCtrl.prototype.isBadValue=function(){return"BAD_CART_VALUE"===this.leasing.rejectionReasons[0].code},LeaselinkTileCtrl.prototype.isBadOffer=function(){return"NON_LEASING_OFFER"===this.leasing.rejectionReasons[0].code},LeaselinkTileCtrl.prototype.isLeasingMode=function(e){return"LEASING"===e},LeaselinkTileCtrl}();t.LeaselinkTileCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function LeaselinkTileComponent(){this.bindings={leasing:"<",mode:"<"},this.controller="leaselinkTileCtrl",this.template=r(171)}return LeaselinkTileComponent}();t.LeaselinkTileComponent=n},function(e,t){e.exports='<div class="popover show lease-message" ng-if="$ctrl.isVisible()">\n    <button ng-click="$ctrl.hideTile()" type="button" class="btn-close lease-message-close"\n            data-dismiss="alert" aria-hidden="true">\n    </button>\n\n    <div class="popover-content">\n        <p>\n            {{$ctrl.createMessage()}}\n        </p>\n    </div>\n</div>'},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"additional services":"Usługi dodatkowe",newness:"nowość"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function AdditionalServicesComponentController(){}return AdditionalServicesComponentController.prototype.toAdditionalService=function(e){return{definitionId:e.id,name:e.name,unitPrice:{amount:this.getServicePrice(e),currency:this.getServiceCurrency(e)},quantity:this.offer.quantity}},AdditionalServicesComponentController.prototype.isServiceSelected=function(e){return!!this.offer.additionalServices&&this.offer.additionalServices.some(function(t){return t.definitionId===e})},AdditionalServicesComponentController.prototype.getServicePrice=function(e){return e.configurations.filter(function(e){return e.available}).map(function(e){return e.price.amount}).sort(function(e,t){return parseFloat(t)-parseFloat(e)}).pop()||null},AdditionalServicesComponentController.prototype.getTotalServicePrice=function(e){return e.available&&this.offer.quantity?parseFloat(this.getServicePrice(e))*this.offer.quantity:null},AdditionalServicesComponentController.prototype.getServiceCurrency=function(e){return e.configurations.filter(function(e){return e.available}).map(function(e){return e.price.currency}).pop()||null},AdditionalServicesComponentController.prototype.getTotalServicePriceSummary=function(e){return parseFloat(e.unitPrice.amount)*e.quantity},AdditionalServicesComponentController}();t.AdditionalServicesComponentController=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function AdditionalServicesSvc(){}return AdditionalServicesSvc.prototype.isAnyAdditionalServiceOptionAvailable=function(e){return((e.options||{additionalServices:[]}).additionalServices||[]).some(function(e){return e.configurations.some(function(e){return!0===e.available})})},AdditionalServicesSvc}();t.AdditionalServicesSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function AdditionalServicesComponent(){this.bindings={readOnly:"<",offer:"<",disabled:"<"},this.controller="AdditionalServicesCtrl",this.template=r(176)}return AdditionalServicesComponent}();t.AdditionalServicesComponent=n},function(e,t){e.exports='<div ng-if="::!$ctrl.readOnly">\n    <section class="additional-services">\n        <header>\n            <translate>additional services</translate>\n            <i class="newness" translate>newness</i>\n        </header>\n        <ul class="table items-list">\n            <li class="item table-row"\n                ng-if="::additionalService.available"\n                ng-repeat="additionalService in $ctrl.offer.options.additionalServices track by additionalService.id">\n                <div class="item-addons-name">\n                    <input type="checkbox"\n                           id="item-addons-selected-{{::additionalService.id}}-{{::$ctrl.offer.id}}"\n                           data-checklist-model="$ctrl.offer.additionalServices"\n                           data-checklist-value="::$ctrl.toAdditionalService(additionalService)"\n                           ng-disabled="$ctrl.disabled">\n                    <label ng-class="{\'disabled\':$ctrl.disabled}" for="item-addons-selected-{{::additionalService.id}}-{{::$ctrl.offer.id}}">{{additionalService.name}}</label>\n                </div>\n                <div class="item-addons-price">\n                    <div class="total">\n                        <span ng-class="{\'active\': $ctrl.isServiceSelected(additionalService.id)}">\n                            <formatted-price\n                                    amount="::$ctrl.getTotalServicePrice(additionalService)"\n                                    currency="::$ctrl.getServiceCurrency(additionalService)"\n                                    target-currency="::$ctrl.locale.currency"\n                                    conversion-rates="::$ctrl.service.currencyConversionRates"\n                            ></formatted-price>\n                        </span>\n                    </div>\n                </div>\n                <div class="table-cell item-addons-price-per-item" ng-if="::($ctrl.offer.quantity > 1)">\n                    <div class="per-item">\n                        <per-piece quantity-type="::$ctrl.offer.quantityType"></per-piece>\n                        <formatted-price amount="::$ctrl.getServicePrice(additionalService)"\n                                         currency="::additionalService.unitPrice.currency"\n                                         target-currency="::$ctrl.locale.currency"\n                                         conversion-rates="::$ctrl.service.currencyConversionRates"\n                        ></formatted-price>\n                    </div>\n                </div>\n            </li>\n        </ul>\n    </section>\n</div>\n<div ng-if="::$ctrl.readOnly">\n    <ul class="item-additional-services-list">\n        <li ng-repeat="additionalService in $ctrl.offer.additionalServices track by additionalService.definitionId">\n            <span class="item-name">{{additionalService.name}}</span>\n            <span class="price-small hide-price active">\n                <formatted-price amount="::$ctrl.getTotalServicePriceSummary(additionalService)"\n                                 currency="::additionalService.unitPrice.currency"\n                                 target-currency="::$ctrl.locale.currency"\n                                 conversion-rates="::$ctrl.service.currencyConversionRates"\n                ></formatted-price>\n            </span>\n        </li>\n    </ul>\n</div>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RebateInfoComponent(){this.bindings={label:"<",quantity:"<",requiredQuantity:"<",offerType:"<"},this.controller="RebateInfoCtrl",this.template=r(178)}return RebateInfoComponent}();t.RebateInfoComponent=n},function(e,t){e.exports='<div class="rebate-info">\n    <span ng-if="$ctrl.shouldShowIncentive"><translate>Add more</translate> <accusative-quantity\n            quantity="$ctrl.missingQuantity"\n            quantity-type="$ctrl.offerType"></accusative-quantity><translate>to take advantage of the promotion:</translate></span>\n    <span class="rebate-info-label">\n        <span class="rebate-info-badge">{{ $ctrl.label.badge }}</span>{{ $ctrl.label.message }}\n    </span>\n</div>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function RebateInfoController(){}return RebateInfoController.prototype.$onInit=function(){this.shouldShowIncentive=this.quantity<this.requiredQuantity,this.shouldShowIncentive&&(this.missingQuantity=this.requiredQuantity-this.quantity)},RebateInfoController}();t.RebateInfoController=n},function(e,t,r){r(181);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(182),a=o.module("purchase.alertError",[]).component("alertError",new i.AlertErrorComponent);t.default=a},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Error trace id":"Identyfikator błędu","Please try again.":"Spróbuj ponownie.","Unexpected error has occurred":"Przepraszamy, wystąpił nieoczekiwany błąd"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function AlertErrorComponent(){this.bindings={reason:"<"},this.template=r(183)}return AlertErrorComponent}();t.AlertErrorComponent=n},function(e,t){e.exports='<div class="alert alert-danger" ng-if="::$ctrl.reason">\n    <h4>\n        {{::$ctrl.reason.userMessage}}\n    </h4>\n    <p>\n        <span ng-if="::$ctrl.reason.traceId">\n            <translate>Error trace id</translate>: {{::$ctrl.reason.traceId}}\n        </span>\n        <span>[{{::$ctrl.reason.statusCode}}]</span>\n    </p>\n</div>\n<div class="alert alert-danger" ng-if="::!$ctrl.reason">\n    <h4 translate>Unexpected error has occurred</h4>\n    <p><translate>Please try again.</translate></p>\n</div>\n'},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(185);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(186),a=r(187),s=r(188),c=r(190),l=r(192),u=r(3),d=_interopRequireDefault(u),p=r(4),f=_interopRequireDefault(p),h=r(193),m=_interopRequireDefault(h),v=r(14),y=_interopRequireDefault(v),g=r(17),S=_interopRequireDefault(g),C=r(1),P=_interopRequireDefault(C),b=r(18),O=_interopRequireDefault(b),D=r(226),_=_interopRequireDefault(D),$=o.module("purchase.dapf",["ui.router","addresses","deliveryMethods","paymentsMethods","discountCoupons","customError","offerQuantity","formattedPrice",d.default.name,f.default.name,m.default.name,y.default.name,S.default.name,P.default.name,O.default.name,_.default.name]).controller("DapfCtrl",i.DapfCtrl).controller("DeliveryBundleCtrl",a.DeliveryBundleCtrl).controller("DeliverySectionCtrl",l.DeliverySectionCtrl).directive("deliveryBundle",s.DeliveryBundle.instance).directive("deliverySection",c.DeliverySection.instance);t.default=$},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Go to summary":"Przejdź do podsumowania","Message to Seller":"Wiadomość dla Sprzedającego","You can check all data before making a purchase.":"Będziesz mógł sprawdzić wszystkie dane zanim dokonasz zakupu.","additional services cost":"koszt usług dodatkowych","back to my orders":"przejdź do listy kupionych","back to offer":"wróć do strony oferty","back to your cart":"wróć do Twojego koszyka","back to your guest data":"wróć do Twoich danych","delivery method":"sposób dostawy","delivery method provided by":"dostawa od","item cost":"koszt przedmiotów","payment methods":"metody płatności","shipping address data":"dane odbiorcy przesyłki","shipping cost":"koszt dostawy"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DapfCtrl(e,t,r,n,o,i,a,s,c,l,u,d,p,f,h,m){"ngInject";this.$exceptionHandler=h,this.CustomException=m,this.isFastForward=!1,this.isDapfSubmitBtnDisabled=!1,this.smsCode=null,this.languageTag=document.documentElement.lang,this.$state=e,this.$stateParams=f,this.$log=r,this.$q=n,this.purchaseCtrl=t.purchase,this.paymentsNgaService=o,this.PaymentsMethodsService=p,this.smsVerificationSvc=i,this.emailGuestVerificationSvc=c,this.smsVerificationModalSvc=s,this.PurchaseSummationSvc=a,this.deliveryPromoSvc=u,this.initializePromoMessage(),l.sendPageView(d.NGA_STATE_TAG.DAPF,this.purchaseCtrl.processEntry,this.purchaseCtrl.isCartProcess,this.$stateParams.referrer,!this.purchaseCtrl.isGuest,this.purchaseCtrl.flags)}return DapfCtrl.$inject=["$state","$scope","$log","$q","PaymentsNgaService","SmsVerificationSvc","PurchaseSummationSvc","SmsVerificationModalSvc","EmailGuestVerificationSvc","PurchaseNgaSvc","DeliveryPromoSvc","PURCHASE_CONSTANTS","PaymentsMethodsService","$stateParams","$exceptionHandler","CustomException"],DapfCtrl.prototype.totalDeliveryCost=function(e){return this.PurchaseSummationSvc.getTotalDeliveryCost(e)},DapfCtrl.prototype.isInstallmentsSelected=function(){return this.PaymentsMethodsService.isInstallmentsGroupSelected(this.purchaseCtrl.paymentsData)},DapfCtrl.prototype.initializePromoMessage=function(){var e=this;this.deliveryPromoSvc.getDeliveryPromoMessage(this.purchaseCtrl.buyerId,this.purchaseCtrl.data.orders).then(function(t){e.deliveryPromoMessage=t})},DapfCtrl.prototype.submitDapf=function(e){var t=this;if(DapfCtrl.isDapfValid(e,this.purchaseCtrl.isBuyerVerificationRequired)){var r=this.$q.when();this.isDapfSubmitBtnDisabled=!0,this.purchaseCtrl.isBuyerVerificationRequired&&(r=r.then(function(){return t.smsVerificationSvc.validateCode(t.purchaseCtrl.data.id,t.purchaseCtrl.activeAddress.phoneNumber,t.smsCode).catch(function(e){return t.smsVerificationModalSvc.showSmsSendingModal(e),t.isDapfSubmitBtnDisabled=!1,t.$q.reject()})})),r.then(function(){t.paymentsNgaService.publishPaymentMethodOnSummary(t.purchaseCtrl.data.id,t.purchaseCtrl.paymentsData,t.purchaseCtrl.isGuest,t.purchaseCtrl.installmentsData||{}),t.purchaseCtrl.isBuyerVerificationRequired=!1,t.purchaseCtrl.isGuest?t.emailGuestVerificationSvc.sendVerificationEmail(t.purchaseCtrl.data.id).then(function(e){t.$log.debug("emailGuestVerificationSvc succeeded: ",e),t.$state.go("purchase.summary.view")}).catch(function(e){t.$log.debug("emailGuestVerificationSvc failed: ",e),t.$state.go("purchase.summary.view")}):t.$state.go("purchase.summary.view")}).catch(function(e){if(!t.purchaseCtrl.isBuyerVerificationRequired){var r=new t.CustomException({name:"GoToSummaryException",message:"Go to summary from DaPF failed.",error:e});t.$exceptionHandler(r)}})}else DapfCtrl.triggerValidation(e.$error)},DapfCtrl.prototype.setSmsCode=function(e){this.smsCode=e},DapfCtrl.isDapfValid=function(e,t){return!(Object.keys(e.$error).length||e.delivery&&e.delivery.$invalid||e.addresses&&e.addresses.$invalid||e.payments&&e.payments.$invalid)&&!(t&&e.smsForm&&e.smsForm.smsCode&&e.smsForm.smsCode.$invalid)},DapfCtrl.triggerValidation=function(e){if(e&&Object.keys(e).length){var t=Object.keys(e)[0],r=e[t][0];if("delivery"===r.$name||"payments"===r.$name||"smsForm"===r.$name)r.$error[t][0].$setDirty();else if("addresses"===r.$name){var n=r.$error[t][0];n.$error[t][0].$touched=!0}}},DapfCtrl}();t.DapfCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DeliveryBundleCtrl(e,t){"ngInject";this.isThemeMetrumize=e.isThemeMetrumize(),this.validationRules=e.getValidationRules(),this.locale=e.getLocale(),this.deliverySpotsProviderSvc=t,this.apiUrl=e.getApiUrl()}return DeliveryBundleCtrl.$inject=["ConfigurationSvc","DeliverySpotsProviderSvc"],DeliveryBundleCtrl.prototype.$onInit=function(){this.order&&this.order.options&&this.order.options.deliveryMethods?this.showPopover=this.openDeliveryPopoverIfRequired(this.order.options.deliveryMethods):this.showPopover={}},DeliveryBundleCtrl.prototype.openDeliveryPopoverIfRequired=function(e){return this.isDeliveryPopoverOpened?{}:this.hasEveningDeliveryMethod&&this.deliverySpotsProviderSvc.isEveningDeliveryMethodAvailable(e)?(this.onShowDeliveryPopover(),{evening:!0}):!this.hasEveningDeliveryMethod&&this.deliverySpotsProviderSvc.isNewDeliveryMethodsForPostParcelsAvailable(e)?(this.onShowDeliveryPopover(),{newPostParcels:!0}):{}},DeliveryBundleCtrl}();t.DeliveryBundleCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DeliveryBundle(){this.restrict="E",this.scope={},this.controller="DeliveryBundleCtrl",this.controllerAs="$ctrl",this.bindToController={service:"=",order:"=",preferredDeliveryMethods:"=",showPaymentIcons:"=",isLast:"=",userAddress:"=",env:"=",hasEveningDeliveryMethod:"<",isDeliveryPopoverOpened:"=",onShowDeliveryPopover:"&"},this.template=r(189)}return DeliveryBundle.instance=function(){return new DeliveryBundle},DeliveryBundle}();t.DeliveryBundle=n},function(e,t){e.exports='<div class="items-to-buy-list" ng-class="{\'row\': $ctrl.isThemeMetrumize}">\n    <ul class="items-list" ng-class="{\'col-xm-12 col-xs-9\': $ctrl.isThemeMetrumize}">\n        <li ng-repeat="offer in $ctrl.order.offers track by $index">\n            <div class="offer-info">\n                <a ng-href="{{::offer.viewUrl}}" class="items-name" target="_blank">\n                    <span>{{::offer.name}}</span>\n                </a>\n                <i class="payu-icons payu-logo" ng-show="offer.isFastPayment && $ctrl.showPaymentIcons"></i>\n                <span class="didascalia items-quantity">\n                    <offer-quantity quantity="::offer.quantity" quantity-type="::offer.quantityType"></offer-quantity>\n                </span>\n                <span class="items-price price hidden-xm hidden-xs"\n                      ng-class="{\'hidden-xs col-xm-0 col-xs-3 text-right\': $ctrl.isThemeMetrumize}">\n                    <formatted-price amount="::(offer.price.amount * offer.quantity)"\n                                     currency="::offer.price.currency"\n                                     target-currency="::$ctrl.locale.currency"\n                                     conversion-rates="::$ctrl.service.currencyConversionRates"\n                    ></formatted-price>\n                </span>\n            </div>\n            <div class="offer-additional-services" ng-if="::(offer.additionalServices && offer.additionalServices.length > 0)">\n                <additional-services read-only="::true" offer="::offer"></additional-services>\n            </div>\n        </li>\n    </ul>\n</div>\n\n<fieldset class="delivery-data">\n    <div class="form-group">\n        <label class="col-xm-offset-1 col-xs-offset-2 col-xm-10 col-xs-8 col-ss-7 col-sm-offset-0 col-sm-3 control-label">\n            <span class="required">\n                <span translate>delivery method provided by</span>\n                <strong>{{::$ctrl.order.seller.login}}</strong>\n            </span>\n        </label>\n        <div class="col-xm-offset-1 col-xs-offset-2 col-xm-10 col-xs-8 col-ss-7 col-sm-offset-0 col-sm-6">\n            <div class="input-group-validation right-sm">\n                <div class="shipping-methods">\n                    <delivery-methods-select\n                        order="$ctrl.order"\n                        preferred-methods="$ctrl.preferredDeliveryMethods"\n                        service="$ctrl.service"\n                        locale="$ctrl.locale"\n                        images-path="/transaction-front/images/"\n                        marker-clusterer-path="/transaction-front/js/markerclusterer.js"\n                        user-address="$ctrl.userAddress"\n                        env="$ctrl.env"\n                        api-url="$ctrl.apiUrl"\n                        show-popover="$ctrl.showPopover"\n                    ></delivery-methods-select>\n                </div>\n            </div>\n        </div>\n        \x3c!-- TODO: free delivery --\x3e\n        <div class="col-ss-3 delivery-cost">\n            <span class="price delivery-price hidden-xm hidden-xs"\n                ng-class="{\'free-delivery-colored\': $ctrl.order.freeDeliveryAmountMet}"\n                ng-show="$ctrl.order.delivery.deliveryMethod.id">\n                <span ng-if="$ctrl.order.isPaymentForShippingAfterDelivery">-</span>\n                <span ng-if="!$ctrl.order.isPaymentForShippingAfterDelivery">\n                    <formatted-price amount="$ctrl.order.delivery.cost.amount"\n                                     currency="$ctrl.order.offers[0].price.currency"\n                                     target-currency="::$ctrl.locale.currency"\n                                     conversion-rates="::$ctrl.service.currencyConversionRates"\n                    ></formatted-price>\n                </span>\n            </span>\n        </div>\n    </div>\n\n    <div class="form-group">\n        <label class="col-xm-offset-1 col-xs-offset-2 col-xm-10 col-xs-8 col-ss-7 col-sm-offset-0 col-sm-3 control-label" for="focus-message-{{::$ctrl.order.id}}" translate>\n            Message to Seller\n        </label>\n        <div class="col-xm-offset-1 col-xs-offset-2 col-xm-10 col-xs-8 col-ss-7 col-sm-offset-0 col-sm-6">\n            <div class="input-group-validation right-sm">\n                <textarea\n                    id="focus-message-{{::$ctrl.order.id}}"\n                    class="message-to-seller form-control"\n                    ng-model="$ctrl.order.messageToSeller"\n                    maxlength="{{::$ctrl.validationRules.messageToSellerMaxLength}}">\n                </textarea>\n            </div>\n        </div>\n    </div>\n</fieldset>\n\n<div class="total-delivery-cost col-xs-12 visible-xm visible-xs">\n    <div class="row additional-services-total-cost" ng-if="$ctrl.order.summation.totalAdditionalServicesPrice">\n        <div class="col-xm-6 bottom-delivery-label" translate>additional services cost</div>\n        <div class="col-xm-6">\n            <span class="price bottom-delivery-price">\n                <formatted-price amount="::$ctrl.order.summation.totalAdditionalServicesPrice"\n                                 currency="::$ctrl.order.summation.currency"\n                                 target-currency="::$ctrl.locale.currency"\n                                 conversion-rates="::$ctrl.service.currencyConversionRates"\n                ></formatted-price>\n            </span>\n        </div>\n    </div>\n    <div class="row items-total-cost">\n        <div class="col-xm-6 bottom-delivery-label" translate>item cost</div>\n        <div class="col-xm-6">\n            <span class="price bottom-delivery-price">\n                <formatted-price amount="::$ctrl.order.summation.totalOffersPrice"\n                                 currency="::$ctrl.order.summation.currency"\n                                 target-currency="::$ctrl.locale.currency"\n                                 conversion-rates="::$ctrl.service.currencyConversionRates"\n                ></formatted-price>\n            </span>\n        </div>\n    </div>\n    <div class="row shipment-total-cost" ng-show="$ctrl.order.delivery.deliveryMethod.id">\n        <div class="col-xm-6 bottom-delivery-label" translate>shipping cost</div>\n        <div class="col-xm-6">\n            <span class="price bottom-delivery-price" ng-class="{\'free-delivery-colored\': order.freeDeliveryAmountMet}">\n                <formatted-price amount="$ctrl.order.delivery.cost.amount"\n                                 currency="$ctrl.order.delivery.cost.currency"\n                                 target-currency="::$ctrl.locale.currency"\n                                 conversion-rates="::$ctrl.service.currencyConversionRates"\n                ></formatted-price>\n            </span>\n        </div>\n    </div>\n</div>\n\n<hr class="separator separator-top" ng-if="!$ctrl.isLast" />\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DeliverySection(){this.restrict="E",this.scope={},this.controller="DeliverySectionCtrl",this.bindToController={orders:"=",purchaseOptions:"=",showPaymentIcons:"=",service:"=",userAddress:"=",env:"="},this.controllerAs="$ctrl",this.template=r(191)}return DeliverySection.instance=function(){return new DeliverySection},DeliverySection}();t.DeliverySection=n},function(e,t){e.exports='<section id="delivery-data" class="delivery">\n    <h2 class="auto-num" translate>delivery method</h2>\n    <section class="delivery-group">\n        <ng-form name="delivery">\n            <delivery-bundle\n                class="delivery-bundle"\n                ng-repeat="order in $ctrl.orders track by order.id"\n                ng-class="\'seller-id-\' + order.seller.id"\n                order="order"\n                preferred-delivery-methods="$ctrl.purchaseOptions.userPreferences.delivery"\n                show-payment-icons="$ctrl.showPaymentIcons"\n                user-address="$ctrl.userAddress"\n                service="$ctrl.service"\n                env="$ctrl.env"\n                is-last="$last"\n                has-evening-delivery-method="$ctrl.hasEveningDeliveryMethod"\n                is-delivery-popover-opened="$ctrl.isDeliveryPopoverOpened"\n                on-show-delivery-popover="$ctrl.showDeliveryPopover()">\n            </delivery-bundle>\n        </ng-form>\n    </section>\n</section>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DeliverySectionCtrl(e){"ngInject";this.deliverySpotsProviderSvc=e}return DeliverySectionCtrl.$inject=["DeliverySpotsProviderSvc"],DeliverySectionCtrl.prototype.$onInit=function(){var e=this;this.isDeliveryPopoverOpened=!1,this.hasEveningDeliveryMethod=this.orders.some(function(t){return t&&t.options&&t.options.deliveryMethods&&e.deliverySpotsProviderSvc.isEveningDeliveryMethodAvailable(t.options.deliveryMethods)})},DeliverySectionCtrl.prototype.showDeliveryPopover=function(){this.isDeliveryPopoverOpened=!0},DeliverySectionCtrl}();t.DeliverySectionCtrl=n},function(e,t,r){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}r(194);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(195),a=r(197),s=r(198),c=r(199),l=r(200),u=r(2),d=_interopRequireDefault(u),p=r(4),f=_interopRequireDefault(p),h=r(1),m=_interopRequireDefault(h),v=o.module("purchase.smsVerification",["ui.bootstrap",d.default.name,f.default.name,m.default.name]).component("smsVerification",new i.SmsVerificationComponent).controller("SmsSendingResultModalCtrl",a.SmsSendingResultModalCtrl).controller("SmsVerificationCtrl",s.SmsVerificationCtrl).service("SmsVerificationSvc",c.SmsVerificationSvc).service("SmsVerificationModalSvc",l.SmsVerificationModalSvc);t.default=v},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{'Activation code has been sent. Please check your phone, enter the activation code in the field below and click on "activate" to activate your account.':"Wysłaliśmy kod sms na podany numer.","An error has occured when sending code. Please try again or":"Nie mogliśmy wysłać kodu sms – spróbuj jeszcze raz lub","Code has expired":"Kod jest już nieważny","Code is incorrect":"Nieprawidłowy kod","contact us":"skontaktuj się z nami","Contact us":"Skontaktuj się z nami","Don't you have a Polish number?":"Nie masz polskiego numeru?","enter SMS code":"wpisz otrzymany kod SMS","Message should be delivered within a few minutes. The activation code will be valid for 5 minutes.":"Odbierz kod i wpisz go w ostatnim polu. Kod zadziała, jeśli użyjesz go w ciągu najbliższych 5 minut.","Phone number you have entered is on the black list.":"Sytuacja 588 - kwestia bezpieczeństwa.","Please contact us.":"Skontaktuj się z nami i podaj ten numer.","provide SMS code":"podaj kod SMS","send SMS code":"wyślij kod SMS","SMS verification":"weryfikacja telefonu",'Sorry, you have already used all attempts to use the "Send code" option. Please contact us.':"Nie możesz dziś wysłać więcej kodów sms.","The mobile number is inconsistent with the required format. Please correct the phone number. ex: +48000000000, 0048000000000":"Numer telefonu komórkowego jest niezgodny z wymaganym formatem. Popraw numer telefonu. np. +48000000000","We send at most 3 codes per day.":"Wysyłamy maksymalnie 3 kody na dobę."})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function SmsVerificationComponent(){this.bindings={purchaseId:"<",phoneNumber:"<",onSmsCodeUpdate:"&",isPhoneNumberValid:"<"},this.template=r(196),this.controller="SmsVerificationCtrl"}return SmsVerificationComponent}();t.SmsVerificationComponent=n},function(e,t){e.exports='<div class="row">\r\n    <label class="col-xm-offset-1 col-xs-offset-2 col-xm-10 col-xs-8 col-ss-7 col-sm-offset-0 col-sm-3 control-label" for="smsCode" translate>\r\n        SMS verification\r\n    </label>\r\n    <div class="col-xm-offset-1 col-xs-offset-2 col-xm-10 col-xs-8 col-ss-7 col-sm-offset-0 col-sm-6">\r\n        <ng-form name="smsForm">\r\n            <div class="input-group">\r\n                <span class="input-group-btn">\r\n                    <button type="button"\r\n                            id="send-sms-code"\r\n                            class="btn btn-default send-sms-btn"\r\n                            ng-disabled="!$ctrl.isSendSmsButtonActive || !$ctrl.isPhoneNumberValid"\r\n                            ng-click="$ctrl.generateCode()">\r\n                        <span class="spinner" ng-show="!$ctrl.isSendSmsButtonActive"></span>\r\n                        <span translate ng-show="$ctrl.isSendSmsButtonActive">send SMS code</span>\r\n                    </button>\r\n                </span>\r\n                <input type="text"\r\n                       class="form-control"\r\n                       ng-class="{\'input-error\': smsForm.smsCode.$touched && smsForm.smsCode.$invalid}"\r\n                       ng-model="$ctrl.smsCode"\r\n                       ng-change="$ctrl.setSmsCode()"\r\n                       id="sms-code"\r\n                       name="smsCode"\r\n                       placeholder="{{\'enter SMS code\' | translate}}"\r\n                       required>\r\n            </div>\r\n            <div ng-messages="smsForm.smsCode.$error" class="validation-message in" ng-if="smsForm.smsCode.$invalid && smsForm.smsCode.$dirty">\r\n                <div ng-message="required"><translate>provide SMS code</translate></div>\r\n            </div>\r\n            <span class="help-block">\r\n                <span translate>Don\'t you have a Polish number?</span> <a ng-href="{{\'contact\' | url}}" translate>Contact us</a>.\r\n            </span>\r\n        </ng-form>\r\n    </div>\r\n</div>\r\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function SmsSendingResultModalCtrl(e,t){"ngInject";this.response=e,this.isBlocking=t}return SmsSendingResultModalCtrl.$inject=["response","isBlocking"],SmsSendingResultModalCtrl}();t.SmsSendingResultModalCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function SmsVerificationCtrl(e,t){"ngInject";this.isSendSmsButtonActive=!0,this.smsVerificationSvc=e,this.smsVerificationModalSvc=t}return SmsVerificationCtrl.$inject=["SmsVerificationSvc","SmsVerificationModalSvc"],SmsVerificationCtrl.prototype.generateCode=function(){var e=this;this.isSendSmsButtonActive=!1,this.smsVerificationSvc.generateCode(this.purchaseId,this.phoneNumber).then(function(t){return e.smsVerificationModalSvc.showSmsSendingModal(t)},function(t){return e.smsVerificationModalSvc.showSmsSendingModal(t)}).finally(function(){e.isSendSmsButtonActive=!0})},SmsVerificationCtrl.prototype.setSmsCode=function(){this.onSmsCodeUpdate({smsCode:this.smsCode})},SmsVerificationCtrl}();t.SmsVerificationCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function SmsVerificationSvc(e,t,r,n,o){"ngInject";this.$http=e,this.$q=t,this.$exceptionHandler=r,this.configurationSvc=n,this.CustomException=o}return SmsVerificationSvc.$inject=["$http","$q","$exceptionHandler","ConfigurationSvc","CustomException"],SmsVerificationSvc.prototype.generateCode=function(e,t){var r=this;return this.$http.post(this.getValidationApiUrl(e,t),null).then(function(){return SmsVerificationSvc.OK_RESPONSE},function(e){return r.respondToSmsError(e)})},SmsVerificationSvc.prototype.validateCode=function(e,t,r){var n=this;return this.$http.get(this.getValidationApiUrl(e,t,r)).then(function(){return SmsVerificationSvc.OK_RESPONSE},function(e){return n.respondToSmsError(e)})},SmsVerificationSvc.prototype.getValidationApiUrl=function(e,t,r){var n=this.configurationSvc.getApiUrl()+"/purchases/"+e+"/verifications/buyer/phone-numbers/"+t+"/codes";return r?n+"/"+r:n},SmsVerificationSvc.prototype.respondToSmsError=function(e){if((400===e.status||422===e.status)&&e.data&&e.data.errors&&e.data.errors[0])return this.$q.reject(SmsVerificationSvc.createErrorResponse(e.data.errors[0].code));var t=new this.CustomException({name:"SmsVerificationSvcException",message:"There was a problem while contacting SMS verification service.",error:e});return this.$exceptionHandler(t),this.$q.reject(SmsVerificationSvc.FAIL_RESPONSE)},SmsVerificationSvc.createErrorResponse=function(e){switch(e){case SmsVerificationSvc.LIMIT_EXCEEDED:return{isLimitExceeded:!0};case SmsVerificationSvc.PHONE_NUMBER_INVALID:return{isPhoneNumberInvalid:!0};case SmsVerificationSvc.PHONE_NUMBER_ON_BLACK_LIST:return{isPhoneNumberOnBlacklist:!0};case SmsVerificationSvc.PHONE_NUMBER_NOT_FOUND:return{isPhoneNumberNotFound:!0};case SmsVerificationSvc.CODE_INVALID:return{isCodeInvalid:!0};case SmsVerificationSvc.CODE_EXPIRED:return{isCodeExpired:!0};default:return{isSmsSendingError:!0}}},SmsVerificationSvc.LIMIT_EXCEEDED="LIMIT_EXCEEDED",SmsVerificationSvc.PHONE_NUMBER_INVALID="INVALID_PHONE_NUMBER",SmsVerificationSvc.PHONE_NUMBER_ON_BLACK_LIST="PHONE_NUMBER_ON_BLACKLIST",SmsVerificationSvc.PHONE_NUMBER_NOT_FOUND="PHONE_NUMBER_NOT_FOUND",SmsVerificationSvc.CODE_INVALID="CODE_INVALID",SmsVerificationSvc.CODE_EXPIRED="CODE_EXPIRED",SmsVerificationSvc.OK_RESPONSE={isOk:!0},SmsVerificationSvc.FAIL_RESPONSE={isSmsSendingError:!0},SmsVerificationSvc}();t.SmsVerificationSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function SmsVerificationModalSvc(e,t){"ngInject";this.$uibModal=e,this.$timeout=t}return SmsVerificationModalSvc.$inject=["$uibModal","$timeout"],SmsVerificationModalSvc.prototype.showSmsSendingModal=function(e){var t=!0===e.isPhoneNumberOnBlacklist,n=this.$uibModal.open({template:r(201),controller:"SmsSendingResultModalCtrl",controllerAs:"smsSendingResultModal",bindToController:!0,windowClass:e.isOk||t?"info-modal":"error-modal",backdrop:!t||"static",keyboard:!t,resolve:{response:function(){return e},isBlocking:function(){return t}}});t||this.$timeout(SmsVerificationModalSvc.MODAL_AUTO_DISMISS_TIMEOUT).then(function(){return n.dismiss()})},SmsVerificationModalSvc.MODAL_AUTO_DISMISS_TIMEOUT=4e3,SmsVerificationModalSvc}();t.SmsVerificationModalSvc=n},function(e,t){e.exports='<div class="modal-header">\r\n    <button\r\n            type="button"\r\n            class="btn-close"\r\n            ng-if="::!smsSendingResultModal.isBlocking"\r\n            ng-click="smsSendingResultModal.$dismiss()">\r\n        ×\r\n    </button>\r\n</div>\r\n<div class="modal-body">\r\n    <section>\r\n        <h4 ng-if="::smsSendingResultModal.response.isOk">\r\n            <span translate>Activation code has been sent. Please check your phone, enter the activation code in the field below and click on "activate" to activate your account.</span><br/><br/>\r\n            <span translate>Message should be delivered within a few minutes. The activation code will be valid for 5 minutes.</span>\r\n        </h4>\r\n        <h4 ng-if="::smsSendingResultModal.response.isLimitExceeded">\r\n            <span translate>Sorry, you have already used all attempts to use the "Send code" option. Please contact us.</span><br/><br/>\r\n            <span class="modalmessage" translate>We send at most 3 codes per day.</span>\r\n        </h4>\r\n        <h4 ng-if="::smsSendingResultModal.response.isPhoneNumberInvalid" translate>\r\n            The mobile number is inconsistent with the required format. Please correct the phone number. ex: +48000000000, 0048000000000\r\n        </h4>\r\n        <h4 ng-if="::smsSendingResultModal.response.isPhoneNumberOnBlacklist">\r\n            <span translate>Phone number you have entered is on the black list.</span><br/><br/>\r\n            <span class="modalmessage" translate>Please contact us.</span>\r\n        </h4>\r\n        <h4 ng-if="::(smsSendingResultModal.response.isCodeInvalid || smsSendingResultModal.response.isPhoneNumberNotFound)" translate>\r\n            Code is incorrect\r\n        </h4>\r\n        <h4 ng-if="::smsSendingResultModal.response.isCodeExpired" translate>\r\n            Code has expired\r\n        </h4>\r\n        <h4 ng-if="::smsSendingResultModal.response.isSmsSendingError">\r\n            <span translate>An error has occured when sending code. Please try again or</span> <a href="https://pomoc.allegro.pl" translate>contact us</a>.\r\n        </h4>\r\n    </section>\r\n</div>\r\n<div class="modal-footer" ng-if="::smsSendingResultModal.isBlocking">\r\n    <a ng-href="{{\'contact\' | url}}" class="btn btn-primary" translate>Contact us</a>\r\n</div>'},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Delivery to drop-off":"Zostaw przesyłkę u sąsiada","Drop-off feature is not available yet.":"Przepraszamy, usługa odbioru u sąsiada nie jest jeszcze dostępna.","Opening hours:":"Godziny otwarcia:","Please leave the package at my neighbor if I'm not at home":"W przypadku nieobecności proszę o zostawienie przesyłki u sąsiada","Point {{distance}} m away":"Punkt oddalony o {{distance}} m","We have noted your interest and will let you know when it's ready.":'Jak tylko udostępnimy tę usługę, poinformujemy o tym w "Aktualnościach".',back:"Wróć",choose:"Wybierz","drop-off points":"Alternatywne adresy dostawy","no data":"brak danych",MONDAY:"Poniedziałek",TUESDAY:"Wtorek",WEDNESDAY:"Środa",THURSDAY:"Czwartek",FRIDAY:"Piątek",SATURDAY:"Sobota",SUNDAY:"Niedziela"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffCheckboxCtrl(e,t){"ngInject";this.PurchaseNgaSvc=e,this.dropOffFakeDoorSvc=t,this.isDropOffPointSelected=!1,this.PurchaseNgaSvc.onDropOffAvailable(DropOffCheckboxCtrl.VARIANT),this.dropOffFakeDoorSvc.onDropOffAvailable()}return DropOffCheckboxCtrl.$inject=["PurchaseNgaSvc","dropOffFakeDoorSvc"],DropOffCheckboxCtrl.prototype.onDropOffClicked=function(){this.PurchaseNgaSvc.onDropOffRequested(DropOffCheckboxCtrl.VARIANT),this.dropOffFakeDoorSvc.onDropOffRequested()},DropOffCheckboxCtrl.VARIANT="checkbox",DropOffCheckboxCtrl}();t.DropOffCheckboxCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffCheckboxComponent(){this.bindings={purchaseId:"<"},this.controller="DropOffCheckboxCtrl",this.template=r(205)}return DropOffCheckboxComponent}();t.DropOffCheckboxComponent=n},function(e,t){e.exports='<div class="address-indent row col-xm-10 col-sm-offset-3 drop-off">\n    <div class="checkbox">\n        <label>\n            <input ng-model="$ctrl.isDropOffPointSelected"\n                   ng-change="$ctrl.onDropOffClicked()"\n                   ng-disabled="$ctrl.isDropOffPointSelected"\n                   type="checkbox"\n                   id="drop-off-checkbox">\n            <span translate>Please leave the package at my neighbor if I\'m not at home</span>\n        </label>\n    </div>\n\n    <div ng-if="$ctrl.isDropOffPointSelected">\n        <drop-off-disclaimer></drop-off-disclaimer>\n    </div>\n</div>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffSvc(e,t,r,n,o){"ngInject";this.$q=e,this.$http=t,this.ConfigurationSvc=r,this.CustomException=n,this.$exceptionHandler=o}return DropOffSvc.$inject=["$q","$http","ConfigurationSvc","CustomException","$exceptionHandler"],DropOffSvc.prototype.findNearAddresses=function(e){var t=this,r=this.getLocateDropOffsUrl(e);return this.$http.get(r).then(function(e){return e.data._embedded?e.data._embedded.dropOffPoints:[]},function(e){return t.onFailure("findNearAddressException","Failed to locate near address",e)})},DropOffSvc.prototype.getLocateDropOffsUrl=function(e){return this.ConfigurationSvc.getApiUrl()+"/drop-offs/points/search/near-address?address="+e},DropOffSvc.prototype.onFailure=function(e,t,r){return this.handleCustomException(e,t,r),this.$q.reject(r)},DropOffSvc.prototype.handleCustomException=function(e,t,r){var n=new this.CustomException({name:e,message:t,error:r});this.$exceptionHandler(n)},DropOffSvc}();t.DropOffSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffDisclaimerComponent(){this.template=r(208)}return DropOffDisclaimerComponent}();t.DropOffDisclaimerComponent=n},function(e,t){e.exports='<div class="drop-off-disclaimer popover right" id="drop-off-disclaimer">\n    <div class="arrow"></div>\n    <h3 class="popover-title" translate>Drop-off feature is not available yet.</h3>\n    <div class="popover-content">\n        <p translate>We have noted your interest and will let you know when it\'s ready.</p>\n    </div>\n</div>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffSelectComponent(){this.bindings={purchaseId:"<",activeAddress:"<"},this.controller="DropOffSelectCtrl",this.template=r(210)}return DropOffSelectComponent}();t.DropOffSelectComponent=n},function(e,t){e.exports='<div class="address-indent row col-xm-10 col-sm-offset-3 drop-off">\n    <div class="checkbox">\n        <label>\n            <input ng-model="$ctrl.isDropOffPointSelected"\n                   ng-change="$ctrl.onDropOffClicked()"\n                   ng-disabled="$ctrl.isInteractionLocked()"\n                   type="checkbox"\n                   id="drop-off-checkbox">\n            <span translate>Please leave the package at my neighbor if I\'m not at home</span>\n        </label>\n    </div>\n\n    <div ng-if="$ctrl.isInteractionLocked()">\n        <drop-off-disclaimer></drop-off-disclaimer>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="modal-header">\n    <button id="delivery-spots-close-btn" class="btn-close" data-dismiss="modal"\n            ng-click="::modalCtrl.cancel()">\n        <i class="icon-back"></i>\n        <translate>back</translate>\n    </button>\n</div>\n\n<div class="modal-body delivery-spots-modal">\n    <h3 class="latest-spots-header" translate>drop-off points</h3>\n    <button id="toggle-latest-spots-btn" class="btn btn-link" ng-click="::modalCtrl.cancel()">\n        <translate>back</translate>\n    </button>\n\n    <section id="spot-search-form">\n        <div class="map-container">\n            <drop-off-points-map class="map"\n                                 points="modalCtrl.points"\n                                 modal-ctrl="modalCtrl">\n            </drop-off-points-map>\n        </div>\n    </section>\n</div>\n\n<div class="modal-footer visible-xs visible-xm">\n    <button type="button" class="btn-close" data-dismiss="modal" ng-click="::modalCtrl.cancel()">\n        <i class="icon-back"></i>\n        <translate>back</translate>\n    </button>\n</div>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffPointSelectModalCtrl(e,t){"ngInject";this.$uibModalInstance=e,this.points=t,this.points=t}return DropOffPointSelectModalCtrl.$inject=["$uibModalInstance","points"],DropOffPointSelectModalCtrl.prototype.cancel=function(){this.$uibModalInstance.dismiss()},DropOffPointSelectModalCtrl.prototype.selectPoint=function(e){this.$uibModalInstance.close({selectedPoint:this.points.filter(function(t){return t.id===e})[0]})},DropOffPointSelectModalCtrl}();t.DropOffPointSelectModalCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffPointComponent(){this.controller="DropOffPointCtrl",this.template=r(214),this.bindings={point:"<"}}return DropOffPointComponent}();t.DropOffPointComponent=n},function(e,t){e.exports='<div>\n    <strong translate translate-params-distance="$ctrl.distanceInMeters()">\n        Point {{distance}} m away\n    </strong>\n    <address>\n        {{$ctrl.point.address.addressLine}}<br/>\n        {{$ctrl.point.address.postalCode}} {{$ctrl.point.address.city}}\n    </address>\n\n    <div>\n        <h6 translate>Opening hours:</h6>\n        <div>\n            <div ng-if="!$ctrl.hasAvailability()" translate>no data</div>\n            <div ng-if="$ctrl.hasAvailability()" ng-repeat="(day, schedule) in $ctrl.point.availability">\n                <span>{{$ctrl.translate(day)}}</span>:\n                <span>{{$ctrl.formatTime(schedule.start)}} - {{$ctrl.formatTime(schedule.end)}}</span>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffPointCtrl(e){"ngInject";this.gettextCatalog=e}return DropOffPointCtrl.$inject=["gettextCatalog"],DropOffPointCtrl.prototype.distanceInMeters=function(){return 10*Math.round(100*this.point._transients.distance.value)},DropOffPointCtrl.prototype.hasAvailability=function(){return!!this.point.availability&&!!Object.keys(this.point.availability).length},DropOffPointCtrl.prototype.translate=function(e){return this.gettextCatalog.getString(e)},DropOffPointCtrl.prototype.formatTime=function(e){var t=e.match(/(\d{2}):(\d{2}):(\d{2})/);return t?t[1]+":"+t[2]:e},DropOffPointCtrl}();t.DropOffPointCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(217),o=function(){function DropOffPointsMapCtrl(e,t,r,n,o){"ngInject";this.MapsInitializerSvc=e,this.ConfigurationSvc=t,this.$compile=r,this.$scope=n,this.$timeout=o}return DropOffPointsMapCtrl.$inject=["MapsInitializerSvc","ConfigurationSvc","$compile","$scope","$timeout"],DropOffPointsMapCtrl.prototype.$onInit=function(){var e=this;this.MapsInitializerSvc.isGoogleMapsInitialized()?this.renderMap():this.MapsInitializerSvc.loadMap("/transaction-front/js/markerclusterer.js",this.ConfigurationSvc.getEnvironment()).then(function(){return e.renderMap()})},DropOffPointsMapCtrl.prototype.renderMap=function(){var e=this;this.map=new google.maps.Map(document.getElementsByClassName("map")[0],this.getMapConfig()),this.points.forEach(function(t){var r=new google.maps.Marker({position:new google.maps.LatLng(t.location.latitude,t.location.longitude),map:e.map,title:t.address.addressLine});google.maps.event.addListener(r,"mouseover",function(){return e.onMouseOver(r,t)})}),this.infoWindow=new google.maps.InfoWindow,this.$timeout(0).then(function(){google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.getCenter())})},DropOffPointsMapCtrl.prototype.getMapConfig=function(){return{zoom:14,center:this.getCenter(),mapTypeId:google.maps.MapTypeId.ROADMAP}},DropOffPointsMapCtrl.prototype.getCenter=function(){var e=this.points[0].location,t=e.latitude,r=e.longitude;return new google.maps.LatLng(t,r)},DropOffPointsMapCtrl.prototype.onMouseOver=function(e,t){var r=this,o=this.$scope.$new(),i=this.$compile(n)(o);o.point=t,o.selectPoint=function(e){r.modalCtrl.selectPoint(e)},o.$apply(),this.infoWindow.close(),this.infoWindow.setContent(i[0]),this.infoWindow.open(this.map,e)},DropOffPointsMapCtrl}();t.DropOffPointsMapCtrl=o},function(e,t){e.exports='<div class="delivery-spot-tooltip" id="spot-window">\n    <drop-off-point point="point"></drop-off-point>\n    <div>\n        <button type="button" class="btn btn-primary drop-off-button" ng-click="selectPoint(point.id)" translate>choose</button>\n    </div>\n</div>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffPointsMapComponent(){this.bindings={modalCtrl:"<",points:"<"},this.controller="DropOffPointsMapCtrl"}return DropOffPointsMapComponent}();t.DropOffPointsMapComponent=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffFakeDoorComponent(){this.bindings={purchase:"<"},this.controller="DropOffFakeDoorCtrl",this.template=r(220)}return DropOffFakeDoorComponent}();t.DropOffFakeDoorComponent=n},function(e,t){e.exports='<div ng-if="$ctrl.shouldShowDropOffCheckbox()">\n    <drop-off-checkbox purchase-id="$ctrl.getPurchaseId()"></drop-off-checkbox>\n</div>\n\n<div ng-if="$ctrl.shouldShowDropOffSelect()">\n    <drop-off-select purchase-id="$ctrl.getPurchaseId()" active-address="$ctrl.getActiveAddress()"></drop-off-select>\n</div>\n\n<div ng-if="$ctrl.shouldShowDropOffAddress()">\n    <drop-off-address purchase-id="$ctrl.getPurchaseId()" active-address="$ctrl.getActiveAddress()"></drop-off-address>\n</div>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffFakeDoorSvc(e,t){"ngInject";this.PURCHASE_CONSTANTS=e,this.$cookies=t}return DropOffFakeDoorSvc.$inject=["PURCHASE_CONSTANTS","$cookies"],DropOffFakeDoorSvc.prototype.onDropOffAvailable=function(){this.getCookie(DropOffFakeDoorSvc.COOKIE_FOR_REQUESTED)||this.setCookie(DropOffFakeDoorSvc.COOKIE_FOR_AVAILABLE)},DropOffFakeDoorSvc.prototype.onDropOffRequested=function(){this.removeCookie(DropOffFakeDoorSvc.COOKIE_FOR_AVAILABLE),this.setCookie(DropOffFakeDoorSvc.COOKIE_FOR_REQUESTED)},DropOffFakeDoorSvc.prototype.shouldShowDropOffSelect=function(e,t){return this.shouldShowVariant(e,DropOffFakeDoorSvc.VARIANTS.SELECT)&&this.shouldShowDropOff(e,t)},DropOffFakeDoorSvc.prototype.shouldShowDropOffCheckbox=function(e,t){return this.shouldShowVariant(e,DropOffFakeDoorSvc.VARIANTS.CHECKBOX)&&this.shouldShowDropOff(e,t)},DropOffFakeDoorSvc.prototype.shouldShowDropOffAddress=function(e,t){return this.shouldShowVariant(e,DropOffFakeDoorSvc.VARIANTS.ADDRESS)&&this.shouldShowDropOff(e,t)},DropOffFakeDoorSvc.prototype.getCookie=function(e){return this.$cookies.get(e)},DropOffFakeDoorSvc.prototype.removeCookie=function(e){this.$cookies.remove(e)},DropOffFakeDoorSvc.prototype.setCookie=function(e){if(!this.getCookie(e)){var t=new Date;t.setTime(t.getTime()+24*DropOffFakeDoorSvc.COOKIE_VALIDITY_DAYS*60*60*1e3),this.$cookies.put(e,DropOffFakeDoorSvc.COOKIE_VALUE,{path:"/",expires:t})}},DropOffFakeDoorSvc.prototype.shouldShowDropOff=function(e,t){var r=e.isGuest,n=e.activeAddress,o=e.data,i=o.id;return this.isAppropiateUser(r,n)&&this.isPurchaseIdWithin(i,t)&&this.isAppropriateDeliveryMethod(o)},DropOffFakeDoorSvc.prototype.shouldShowVariant=function(e,t){return parseInt(e.data.id.substr(0,2),16)%3===t},DropOffFakeDoorSvc.prototype.isAppropriateDeliveryMethod=function(e){var t=this;return e.orders.filter(function(e){return e.delivery&&e.delivery.deliveryMethod}).map(function(e){return e.delivery.deliveryMethod}).some(function(e){return e.id===DropOffFakeDoorSvc.DELIVERY_BY_COURIER&&e.payment.type==t.PURCHASE_CONSTANTS.DELIVERY.PAYMENT.PREPAID})},DropOffFakeDoorSvc.prototype.isAppropiateUser=function(e,t){return!e&&t&&t.isValid},DropOffFakeDoorSvc.prototype.isPurchaseIdWithin=function(e,t){return parseInt(e.substring(0,3),16)/4095<=t},DropOffFakeDoorSvc.DELIVERY_BY_COURIER="7203cb90-864c-4cda-bf08-dc883f0c78ad",DropOffFakeDoorSvc.COOKIE_VALIDITY_DAYS=60,DropOffFakeDoorSvc.COOKIE_FOR_AVAILABLE="drA",DropOffFakeDoorSvc.COOKIE_FOR_REQUESTED="drR",DropOffFakeDoorSvc.COOKIE_VALUE="1",DropOffFakeDoorSvc.VARIANTS={SELECT:0,CHECKBOX:1,ADDRESS:2},DropOffFakeDoorSvc}();t.DropOffFakeDoorSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffFakeDoorCtrl(e,t){"ngInject";this.dropOffFakeDoorSvc=e,this.percentage=.045,t.search().forceDropOff&&(this.percentage=Number(t.search().forceDropOff))}return DropOffFakeDoorCtrl.$inject=["dropOffFakeDoorSvc","$location"],DropOffFakeDoorCtrl.prototype.shouldShowDropOffCheckbox=function(){return this.dropOffFakeDoorSvc.shouldShowDropOffCheckbox(this.purchase,this.percentage)},DropOffFakeDoorCtrl.prototype.shouldShowDropOffSelect=function(){return this.dropOffFakeDoorSvc.shouldShowDropOffSelect(this.purchase,this.percentage)},DropOffFakeDoorCtrl.prototype.shouldShowDropOffAddress=function(){return this.dropOffFakeDoorSvc.shouldShowDropOffAddress(this.purchase,this.percentage)},DropOffFakeDoorCtrl.prototype.getPurchaseId=function(){return this.purchase.data.id},DropOffFakeDoorCtrl.prototype.getActiveAddress=function(){return this.purchase.activeAddress},DropOffFakeDoorCtrl}();t.DropOffFakeDoorCtrl=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DropOffAddressComponent(){this.bindings={purchaseId:"<",activeAddress:"<"},this.controller="DropOffAddressCtrl",this.template=r(224)}return DropOffAddressComponent}();t.DropOffAddressComponent=n},function(e,t){e.exports='<div class="address-indent row col-xm-10 col-sm-offset-3 drop-off">\n    <button class="btn-link" ng-click="$ctrl.onDropOffClicked()"\n            ng-disabled="$ctrl.isInteractionLocked()"\n            id="drop-off-address" translate>Delivery to drop-off</button>\n\n    <div ng-if="$ctrl.isInteractionLocked()">\n        <drop-off-disclaimer class="drop-off-address"></drop-off-disclaimer>\n    </div>\n</div>\n'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DropOffAddressCtrl=void 0;var n=r(19),o=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function __(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}}(),i=function(e){function DropOffAddressCtrl(){return null!==e&&e.apply(this,arguments)||this}return o(DropOffAddressCtrl,e),DropOffAddressCtrl.prototype.getVariant=function(){return"address"},DropOffAddressCtrl}(n.DropOffSelectCtrl);t.DropOffAddressCtrl=i},function(e,t,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(227),a=r(229),s=r(1),c=_interopRequireDefault(s),l=r(230),u=r(3),d=_interopRequireDefault(u),p=o.module("purchase.promoMessages",[c.default.name,d.default.name]).controller("DeliveryPromoController",l.DeliveryPromoController).component("deliveryPromo",new i.DeliveryPromoComponent).service("DeliveryPromoSvc",a.DeliveryPromoSvc);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DeliveryPromoComponent(){this.bindings={message:"<"},this.controller="DeliveryPromoController",this.template=r(228)}return DeliveryPromoComponent}();t.DeliveryPromoComponent=n},function(e,t){e.exports='<article class="alert alert-success promo-message" ng-if="$ctrl.message && $ctrl.message.title && $ctrl.message.content">\n    <h2>{{::$ctrl.message.title}}</h2>\n    <p>{{::$ctrl.message.content}}</p>\n    <button\n        ng-if="$ctrl.isPromoTermsLinkAvailable()"\n        ng-click="$ctrl.goToPromoTerms()"\n        type="button"\n        class="btn btn-link">\n            {{::$ctrl.message.termsLinkName}}\n    </button>\n</article>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeliveryPromoSvc=void 0;var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=function(){function DeliveryPromoSvc(e,t){"ngInject";this.$http=e,this.ConfigurationSvc=t}return DeliveryPromoSvc.$inject=["$http","ConfigurationSvc"],DeliveryPromoSvc.prototype.getDeliveryPromoMessage=function(e,t){var r=this.prepareRequestConfigForPromoMessage(e,this.getOfferIdsFromOrders(t));return this.$http.get(this.ConfigurationSvc.getApiUrl()+"/message-notice/content",r).then(function(e){return e.data})},DeliveryPromoSvc.prototype.prepareRequestConfigForPromoMessage=function(e,t){var r={cache:!0,params:{}};return e&&(r.params.userId=e),t&&t.length&&(r.params.offerId=t),r},DeliveryPromoSvc.prototype.getOfferIdsFromOrders=function(e){return o.isArray(e)?e.flatMap(function(e){return e.offers}).map(function(e){return e.id}):null},DeliveryPromoSvc}();t.DeliveryPromoSvc=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DeliveryPromoController(e,t){"ngInject";this.$window=e,this.PurchaseNgaSvc=t}return DeliveryPromoController.$inject=["$window","PurchaseNgaSvc"],DeliveryPromoController.prototype.isPromoTermsLinkAvailable=function(){return!(!this.message||this.message.termsAccepted||!this.message.termsLink||!this.message.termsLinkName)},DeliveryPromoController.prototype.goToPromoTerms=function(){this.message&&this.message.termsLink&&(this.PurchaseNgaSvc.publishGoToFreeDeliveryTerms(),this.$window.open(this.message.termsLink,"_blank"))},DeliveryPromoController}();t.DeliveryPromoController=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(232),a=o.module("purchase.util",[]).service("DebouncerSvc",i.DebouncerSvc);t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function DebouncerSvc(){}return DebouncerSvc.prototype.debouncePromise=function(e){var t=null,r=!0,n=!1,o=function wrap(t){return t.then(function(t){return n?(n=!1,wrap(e())):t})};return function(){return r?(r=!1,t=o(e()).finally(function(){r=!0})):n=!0,t}},DebouncerSvc}();t.DebouncerSvc=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(234),a=o.module("newRelicErrorHandler",[]).service("ErrorLoggerSvc",i.ErrorLoggerSvc);t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function ErrorLoggerSvc(e,t){"ngInject";this.$log=t,this.$window=e}return ErrorLoggerSvc.$inject=["$window","$log"],ErrorLoggerSvc.prototype.report=function(e){if(this.$window.NREUM&&this.$window.NREUM.noticeError)try{this.$window.NREUM.noticeError(e)}catch(e){this.$log.error(e)}else this.$log.info("New Relic not available to record error.")},ErrorLoggerSvc}();t.ErrorLoggerSvc=n},function(e,t,r){r(236);Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=r(237),a=o.module("purchase.header",["gettext"]).component("purchaseHeader",new i.PurchaseHeaderComponent);t.default=a},function(e,t){angular.module("gettext").run(["gettextCatalog",function(e){e.setStrings("pl",{"Delivery and payment":"dostawa i płatność","Related orders":"oferty do zapłaty","Your cart":"Twój koszyk","purchase confirmation":"Potwierdzenie zakupu","Your guest data":"Twoje dane",Summary:"podsumowanie"})}])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function PurchaseHeaderComponent(){this.bindings={purchase:"<"},this.template=r(238)}return PurchaseHeaderComponent}();t.PurchaseHeaderComponent=n},function(e,t){e.exports='<header class="page-header separator separator-bottom">\n    <div class="progress-path"\n         ng-if="!$ctrl.purchase.$state.includes(\'purchase.preBuyNow\')">\n        <nav>\n            <ol>\n                <li id="page-header-your-data"\n                    ng-if="$ctrl.purchase.isGuest">\n                    <div>\n                        <i class="icon icon-completed"></i>\n                        <h1 translate>Your guest data</h1>\n                    </div>\n                </li>\n                <li id="page-header-your-cart"\n                    ng-if="!$ctrl.purchase.isGuest && $ctrl.purchase.isCartProcess && !$ctrl.purchase.isStartedFromBuyNow">\n                    <div>\n                        <i class="icon icon-completed"></i>\n                        <h1 translate>Your cart</h1>\n                    </div>\n                </li>\n                <li id="page-header-related"\n                    ng-if="!$ctrl.purchase.isGuest && $ctrl.purchase.isRelatedProcess"\n                    ng-class="{active: $ctrl.purchase.$state.includes(\'purchase.related\')}">\n                    <div>\n                        <i class="icon icon-completed" ng-show="!$ctrl.purchase.$state.includes(\'purchase.related\')"></i>\n                        <h1 translate>Related orders</h1>\n                    </div>\n                </li>\n                <li id="page-header-payment-and-shipment"\n                    ng-class="{active: $ctrl.purchase.$state.includes(\'purchase.dapf\')}">\n                    <div>\n                        <i class="icon icon-completed" ng-show="$ctrl.purchase.$state.includes(\'purchase.summary.view\')"></i>\n                        <h1 translate>Delivery and payment</h1>\n                    </div>\n                </li>\n                <li id="page-header-summary"\n                    ng-class="{active: $ctrl.purchase.$state.includes(\'purchase.summary.view\')}">\n                    <div>\n                        <h1 translate>Summary</h1>\n                    </div>\n                </li>\n            </ol>\n        </nav>\n    </div>\n    <h1 translate ng-if="$ctrl.purchase.$state.includes(\'purchase.preBuyNow\')">purchase confirmation</h1>\n</header>'}],[20]);
//# sourceMappingURL=main.af7cb966ad0d34e247ae.js.map